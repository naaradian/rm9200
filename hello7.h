/**********************************************************************
*    This file was generated by Design Tool a product of: 
*       ARC International  
*       http://www.ARC.com/         
*                              
*       Fri Jun 08 11:29:32 2007
*   
*       Copyright (c) ARC International  
*       All rights reserved    
*   
*       This software embodies materials and concepts which are
*       confidential to ARC International and is made
*       available solely pursuant to the terms of a written license
*       agreement with ARC International.
*   
*   ********************************************************************/

/*   Defines and data structures for application   */


//#include "dataflash.h"

#define HELLO_INDEX   5

//#define PROG_MF20		  //mf20_3.cpp
//#define PROG_BACO		  //baco.cpp  ubx.c

//#define PROG_BACOD	 //do not used bacod.cpp  ubx.c	 baco + dmu

//#define PROG_BMD34	  //need recompile mib
//#define PROG_BMD34PS	  //need recompile mib
//#define PROG_BMD2		  //need recompile mib
//#define PROG_BMDN	 	  //maket N+1 modems 		bmdn.cpp	 pvg610_api.c	hostdriverforpc.cpp   utils.c endian.c
//#define PROG_BMDN1	  //really section of bmdn  bmdn1.cpp!!!+ pvg610_api.c	hostdriverforpc.cpp   utils.c endian.c
//#define PROG_BMDN2	  //really section of bmdn  bmdn2.cpp!!!+ pvg610_api.c	hostdriverforpc.cpp   utils.c endian.c

//#define PROG_BMDN3	 //maked mode 1+1  bmdn3.cpp!!!+ pvg610_api.c	hostdriverforpc.cpp   utils.c endian.c
//#define PROG_BMDN4	 //act15505 1+1 use PVG710 maked mode 1+1  bmdn4.cpp!!!+ pvg610_api.c	hostdriverforpc.cpp   utils.c endian.c
//#define PROG_BMDN5	 //act155051 1+0 use PVG710 maked mode 1+1  bmdn5.cpp!!!+ pvg610_api.c	hostdriverforpc.cpp   utils.c endian.c
//#define PROG_BMDN6		// 155052 //try md310e.cpp+ filters act155051 1+0 use PVG710 maked mode 1+1 + pvg610_api.c	hostdriverforpc.cpp   utils.c endian.c
//#define PROG_MD310	  //+ filters act155051 1+0 use PVG710 maked mode 1+1  md310e.cpp!!!+ pvg610_api.c	hostdriverforpc.cpp   utils.c endian.c

//#define PROG_MD310_SAT  //old	  //+ filters act155051 1+0 use PVG710 maked mode 1+1  md310e.cpp!!!+ pvg610_api.c	hostdriverforpc.cpp   utils.c endian.c
//#define PROG_BMDN6M		   //maked gybryd bmdn6 and md310  not sat!!!!!
//#define PROG_BMDN6MI	  //wrong!!!! for sat maked gybryd bmdn6 and md310 + indikator!	md310e_ind.cpp			 
//#define PROG_MD310_SATI	   //sat + ind md310s,cpp +  + pvg610_api.c	hostdriverforpc.cpp   utils.c endian.c
//#define PROG_MD310_SATI2	   //sat + ind md310s2,cpp +  + pvg610_api.c	hostdriverforpc.cpp   utils.c endian.c
//#define PROG_ODU	   //not used !!! odu.cpp +  + pvg610_api.c	hostdriverforpc.cpp   utils.c endian.c
						//pvg810_api.c pvg810_api_calibration.c pvg810_api_DataConfig.c
						//pvg810_api_utilc.c pvg810_api_Application.c pvg810_protocol_MsgUtils.c
//#define PROG_ODU1	   // = rmb _vithout pvg810_ odu2.cpp +  + pvg610_api.c	hostdriverforpc.cpp   utils.c endian.c

//#define PROG_ODU4	   // = rmba  maked from pu_m_v_b.cpp	 




//#define PROG_BMD155	  //need recompile mib hier stopped hot restart making
//#define PROG_BMD155PS	   //need recompile mib
//#define PROG_ACT155		 //need correct rtcs.h!!!	 //this is NOT 700MHz!!!!
//#define ETH_TRANZIT	 //t100110
//#define PROG_ACT155N		//nazemnaja - 10 ms fast 485 packets	//need recompile mib   bmdn3
//#define PROG_COMMUTATOR	  //commutator.cpp
//#define PROG_COMMUTATOR1	  //commutator2.cpp		 do not hangt


//#define PROG_BUKC			 //need recompile mib buk - registers
#define PROG_PUM			//= BUK
//>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>263 need : 

//#define PROG_PU_M		   //pu_m.cpp
//#define PROG_PU_M_MUX	  //pu_m.cpp
//#define PROG_PU_M710   //= md34e	  //pu_m710.cpp

//#define PROG_PU_M100	 //pu_m100.cpp	 any maket

//#define PROG_PU_MSAT	 // linkdoubler1 1024 tfs_data.c web interface  file need copy!!!! pu_msat.cpp  1024
//#define PROG_PU_MSAT1 	//pu_msat1.cpp	   linkdoubler2	 2048		menu
//#define PROG_PU_MSAT3	// pu_msat.cpp	  linkdoubler 3		2048
//#define PROG_PU_MSAT4 //pu_msat1.cpp linkdoubler 4 = linkdoubler2(menu with 1024)	 menu	

//#define PROG_PU_MSAT5	 // linkdoubler1 1024 tfs_data.c web interface  file need copy!!!! pu_msat5.cpp  1024





//#define PROG_PU_M_V		//pu_m_v.cpp

//#define PROG_PU_M_V_A		//pu_m_v_a.cpp 130520  pu_pd  pu_pm
//#define PROG_PU_M_V_AI //pu_m_v_aI.cpp	   added new interface for operating
//#define PROG_PU_M_V_B //  maked from pu_m_v_b_I.cpp	   added new interface for operating



//#define PROG_UPS		//ups.cpp
//#define PROG_UPS1		//ups1.cpp	 +  Ethernet

//#define PROG_MPC34
//#define PROG_MPC155		//mx155.cpp

//#define PROG_BMD35			//ACT  bmd35.cpp	 + basic.
//#define PROG_MPC35		//ACT  mpc35.cpp	 + basic.cpp
//#define	PROG_KTVM  		//api16.cpp+basic.cpp+ktvm200.cpp+load11.cpp+sound.cpp	//need recompile mib
//#define PROG_DTVM  		//dtvm200.cpp+basic.cpp+Init26.cpp + sound_dtvm.cpp		//need recompile mib
//Need recompile MIB!!!!!!!!!!!!!!!!!!!!
//#define PROG_TUTS //Need recompile MIB!!!!!!!!!!!!!!!!!!!!!!!!!
//Need recompile MIB!!!!!!!!!!!!!!!!!!!!!!!

// tcp_prv.h - need set ack_delay_default for tcpip 200ms
//#define PROG_PRM_PCH
//#define PROG_PRM_PCH_C //3 channels
//#define PROG_PRM_PCH_S //2 channels	- 6 receivers  "AC"
//#define PROG_MPC4E //4 channels of ethernet
//#define PROG_PRM_PCH_L //1 channel - 3 receivers	 "CM"


//need set 100 mcs task period in atevblm9200.h
//#define PROG_PRM_PCH_N //1 channel - 1 receiver support rs485 novomar
//#define PROG_PRM_PCH_L_6
//#define PROG_PRM_PCH_N_1   //prm_pch_n_1.cpp
//#define PROG_PRM_PCH_N_2   //prm_pch_n_2.cpp   need rekompile mqx for fast rate!!!
//#define PROG_PRM_PCH_N_3_NOV //prm_pch_n_3_nov.cpp	need rekompile mqx for fast rate!!!
//#define PROG_PRM_PCH_N_3_FSB //prm_pch_n_3_fsb.cpp	need rekompile mqx for fast rate!!!
//#define PROG_PRM_PCH_L_61 // prm_pch.cpp 2 channel - 6 receivers	 added some commands 
//#define PROG_PRM_PCH_L_8  // prm_pch8.cpp prm_pch 8 receivers
//#define PROG_PD  // pd.cpp	make from prm_pch_l61
//#define PROG_PD1  // pd1.cpp	make from ups1
//#define PROG_PD2  // pd2.cpp	try use spi
//#define PROG_PD3  // pd3.cpp	try use spi



//#define PROG_PUPM2 //pupm2.cpp = RM_PCH_L_61 + operating rs485 special protokol
// do not need ? #define PROG_PUPM3 //pupm3.cpp = RM_PCH_L_61 + operating rs485 special protokol + relay station
//#define PROG_PUPM3_1	//pupm3_1.cpp  3 channells
//#define PROG_PUPM3_1_ADESTO	//pupm3_1.cpp  3 channells

		    
//#define	 PROG_PRM_PCH_SPI // prm_pch_spi.cpp

//#define	 PROG_PRM_PCH_SPI_XIL  // prm_pch_spi_xil.cpp

//#define	 PROG_PRM_PCH_SPI_XIL_ETH  // prm_pch_spi_xil_eth.cpp spi+ eth
//#define	 PROG_PRM_PCH_SPI_NOXIL_ETH  // prm_pch_spi_noxil_eth.cpp spi+ eth	 (NOT used _eth1)
//#define	 PROG_PRM_PCH_SPI_NOXIL_ETH_ADESTO
//#define	 PROG_PRM_PCH_SPI_ETH_UART //to convert ethernet to uart of edik  prm_pch_spi_eth_uart.cpp





//#define	 PROG_PRM_PCH_SPI_STEND // prm_pch_spi_stend.cpp

//#define   PROG_PRM_PCH_DEM  //prm_pch_dem.cpp -demodulator   - do not reload xilinxes
//#define	PROG_PRM_PCH_DEM_XIL  //can reload many xilinxes
//#define	PROG_PRM_PCH_DEM_XIL_CHN  //prm_pch_dem_chn.cpp
//#define	PROG_PRM_PCH_DEM_XIL_CHN_DMU3  //prm_pch_dem_chn_dmu3.cpp
//#define	PROG_PRM_PCH_DEM_XIL_CHN_DMU3  //prm_pch_dem_chn_dmu3.cpp
//#define	PROG_PRM_PCH_DEM_XIL_CHN_DMU4  //prm_pch_dem_chn_dmu4.cpp
//#define	PROG_PRM_PCH_DEM_XIL_CHN_DMU5  //prm_pch_dem_chn_dmu5.cpp  dmu + 10G

//#define	PROG_DMU6  //  dmu5.1 dmu6.cpp + dmu6plus.cpp ( provingent + demodulator)	 + pvg610_api.c	hostdriverforpc.cpp   utils.c endian.c

//#define PROG_PROV  //prov.cpp PVG610_API.c  hostDriverForPc.cpp	utils.c	  endian.c	basic.cpp
//262 : remove 10 symbols in parse rs232

//#define SOFT_VER (0x509)
#define SOFT_VER (0x1075)
#ifndef PROG_PU_MSAT
//#define SOFT_VER_STRING    "   14.12.01.1-800 ADESTO"//263 : maked init counter and data for write_buffer_char1()
//#ifndef PROG_PUPM3_1_ADESTO	
//#ifndef PROG_PU_MSAT1
#define SOFT_VER_STRING      "      16.09.21.1-1075    "//263 : maked init counter and data for write_buffer_char1()
#else
//#define SOFT_VER_STRING "Radian Ver. 01.00        "//263 : maked init counter and data for write_buffer_char1()
#define SOFT_VER_STRING   "Radian v.922.50925       "//263 : maked init counter and data for write_buffer_char1()
#endif
//>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

//moved  #define IGNORE_AA_IN_5

//#define UPDOWN_NOT_CLEAN

#define NO_USE_WD
#define UDP_DEBUG
#define USE_SOCKETSD	 //dgram

// #define MAKET_STEND //temporary!!!!!! send modem channel to eth_transit

//#define REMOVE_BCST

//#define TEST_485


//#define DEBUG_MAKET

//#define DEBUG_ASU


//#define DEBUG_ETH_TRANZIT


//#define ETH_DEBUG_485E


// #define DEBUG_485E


//#define TEST_POK

//#define PRINT_PRM_PCH
//#define PRINT_BACO

//#define PRINT_PACK_CFG
//#define TEST_BUS
//#define PRINT_AFR

//#define CF_PRINT
//#define HTTP_PRINTM

//#define PR_FL	 //debug print	flashx

//#define REAL_PROBE

//#define WIFM	 //try work without if module wor igor


//#define PRINT_ETH

//#define TRY_LOADX

//#define TDONE
	    
//#define TEST_PROT
//#define PRINT_ETH

//#define TEST_RAND

//#define FIND_CONF_ERR
//#define FIND_KSS_ERR
//#define TEST_PUMVA
//#define TEST_PUM
//#define TEST_USARTE
//#define TEST_PRINT_SPI_ETH
// #define TEST_PROT
//#define TEST_PUPM2
//#define PRM_USE_ATT_C12 //for debug pupm2 

//#define DEBUG_TRANZIT

//#define DEBUG_POWER
//#define DEBUG_COUNTERS
//#define TEMPORARY_DO_NOT_STOP_RECEIVE

//#define NO_USE_WD

//#define CHECK_LOSS_MEM
//#define KSS_PRINT_LOG
//#define ALL_ADDR
//#define IRQ_LIMITED 
//#define TEST_PRINT_TEMPERATURE

//#define PRINT_YOURNAL
//#define NO_LOAD_BANDS
//#define D_710
//#define TEST_MAKET
//#define NWAIT_DISABLE
//#define TEST_PRINT_USTIR
//#define PRINT_ETH
//#define PRINT_DEBUG_CRC
//#define TEST_PARSING_COMMANDS

//#define TEST_PRINT_SPI
//#define TEST_ADDR

//#define DEBUG_LOOP_PRINT

//#define DEBUG_WRITE_XIL
//#define TEST_HANGING
//#define WITHOUT_INTERRUPTS //
//#define XIL_FLASH
//#define TEST_PRM
//#define START_PRINT
//#define PRINT_START
//#define TEST_PROT



//#define USE_HTTP
//#define HTTP_PRINTM
//#define TEST_PARSING_COMMANDS
//#define TEST_SPI_CHANNEL  //count interrupts  
//#define TEST_PRINT_SPI

//#define   YURA_TEMP
//#define MAX_LOW_ATT
//#define BACK_TO_SSC
//#define SERIAL_N_2
//#define FILES_TEST
//#define IDLE_MODE
//#define USE_SPI	   //for next generation only!
//#define TEMP_USE_ETHERNET
//#define USE_SPI_PARSER
//#define TEST_PRINT_SPI
//#define DO_NOT_RUN_COMMANDS

//#define SERIAL_N_2
//not need now #define RS232E_ENABLE
//#define EMPTY_LOOP //test!!!
//#define ETH_NOT_STOPPED
//#define ALL_ADDR
//#define WITHOUT_XILINX //
//#define TESTSTART
//#define WITHOUT_INTERRUPTS //
//#define DEBUG_ALARM
//#define CAN_ETHERNET_ASU
//#define MAKET_PLATA	 
//#define LOCK_ENABLED
//#define TRAP_ENABLED
//#define BAD_CHECKSUM
//#define ETH_DEBUG_ENABLED	// debug from ethernet enabled
//#define ANSWER_OLWAIS  //for test 
//#define LOAD_EXT_MODEM
//#define USE_SOCKETS
//#define USE_SOCKETSD	 //dgram
//#define BMD155_ETH //two dewices for moskau 19.02.2009
//#define ETH_TRANZIT
//#define WITHOUT_DEVICE
//#define TEMPORARY_MAKE_FULL_ETH
//#define CLOCK_ENABLED
//#define YOURNAL
//#define PRM_PCH_FORMULA5
//#define PRM_PCH_FORMULA6
//#define PRM_PCH_FORMULA7
//#define PRM_PCH_THREE_LINES
//#define PRM_PCH_DEBUG1
//#define PROG_PU_M_MUX_TEST
//#define DISABLE_ETHERNET
//#define DIRECT_RS485
//#define USART0_TRY_PDC
//#define 	TEST_RDN
//#define TEST_HELLO_PRINT
//#define TEST_TWO485
//#define TEST_SLOW
//#define RS485_NOT_DISABLE_ETHERNET
//#define RS232_NOT_DISABLE_ETHERNET
//#define CHECK_ETH_STATE
//#define TEST_RECEIVE
//#define ETH_CAN_RESTART
//#define DEV_ETH_CAN_RESTART

//#define USE_TCPIP_CLIENT
//#define USE_UDP
//#define USE_QUOTE_SERVER
//#define PRINT_USART_DATA   //bmdn
//#define PRINT_SPI_DATA
//#define BMDN_CONNECT_USART
//#define TEST_PRM_PCH_1
//#define TEST_BMDN	  //bmdn
//#define TEST_SPI	  //bmdn
//#define TEST_RESTART
//#define TEST_PRM_PCH_N_2
//#define TEST_L_61
//#define TRY_UNBLOCK
//#define EMPTY_LOOP
//#define USE_USART2   //101201
//#define TEST_USART2
//#define COUNT_BUFF_ERR
//#define PU_M_TEST
//#define TEST_PUMV_ERR

//#define USART0_TRY_PDC_1T	
//#define USART0_TRY_PDC_1
//#define TEST_REMOTE_FF

//#define TEST_USART2_REMOTE
//#define TEST_PUM

//#define HAVE_GATEWAY

//#define TEST_MPC155
//#define CASHE_OFF //maked only in bmd155




#define RS485_MSG_BUFF		 //will be used olwais	   //not this!!!




//#define TEST_PU_M	
//#define EMPTY_LOOP


//#ifndef TRY_FIND_ERR

//#ifdef PROG_COMMUTATOR	  //commutator.cpp
//#define PROG_BMD155	  //commutator.cpp
//#endif


#ifdef PROG_PRM_PCH_N_3_NOV
#define PROG_PRM_PCH_N_2
#endif

#ifdef PROG_PRM_PCH_N_3_FSB
#define PROG_PRM_PCH_N_2
#endif



#ifndef PROG_PRM_PCH_L_6
#define ETH_CAN_RESTART	  //find autoneg
#endif
//#endif

/*
#ifdef USE_USART2
extern "C" void embRS232S_rcvbuf_Add(unsigned char);
extern "C" void Transmit2c(unsigned char);

#define USART2_TRY_PDC_1T //101004 : need check!!!!
#define USART2_TRY_PDC	  //101004 need check!!!
#endif //USE_USART2
*/

#define USART1_TRY_PDC_1T
	//t #define USART0_TRY_PDC_1T	  //if use printf need comment!!!
#define USE_SNMP
#define USART1_TRY_PDC

//#ifndef	 PROG_BMD35
#ifndef	 PROG_BMDN
#ifndef	 PROG_BMDN1
//110126#ifndef	 PROG_BMDN2
#ifndef	 TEST_PRM_PCH_N_2

#ifndef TEST_PRM
//1301319#ifndef	 PROG_PRM_PCH_L_61
#endif // TEST_PRM

//#ifndef PROG_PU_M_MUX	//101001
//#ifndef	 PROG_PRM_PCH_N_1

#define USART0_TRY_PDC_1T	
#define USART0_TRY_PDC_1

//#endif
#endif
#endif // PROG_BMDN
#endif // 

#ifndef TEST_PRM
//130319#endif	//	 PROG_PRM_PCH_L_61
#endif // TEST_PRM
//110126 #endif // PROG_BMDN2

//#endif // test
//#endif // PROG_PRM_PCH_N_2



#define USE_TFTPSRV
#define PRM_PCH_DEBUG  //printing in test mode 0x50
#define COMMAND_RESENDING
#define TCPIP_CONNECT
#define LOCK_ENABLED





//#ifndef  PROG_PRM_PCH_SPI
#define DISABLE_MY_PROTOKOL_ON_RS_485
//#endif


#ifdef 	PROG_PD3

//#define PD3_KEEP_PARAMS

extern unsigned short freqpd;
extern unsigned char attpd;


#define    PROG_PRM_PCH_SPI_NOXIL_ETH
//#define TEST_PRINT_SPI_ETH
//#define TEST_PRINT_SPI
extern "C" void Parse_PD3(char *, unsigned long );

#endif



#ifdef	 PROG_PRM_PCH_SPI_ETH_UART 
#define HAVE_GATEWAY
#define	 PROG_PRM_PCH_SPI_NOXIL_ETH
#define	ADESTO 
 extern  unsigned char prm_inp;

//#define UART_DELAY	(1)
//#define UART_DELAY	(200)
#define UART_DELAY	(40)	//ok
//bad#define UART_DELAY	(20)



#endif



#ifdef	 PROG_PRM_PCH_SPI_NOXIL_ETH_ADESTO 
#define	 PROG_PRM_PCH_SPI_NOXIL_ETH
#define	ADESTO 
#endif


#ifdef	 PROG_PRM_PCH_SPI_NOXIL_ETH

extern "C" void PrintAFR();


extern "C" unsigned long GetAtt(unsigned char num);


extern "C" void TestReadDDS();
extern "C" unsigned char ReadDDS(unsigned long);



extern "C" char SpiReadN2 ( unsigned long , unsigned long);

extern "C" void Check_IOs_noxil(void);

#define MODE_CHECK_PINS (0xCE)


#define WITHOUT_XILINX //
#define WITHOUT_INTERRUPTS //


#define LONG_ETH

//#define  HAVE_GATEWAY  //for test

extern "C" void Init_IOs_noxil(void);

#define	 PROG_PRM_PCH_SPI_XIL_ETH
#endif


#ifdef	 PROG_PRM_PCH_SPI_XIL_ETH

#define CHECK_ETH_STATE
#define ETH_CAN_RESTART
#define DEV_ETH_CAN_RESTART
//#define TRAP_ENABLED
#define PING_ENABLED



#define LONG_ETH

//#define  HAVE_GATEWAY

#define  TWO_RECEIVERS

 extern "C" void InitFreq(unsigned long);

#define XIL_SIZE_ETH	(32000)
#define	 PROG_PRM_PCH_SPI_XIL
#endif

#ifdef PROG_PUPM3

//#define PROG_PUPM2
extern unsigned char firstaddr;
extern "C" void  GetCode1();
extern "C" void  GetCode4();
#define PM_OK (1)

#define PROT_PUPM2

extern "C" void  SetFreqPUPM2(unsigned char sel);
extern "C" void  SetAttPUPM2(unsigned char sel);


extern "C" void TestParsing();
extern "C" unsigned char OperateCommandPuPm2(unsigned char * pData);



#define START_SYM 0xFE
#define STOP_SYM  0xFC


#define NO_COMMAND_SSC2 (0)
 
#define COP1 (0x43) //1
#define COP2 (0x44) //2
#define COP3 (0x48) //3

#define CODE_NORMA     (0)
#define CODE_BAD_CRC   (0x1)
#define CODE_BAD_COP   (0x2)
#define CODE_NO_FORMAT (0x3)
#define CODE_NOT_CONNECT  (0x4)

#define TRY_SEND  (1)  //try one time to 


//____________
extern "C" void RunCommandSSC2(void);
extern "C" void SetRunCommandPUPM2(unsigned char);
extern unsigned char NeedRunCommand;

#define COMMAND_POS (2)
#define ADDR_POS (3)
#define START_POS (1)
#define LENGTH_POS (3)


#define RUN_COMMAND (1)
#define WAITING_COMMAND (2)
#define RECEIVE_COMMAND (3)
#define MAX_DATA_SIZE1 (64)
void MClearPB19(void);

#define COMMANDS_QUANTITY (3)

extern unsigned char current_command_counter;
extern unsigned char current_command_state;
//extern unsigned char my_addr;

extern unsigned char current_command_type;
extern unsigned char current_command_crc;
extern unsigned char current_command_length;
extern unsigned char current_command_data_counter;
extern unsigned char current_command_data[MAX_DATA_SIZE1];

extern unsigned char CommandLength[COMMANDS_QUANTITY + 1];
extern unsigned char CommandDataLength[COMMANDS_QUANTITY + 1];


//____________


#define PROG_PRM_PCH_L_61
 /*
#define FIX_ATT (30)
#define PRM_L_KEEP_FREQ
//#define DELAY_TIME_TO_WRITE	(5000) //	 5sec
#define DELAY_TIME_TO_WRITE	(1000) //	 1sec

extern  unsigned char WriteStatus1,WriteStatus2,WriteStatus3,WriteStatus4,WriteStatus5,WriteStatus6;
extern unsigned char ReadStatus1[3], ReadStatus2[3], ReadStatus3[3], ReadStatus4[3], ReadStatus5[3], ReadStatus6[3];
extern unsigned char ReadAtt1[3], ReadAtt2[3], ReadAtt3[3], ReadAtt4[3], ReadAtt5[3], ReadAtt6[3];


#define  FLASH_LEN  (4)
#define GET_FLASH_LEN (3)
#define GET_ATT_LEN (1)

#define  CODE_SETFLASH	(30)
#define  CODE_GETFLASH	(31)
#define  CODE_GETATT	(32)

#define  WRITE_FLASH_COMMAND	 (0x1E)
#define  READ_FLASH_COMMAND	 (0x1F)
#define  READ_ATT_COMMAND	 (0x20)

//#define	 PROG_PRM_PCH_L_6
#define	 PROG_PRM_PCH_L
	  */
#endif


#ifdef PROG_PUPM3_1_ADESTO
#define ADESTO
#define PROG_PUPM3_1	
#endif


#ifdef PROG_PUPM3_1	
#define POWER_PORT3 (0x12)
#define CH_PW_MASK  (1)
#define CH_PW_MASK_RD  (0x10)

#define  PROG_PUPM2	
#endif


#ifdef PROG_PUPM2	
extern unsigned char firstaddr;
extern "C" void  GetCode1();
extern "C" void  GetCode4();
#define PM_OK (1)

#define PROT_PUPM2

extern "C" void  SetFreqPUPM2(unsigned char sel);
extern "C" void  SetAttPUPM2(unsigned char sel);


extern "C" void TestParsing();
extern "C" unsigned char OperateCommandPuPm2(unsigned char * pData);



#define START_SYM 0xFE
#define STOP_SYM  0xFC


#define NO_COMMAND_SSC2 (0)
 
#define COP1 (0x43) //1
#define COP2 (0x44) //2
#define COP3 (0x48) //3

#define CODE_NORMA     (0)
#define CODE_BAD_CRC   (0x1)
#define CODE_BAD_COP   (0x2)
#define CODE_NO_FORMAT (0x3)
#define CODE_NOT_CONNECT  (0x4)

#define TRY_SEND  (1)  //try one time to 


//____________
extern "C" void RunCommandSSC2(void);
extern "C" void SetRunCommandPUPM2(unsigned char);
extern unsigned char NeedRunCommand;

#define COMMAND_POS (2)
#define ADDR_POS (3)
#define START_POS (1)
#define LENGTH_POS (3)


#define RUN_COMMAND (1)
#define WAITING_COMMAND (2)
#define RECEIVE_COMMAND (3)
#define MAX_DATA_SIZE1 (64)
void MClearPB19(void);

#define COMMANDS_QUANTITY (3)

extern unsigned char current_command_counter;
extern unsigned char current_command_state;
//extern unsigned char my_addr;

extern unsigned char current_command_type;
extern unsigned char current_command_crc;
extern unsigned char current_command_length;
extern unsigned char current_command_data_counter;
extern unsigned char current_command_data[MAX_DATA_SIZE1];

extern unsigned char CommandLength[COMMANDS_QUANTITY + 1];
extern unsigned char CommandDataLength[COMMANDS_QUANTITY + 1];


//____________


#define PROG_PRM_PCH_L_61

#endif

//_____________________________________________________________________________stend>>>>
#ifdef	 PROG_PRM_PCH_SPI_STEND // prm_pch_spi.cpp
extern "C" unsigned char Modify5A(unsigned char byte);
extern unsigned char mode5ASSC2;
// #define TEST_PRINT_SPI

//#define COMMON_ADDR (0xff)
extern unsigned char flag_add_tcp;

#define STEND_SPI
//#define PERIOD_SPI_SEND (6)	 //1 of 3
#define PERIOD_SPI_SEND (20)
#define MAX_DATA_SIZE (10)
//#define TIME_WAIT_SPI (50)
extern unsigned long spi_counter_r;
extern unsigned long spi_counter_t;

extern unsigned char current_answer_counter;
extern unsigned char current_answer_state;
extern unsigned char current_answer_type;
extern unsigned char current_answer_crc;
extern unsigned char current_answer_length;
extern unsigned char current_answer_data_counter;
extern unsigned char current_answer_data[MAX_DATA_SIZE];
extern unsigned char current_celling_crc;


extern "C" unsigned char OperateBuffers_SPI1(void);
extern "C" unsigned char OperateBuffers_SPI1_stend(void);


extern "C" void init_test_spi_master();

extern unsigned char ssc1_receive_counter;
extern unsigned char ssc1_receive_state;
extern unsigned char ssc1_receive_length;

extern "C" void test_receive_data_SSC1(void);

#define	 PROG_PRM_PCH_SPI // prm_pch_spi.cpp
#endif
//_____________________________________________________________________________stend<<<<<


//_____________________________________________________________________________PROG_PRM_PCH_SPI>>>
#ifdef	 PROG_PRM_PCH_SPI // prm_pch_spi.cpp

 extern "C" void InitFreq(unsigned long);

void TestPortB0(void);

//120203 #define TEST_PRINT_SPI

#ifndef	 PROG_PRM_PCH_SPI_STEND
#define BACK_TO_SSC
#endif

#define USE_SPI	   //for next generation only!


#define COMMON_ADDR (0xff)


extern "C" void KeepParams(void);

//#define USE_SPI
extern "C" void ConnectEnable(void);
extern "C" void SetLineConnectToIO(void);

//extern "C" void DataOffSet(void);
//extern "C" void DataOffClear(void);



#define USE_ATT_TABLE

#ifdef USE_ATT_TABLE
extern "C" void ReadAFR(void);
extern "C" void WriteAFR(void);
#ifdef TWO_RECEIVERS
extern "C" void ReadAFR1(void);
extern "C" void WriteAFR1(void);

#endif
#define AFR_SIZE (10000)
extern unsigned char AFR[AFR_SIZE];
#ifdef TWO_RECEIVERS
extern unsigned char AFR1[AFR_SIZE];
#endif
#define TIMEOUT_KEEP_AFR (4000) //4 sec
extern unsigned long time_request;
#endif



//#define TIME_WAIT_SPI (500)
#define TIME_WAIT_SPI (400)

//131202 #define TIME_WAIT_SPI_ETH (200)

#define TIME_WAIT_SPI_ETH (0) //131202
//#define TIME_WAIT_SPI_ETH (2) //131202


void init_io_for_dds(void);
extern "C" void enableTxPdcSPI1(void); //for init buffer

extern "C" unsigned char OperateBuffers_SPIt1(void);

//111031#define USE_SPI


#ifdef USE_SPI

#ifndef BACK_TO_SSC
#define USE_IO_LOAD_DDS
#endif

#ifdef USE_IO_LOAD_DDS
extern "C" void init_io_for_dds(void);
#endif

extern unsigned char flag_receive_spi;
extern "C" void AT91F_SPI_Receive_Polled(void);
extern "C" unsigned char OperateBuffers_SPI1_Polled(void);

extern "C" unsigned char OperateBuffers_SPI1(void);

#ifdef BACK_TO_SSC
extern  void SetLineDataSSC2Off();
extern  "C" void SetLineDataSSC2ToSSC2Data();
extern  void SetLineDataSSC2ToZero();
//SetLineDataSSC2ToSSC2Data();
#endif

extern "C" void SetLineDataOffToIO();
extern "C" void SetLineDataOffToZero();
extern "C" void SetLineDataOffToOne();

extern "C" void init_test_spi(void);
extern "C" void RunCommandSPI(void);
extern "C" void AT91F_SPI_IRQ0_Handler();
extern "C" void test_send_data_spi(void);

#endif	//USE_SPI


extern "C" void SetSSC2ToExtClocks();
extern "C" void SetSSC2ToSelfClocks();

#define TEST_PRINT_SSC2 
//111031 #define STEND_SPI

#ifdef STEND_SPI
#define  SSC_BUFFER_SIZE (200)
#define	 MAX_REAL_LEN (SSC_BUFFER_SIZE)
extern "C" void SendSSCBuff(void);
extern "C" void SetSendToSSC(unsigned char *, unsigned long);
extern "C" void MakeSendToSSC(unsigned char * IPBuff, unsigned long len);

extern unsigned char ssc_trans_buf[SSC_BUFFER_SIZE];
extern unsigned long  ssc_trans_buf_cur;

#endif //  STEND_SPI

//#define TEST_SPI_CHANNEL
extern "C" void ToPdcTspi(unsigned char);

#ifdef TEST_SPI_CHANNEL
extern unsigned long err;
extern unsigned long noerr;
extern unsigned long irq0_counter;

#endif

extern "C" void AT91F_SSC2_IRQ0_Handler(void);
extern "C" void RunCommandSSC2(void);
extern unsigned char NeedRunCommand;

#define COMMAND_POS (4)
#define ADDR_POS (2)
#define START_POS (1)
#define LENGTH_POS (3)


#define RUN_COMMAND (1)
#define WAITING_COMMAND (2)
#define RECEIVE_COMMAND (3)
//#define MAX_DATA_SIZE1 (10)
#define MAX_DATA_SIZE1 (20)
void MClearPB19(void);

#define COMMANDS_QUANTITY (0x80)
extern unsigned char current_command_counter;
extern unsigned char current_command_state;
//extern unsigned char my_addr;

extern unsigned char current_command_type;
extern unsigned char current_command_crc;
extern unsigned char current_command_length;
extern unsigned char current_command_data_counter;
extern unsigned char current_command_data[MAX_DATA_SIZE1];

extern unsigned char CommandLength[COMMANDS_QUANTITY + 1];
extern unsigned char CommandDataLength[COMMANDS_QUANTITY + 1];


extern unsigned long ssc2_int_counter;
extern "C" void SetLineDataSS2ToZero(void);
extern "C" void SetLineDataSS2ToOne(void);
extern "C" void SetLineDataSSC2Off(void);

extern "C" void SetLineAlarmToZero(void);
extern "C" void SetLineAlarmToOne(void);
extern "C" void SetLineAlarmOff(void);
extern "C" void SetPB19(void);



extern "C" void SetLineDataSS2ToSSC2Data(void);
extern "C" void AT91F_SSC2_Receive_Polled(void);


#define MAX_LEN	(270)

#define START_COMMAND	(0xAA)
#define STOP_COMMAND	(0x55)
#define MY_ADDRESS		(0x01) //make in future
//#define MY_ADDRESS		(GetUSARTRem()) //make in future
#define BRD_ADDRESS		(0xFF) //addr for all
#define MASK_REQUEST	(0x80)

#define	COMM1_LEN		(2)
#define	COMM2_LEN		(2)
#define	COMM3_LEN		(2)
#define	COMM4_LEN		(7)
#define	COMM5_LEN		(2)
#define	COMM6_LEN		(2)
#define	COMM7_LEN		(2)
#define	COMM8_LEN		(2)
#define	COMM80_LEN		(2)
#define	COMM20_LEN		(2)
#define	COMM21_LEN		(2)


#define COMMANDN1 (1)
#define COMMANDN2 (2)
#define COMMANDN3 (3)
#define COMMANDN4 (4)
#define COMMANDN5 (5)
#define COMMANDN6 (6)
#define COMMANDN7 (7)
#define COMMANDN8 (8)
#define COMMANDN80 (0x80)
#define COMMANDN20 (0x20)
#define COMMANDN21 (0x21)


#define COMMANDS1 (1)
#define COMMANDS2 (2)
#define COMMANDS3 (3)
#define COMMANDS4 (4)
#define COMMANDS5 (5)
#define COMMANDS6 (6)
#define COMMANDS7 (7)
#define COMMANDS8 (8)
#define COMMANDS80 (0x80)


#define RUN_OK (1)
#define RUN_BAD (0)



#define START_ANS (0xAA)



#define DIRECT_RS485
#define USE_USART2

#ifdef USE_USART2
extern "C" void Remote_PRM_PCHS(void);
#endif


extern "C" void OperateSynt(unsigned long);
extern "C" void SetLed3(unsigned char);
extern "C" void SendToDDS(unsigned long, unsigned long);
#define SENDED_DDS_FREQ_LEN	 (8)
#define NO_HANGT_VAL (10000)
extern unsigned char GetLevN(void);
extern unsigned char GetAttN(void);
extern unsigned char GetAtt2N(void);
extern unsigned char GetAtt3N(void);

extern unsigned short GetFreqN(void);
extern unsigned short GetLockN(void);
extern unsigned char GetAlarmN(void);
extern "C" unsigned char GetAddrN(void);

extern "C" void RestoreFreq(unsigned char , unsigned long );
extern "C" void RestoreAtt(unsigned char , unsigned long );

#define PRM_N_KEEP_FREQ
//#define DELAY_TIME_TO_WRITE	(50000) //	 10sec
//#define DELAY_TIME_TO_WRITE	(25000) //	 5sec





#define LEN_DATA_DDS (3)


extern   unsigned char Rej;
extern   unsigned char Filtr;
extern "C" void disable_txd_pin_ssc2(void);
extern "C" void ParseCommandsSSC2();



#define SSC2_FREQ (5000000)
//ok#define SSC2_FREQ (10000000)
//ok#define SSC2_FREQ (20000000)
//#define SSC2_FREQ (30000000)

//ok #define SSC2_FREQ (500000)
//ok#define SSC2_FREQ (1000000)
//ok#define SSC2_FREQ (3000000)
//have errors#define SSC2_FREQ (4500000)
//#define SSC2_FREQ (4000000)

extern "C" void  SSC2Buff_Init(void);
extern "C" void  SSC2Buff_Add(unsigned char);
extern "C"  unsigned char  SSC2Buff_IsUsed(void);
extern "C"  unsigned char  SSC2Buff_Get(void);


void enable_ints_ssc2(void);
//extern "C" void OperateBuffers_SSC2(void);
extern "C" void test_send_data_ssc2(void);
extern "C" void ToPdcTssc2(unsigned char);
extern "C" unsigned char OperateBuffers_SSC2t(void);
extern "C" void init_test_ssc2(void);
extern "C" void init_exchange(void);
unsigned char OperateBuffers_SSC2(void);
void init_ssc2 (void);
void enableRxPdcSSC2(void);
void enableTxPdcSSC2(void);
#define	PROG_PRM_PCH_L_61

#define TEST_TRANSMIT_FROM_SSC1

#ifdef TEST_TRANSMIT_FROM_SSC1
void enableTxPdcSSC1t(void);
extern "C" void ToPdcTSSC1t(unsigned char);
extern "C" unsigned char OperateBuffers_SSC1t(void);
extern "C" unsigned char OperateBuffers_SSC1(void);

//void init_exchangeSSC1t(void);
extern "C" void init_test_SSC1(void);
extern "C" void test_send_data_SSC1(void);
void init_SSC1t();
void enableRxPdcSSC1t();
extern "C" void init_exchangeSSC1t(void);

#endif 

//testtesttest
#endif //PROG_PRM_PCH_SPI
//_____________________________________________________________________________PROG_PRM_PCH_SPI<<<


//_____________________________________________________________________________PROG_PRM_PCH_SPI_XIL>>>
#ifdef PROG_PRM_PCH_SPI_XIL // prm_pch_spi.cpp


#define POLLING_TRANSMIT	  //hangt!!!!!


#ifndef	PROG_PRM_PCH_SPI_NOXIL_ETH
#ifndef	PROG_PRM_PCH_SPI_XIL_ETH
#define DISABLE_ETHERNET
#endif
#endif


extern unsigned char Ready_Reseive;
//_______________________________130405
#define MY_ADDRESS		(0x01) //make in future

//______________________________130405

//#define TEST_DELAY_SPI
//#define TEST_DELAY	10
//#define USE_SPI_PARSER //121031

extern "C" unsigned char ReadDataspi(unsigned char * pData, unsigned long cnt_data);
#ifdef PRINT_DEBUG_CRC
   extern unsigned char	   crc_glob;// = crc;
   extern unsigned char	   body_glob;// = body[i];
#endif


extern "C" unsigned char embMsgSSC2N_ChkCRCN(unsigned long);
extern "C" void embMsgSSC2N_Add(unsigned char);
extern unsigned char mode5ASSC2; 
extern "C" unsigned char Modify5A(unsigned char);

#ifdef TEST_PARSING_COMMANDS
extern "C" void TestParsing(void);
#endif
extern "C" unsigned char OperateCommand(unsigned char * pData);


void TestPortB0(void);


#define VER_XIL				(0x1)
#define ATT1_SPI_XIL		(0x2)
#define ATT2_SPI_XIL		(0x3)
#define ATT3_SPI_XIL		(0x4)
#define N_SPI_XIL			(0x5)
#define S_SPI_XIL			(0x6)
#define A_SPI_XIL			(0x7)
#define B_SPI_XIL			(0x8)
#define C_SPI_XIL			(0x9)
#define ATT4_SPI_XIL		(0xa)
#define DOP_SPI_XIL			(0xb)
#define ALARMOP_SPI_XIL		(0xc)
#define ADDR_SPI_XIL		(0xd)
#define DATA_READY_SPI_XIL	(0xe)

#define MSB_FIRST			(0x20)


#define DATA_SPI_XIL	(0x10)
#define OPERATE_SPI_XIL	(0x11)
#define MASK_SPI_XIL	(0x12)
#define STATUS_SPI_XIL	(0x13)


#define	PROG_PRM_PCH_SPI //temporary

#define IncEmbSerialSPI
#ifdef  IncEmbSerialSPI
extern "C" void SetLineDataSPIToZeroX();
extern "C" void SetLineDataSPIToOneX();
extern "C" void SetLineAlarmToZeroX();
extern "C" void SetLineAlarmToOneX();
extern "C" void SetLineDataSPIOffX();
extern "C" void SetLineAlarmOffX();


extern "C" void ReadAddressSPIX();

#endif


#define DATA_PORT (0xA7) //temporary
#define MASK_PORT (0xA6) //temporary


//120203 #define TEST_PRINT_SPI

#define BACK_TO_SSC
#define USE_SPI	   //for next generation only!


#define COMMON_ADDR (0xff)


extern "C" void KeepParams(void);

//#define USE_SPI
extern "C" void ConnectEnable(void);
extern "C" void SetLineConnectToIO(void);

//extern "C" void DataOffSet(void);
//extern "C" void DataOffClear(void);



#define USE_ATT_TABLE  //hier was comment

#ifdef USE_ATT_TABLE
extern "C" void ReadAFR(void);
extern "C" void WriteAFR(void);
#define AFR_SIZE (10000)
#ifdef TWO_RECEIVERS
extern unsigned char AFR1[AFR_SIZE];
#endif

extern unsigned char AFR[AFR_SIZE];
#define TIMEOUT_KEEP_AFR (4000) //4 sec
extern unsigned long time_request;
#endif	 //USE_ATT_TABLE



//#define TIME_WAIT_SPI (500)
#define TIME_WAIT_SPI (400)

void init_io_for_dds(void);
extern "C" void enableTxPdcSPI1(void); //for init buffer

extern "C" unsigned char OperateBuffers_SPIt1(void);

//111031#define USE_SPI


#ifdef USE_SPI

//#ifndef BACK_TO_SSC
//#define USE_IO_LOAD_DDS
//#endif

//#ifdef USE_IO_LOAD_DDS
//extern "C" void init_io_for_dds(void);
//#endif

extern unsigned char flag_receive_spi;
extern "C" void AT91F_SPI_Receive_Polled(void);
extern "C" unsigned char OperateBuffers_SPI1_Polled(void);

extern "C" unsigned char OperateBuffers_SPI1(void);

#ifdef BACK_TO_SSC
extern  void SetLineDataSSC2Off();
extern  "C" void SetLineDataSSC2ToSSC2Data();
extern  void SetLineDataSSC2ToZero();
//SetLineDataSSC2ToSSC2Data();
#endif

extern "C" void SetLineDataOffToIO();
extern "C" void SetLineDataOffToZero();
extern "C" void SetLineDataOffToOne();

extern "C" void init_test_spi(void);
extern "C" void RunCommandSPI(void);
extern "C" void AT91F_SPI_IRQ0_Handler();
extern "C" void test_send_data_spi(void);

#endif	//USE_SPI


extern "C" void SetSSC2ToExtClocks();
extern "C" void SetSSC2ToSelfClocks();

#define TEST_PRINT_SSC2 
//111031 #define STEND_SPI

#ifdef STEND_SPI
#define  SSC_BUFFER_SIZE (200)
#define	 MAX_REAL_LEN (SSC_BUFFER_SIZE)
extern "C" void SendSSCBuff(void);
extern "C" void SetSendToSSC(unsigned char *, unsigned long);
extern "C" void MakeSendToSSC(unsigned char * IPBuff, unsigned long len);

extern unsigned char ssc_trans_buf[SSC_BUFFER_SIZE];
extern unsigned long  ssc_trans_buf_cur;

#endif //  STEND_SPI

//#define TEST_SPI_CHANNEL
extern "C" void ToPdcTspi(unsigned char);

#ifdef TEST_SPI_CHANNEL
extern unsigned long err;
extern unsigned long noerr;
extern unsigned long irq0_counter;

#endif

extern "C" void AT91F_SSC2_IRQ0_Handler(void);
extern "C" void RunCommandSSC2(void);
extern unsigned char NeedRunCommand;

#define COMMAND_POS (4)
#define ADDR_POS (2)
#define START_POS (1)
#define LENGTH_POS (3)


#define RUN_COMMAND (1)
#define WAITING_COMMAND (2)
#define RECEIVE_COMMAND (3)
#define MAX_DATA_SIZE1  (20)
void MClearPB19(void);

#define COMMANDS_QUANTITY (0x80)
extern unsigned char current_command_counter;
extern unsigned char current_command_state;
//extern unsigned char my_addr;

extern unsigned char current_command_type;
extern unsigned char current_command_crc;
extern unsigned char current_command_length;
extern unsigned char current_command_data_counter;
extern unsigned char current_command_data[MAX_DATA_SIZE1];

extern unsigned char CommandLength[COMMANDS_QUANTITY + 1];
extern unsigned char CommandDataLength[COMMANDS_QUANTITY + 1];


extern unsigned long ssc2_int_counter;
extern "C" void SetLineDataSS2ToZero(void);
extern "C" void SetLineDataSS2ToOne(void);
extern "C" void SetLineDataSSC2Off(void);

extern "C" void SetLineAlarmToZero(void);
extern "C" void SetLineAlarmToOne(void);
extern "C" void SetLineAlarmOff(void);
extern "C" void SetPB19(void);



extern "C" void SetLineDataSS2ToSSC2Data(void);
extern "C" void AT91F_SSC2_Receive_Polled(void);


#define MAX_LEN	(270)

#define START_COMMAND	(0xAA)
#define STOP_COMMAND	(0x55)
//#define MY_ADDRESS		(0x01) //make in future
extern  unsigned char  MY_ADDRESS_XIL;
//#define MY_ADDRESS		(GetUSARTRem()) //make in future
#define BRD_ADDRESS		(0xFF) //addr for all
#define MASK_REQUEST	(0x80)
#define	COMM0_LEN		(5)	  //1 command + 4 byte really
#define	COMM1_LEN		(2)	 //1 command + 1 byte really
#define	COMM2_LEN		(2)
#define	COMM3_LEN		(2)
#define	COMM4_LEN		(7)
#define	COMM5_LEN		(2)
#define	COMM6_LEN		(2)
#define	COMM7_LEN		(2)
#define	COMMA_LEN		(3) //1 command + 2 byte really

#define	COMMC_LEN		 (7)
#define	COMMD_LEN		 (5)



#define	COMM80_LEN		(2)
#define	COMM20_LEN		(2)
#define	COMM21_LEN		(2)
#define	COMM22_LEN		(2)
#define	COMM23_LEN		(2)

#define	COMM9_LEN		(2)
#define	COMMB_LEN		(2)



#define COMMANDN0 (0)
#define COMMANDN1 (1)
#define COMMANDN2 (2)
#define COMMANDN9 (9)

#define COMMANDN3 (3)
#define COMMANDN4 (4)
#define COMMANDN5 (5)
#define COMMANDN6 (6)
#define COMMANDN7 (7)
#define COMMANDN8 (8)
#define COMMANDNA (0xA)
#define COMMANDNB (0xB)
#define COMMANDNC (0xC)
#define COMMANDND (0xD)





#define COMMANDN80 (0x80)
#define COMMANDN20 (0x20)
#define COMMANDN21 (0x21)
#define COMMANDN22 (0x22)
#define COMMANDN23 (0x23)



#define COMMANDS1 (1)
#define COMMANDS2 (2)
#define COMMANDS3 (3)
#define COMMANDS4 (4)
#define COMMANDS5 (5)
#define COMMANDS6 (6)
#define COMMANDS7 (7)
#define COMMANDS8 (8)
#define COMMANDS80 (0x80)


#define RUN_OK (1)
#define RUN_BAD (0)



#define START_ANS (0xAA)



#define DIRECT_RS485
#define USE_USART2

#ifdef USE_USART2
extern "C" void Remote_PRM_PCHS(void);
#endif


extern "C" void OperateSynt(unsigned long);
extern "C" void SetLed3(unsigned char);
extern "C" void SendToDDS(unsigned long, unsigned long);
#define SENDED_DDS_FREQ_LEN	 (8)
#define NO_HANGT_VAL (10000)
extern unsigned char GetLevN(void);
extern unsigned char GetAttN(void);
extern unsigned char GetAtt2N(void);
extern unsigned char GetAtt3N(void);

extern unsigned short GetFreqN(void);
extern unsigned short GetLockN(void);
extern unsigned char GetAlarmN(void);
extern "C" unsigned char GetAddrN(void);

extern "C" void RestoreFreq(unsigned char , unsigned long );
extern "C" void RestoreAtt(unsigned char , unsigned long );

#define PRM_N_KEEP_FREQ
//#define DELAY_TIME_TO_WRITE	(50000) //	 10sec
//#define DELAY_TIME_TO_WRITE	(25000) //	 5sec





#define LEN_DATA_DDS (3)


extern   unsigned char Rej;
extern   unsigned char Filtr;
extern "C" void disable_txd_pin_ssc2(void);
extern "C" void ParseCommandsSSC2();



#define SSC2_FREQ (5000000)
//ok#define SSC2_FREQ (10000000)
//ok#define SSC2_FREQ (20000000)
//#define SSC2_FREQ (30000000)

//ok #define SSC2_FREQ (500000)
//ok#define SSC2_FREQ (1000000)
//ok#define SSC2_FREQ (3000000)
//have errors#define SSC2_FREQ (4500000)
//#define SSC2_FREQ (4000000)

extern "C" void  SSC2Buff_Init(void);
extern "C" void  SSC2Buff_Add(unsigned char);
extern "C"  unsigned char  SSC2Buff_IsUsed(void);
extern "C"  unsigned char  SSC2Buff_Get(void);


void enable_ints_ssc2(void);
//extern "C" void OperateBuffers_SSC2(void);
extern "C" void test_send_data_ssc2(void);
extern "C" void ToPdcTssc2(unsigned char);
extern "C" unsigned char OperateBuffers_SSC2t(void);
extern "C" void init_test_ssc2(void);
extern "C" void init_exchange(void);
unsigned char OperateBuffers_SSC2(void);
void init_ssc2 (void);
void enableRxPdcSSC2(void);
void enableTxPdcSSC2(void);
#define	PROG_PRM_PCH_L_61

#define TEST_TRANSMIT_FROM_SSC1

#ifdef TEST_TRANSMIT_FROM_SSC1
void enableTxPdcSSC1t(void);
extern "C" void ToPdcTSSC1t(unsigned char);
extern "C" unsigned char OperateBuffers_SSC1t(void);
extern "C" unsigned char OperateBuffers_SSC1(void);

//void init_exchangeSSC1t(void);
extern "C" void init_test_SSC1(void);
extern "C" void test_send_data_SSC1(void);
void init_SSC1t();
void enableRxPdcSSC1t();
extern "C" void init_exchangeSSC1t(void);

#endif 


#endif //PROG_PRM_PCH_SPI_XIL
//_____________________________________________________________________________PROG_PRM_PCH_SPI_XIL<<<
  
//#ifdef PROG_PU_M_V_B

#ifdef PROG_ODU4
#define WITHOUT_INTERRUPTS
#define PROG_PU_M_V_A
extern "C" unsigned char IO_Pin71_Read(void);
extern "C" void SetPin100ToZero(void);
extern "C" void SetPin100ToOne(void);


#endif



#ifdef PROG_PU_M_V_AI
#define PROG_PU_M_V_A


#endif



#ifdef PROG_PU_M_V_A

//#define DO_NOT_USE_GEN
#define HAVE_GATEWAY
#define TEST_PORT  (0x50)
#define ATT_PORT   (0x51)
#define MIN_ATTDATA (0)
#define MAX_ATTDATA (0xFFFFFFFF)

extern unsigned char pd_pm;
unsigned long GetAttData(void);
void SetAttData(unsigned long val);
void SetAtt(unsigned char);

void IOs_Init(void);

unsigned char IO_Pin97_Read(void);
unsigned char IO_Pin91_Read(void);
void SetPin96ToZero(void);
void SetPin96ToOne(void);



extern unsigned long ch1ok, ch2ok, ch1bad, ch2bad;
//#define HAVE_GATEWAY

#ifdef COUNT_BUFF_ERR
extern "C" unsigned long GetCounter1(void);
extern "C" unsigned long GetCounter2(void);
#endif	

#ifndef PU_M_TEST
//101209#define SEND_PERIOD (20)  //20 82 = 40 - for one channel period is 40
#define SEND_PERIOD (75)  //20 82 = 40 - for one channel period is 40
#else
#define SEND_PERIOD (3)  //20 82 = 40 - for one channel period is 40
#endif
//_________________________________________________pu_m_V
#define PUMV485_REQUEST_DELAY (250)
//#define	 PROG_PU_M_MUX
#define RRL_ADDR1 (1) //(0)
#define RRL_ADDR2 (2) //(0)
#define DEVCONFIG_QUANTITY (16)
#define DEV_INFO_SIZE (32)
#define BAD_POINTER (0xff)
#define MAX_NOT_ANSWERS_Q (10)
extern unsigned char cur_req_quantity;

extern "C" unsigned char GetDevQuantity(void);
extern "C" unsigned char GetDevAddr(unsigned char);
extern "C" unsigned char GetDevPointer(unsigned char);
extern "C" unsigned char Getudevconfig(unsigned char);
extern "C" void Setudevconfig(unsigned char,unsigned char);
extern "C" unsigned char GetDevType(unsigned char);
extern "C" void SetTestConfig(void);
extern "C" void SetNeedWriteDevId();

//_______________________________________
/*
#define DEV_ETH_CAN_RESTART
#define ETH_CAN_RESTART

#define XIL2_BASE      				(pointer)(0x40000000) 
#define XIL2_SIZE      				(0x02000000) 

#define DPD_ADDRESS (0xC0400000)   //temporary
#define DPD_SIZE 	(40000)

#define cs_last_addr          0x50000000
#define INTERRUPT_WAIT (2000000)//now so	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
//#define INTERRUPT_WAIT (200000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
#define XIL_LOAD_FREQ         2000000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
#define IncEmbSerialACT155
#define IncEmbSerialPU_M
#define XilSizeToDownloadD    (350000)   // 101001t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG  				(1)
#define UPD_BUFFER_SIZE 128
extern "C" void Init_PU_M(void);
extern "C" void PU_M(void);

 */
//_______________________________________

//101117 #define DEV_ETH_CAN_RESTART
//101117 #define ETH_CAN_RESTART

#define XIL2_BASE      				(pointer)(0x40000000) /* cs3 */
#define XIL2_SIZE      				(0x02000000) /*addresses  32Mb x 8 */

#define DPD_ADDRESS (0xC0400000)   //temporary
#define DPD_SIZE 	(40000)

#define cs_last_addr          0x50000000
//#define INTERRUPT_WAIT (2000000)//now so	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
//#define INTERRUPT_WAIT (200000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
#define XIL_LOAD_FREQ         2000000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
#define IncEmbSerialACT155
#define IncEmbSerialPU_M
#define XilSizeToDownloadD    (350000)   // 101001t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG  				(1)
#define UPD_BUFFER_SIZE 128
extern "C" void Init_PU_M(void);
extern "C" void PU_M(void);


//#define PROG_PU_M_V
#endif




#ifdef PROG_PU_M_V

extern unsigned long ch1ok, ch2ok, ch1bad, ch2bad;
#define HAVE_GATEWAY

#ifdef COUNT_BUFF_ERR
extern "C" unsigned long GetCounter1(void);
extern "C" unsigned long GetCounter2(void);
#endif	

#ifndef PU_M_TEST
//101209#define SEND_PERIOD (20)  //20 82 = 40 - for one channel period is 40
#define SEND_PERIOD (20)  //20 82 = 40 - for one channel period is 40
#else
#define SEND_PERIOD (3)  //20 82 = 40 - for one channel period is 40
#endif
//_________________________________________________pu_m_V
#define PUMV485_REQUEST_DELAY (250)
//#define	 PROG_PU_M_MUX
#define RRL_ADDR1 (1) //(0)
#define RRL_ADDR2 (2) //(0)
#define DEVCONFIG_QUANTITY (16)
#define DEV_INFO_SIZE (32)
#define BAD_POINTER (0xff)
#define MAX_NOT_ANSWERS_Q (10)
extern unsigned char cur_req_quantity;

extern "C" unsigned char GetDevQuantity(void);
extern "C" unsigned char GetDevAddr(unsigned char);
extern "C" unsigned char GetDevPointer(unsigned char);
extern "C" unsigned char Getudevconfig(unsigned char);
extern "C" void Setudevconfig(unsigned char,unsigned char);
extern "C" unsigned char GetDevType(unsigned char);
extern "C" void SetTestConfig(void);
extern "C" void SetNeedWriteDevId();

//_______________________________________
/*
#define DEV_ETH_CAN_RESTART
#define ETH_CAN_RESTART

#define XIL2_BASE      				(pointer)(0x40000000) 
#define XIL2_SIZE      				(0x02000000) 

#define DPD_ADDRESS (0xC0400000)   //temporary
#define DPD_SIZE 	(40000)

#define cs_last_addr          0x50000000
#define INTERRUPT_WAIT (2000000)//now so	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
//#define INTERRUPT_WAIT (200000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
#define XIL_LOAD_FREQ         2000000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
#define IncEmbSerialACT155
#define IncEmbSerialPU_M
#define XilSizeToDownloadD    (350000)   // 101001t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG  				(1)
#define UPD_BUFFER_SIZE 128
extern "C" void Init_PU_M(void);
extern "C" void PU_M(void);

 */
//_______________________________________

//101117 #define DEV_ETH_CAN_RESTART
//101117 #define ETH_CAN_RESTART

#define XIL2_BASE      				(pointer)(0x40000000) /* cs3 */
#define XIL2_SIZE      				(0x02000000) /*addresses  32Mb x 8 */

#define DPD_ADDRESS (0xC0400000)   //temporary
#define DPD_SIZE 	(40000)

#define cs_last_addr          0x50000000
//#define INTERRUPT_WAIT (2000000)//now so	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
//#define INTERRUPT_WAIT (200000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
#define XIL_LOAD_FREQ         2000000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
#define IncEmbSerialACT155
#define IncEmbSerialPU_M
//130730#define XilSizeToDownloadD    (350000)   // 101001t  have BIT files for all xilinxes
//#define XilSizeToDownloadD    (550000)   //130730  101001t  have BIT files for all xilinxes
#define XilSizeToDownloadD    (650000)   //130730  101001t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG  				(1)
#define UPD_BUFFER_SIZE 128
extern "C" void Init_PU_M(void);
extern "C" void PU_M(void);
#endif // PROG_PU_M_V



#ifdef PROG_COMMUTATOR1

#define CHECK_CRC

extern unsigned char hot_restart;
extern unsigned char used_TCP;

#define CASHE_OFF //??? why

#ifdef KSS_PRINT_LOG

extern unsigned long modem_req_cnt;

extern unsigned long modem_ans_cnt1;
extern unsigned long modem_ans_cnt2;
extern unsigned long modem_ans_cnt3;
extern unsigned long modem_ans_cnt4;
#endif


#ifdef TEST_PARSING_COMMANDS
extern "C" void TestParsing();
#endif

#define CHANGE_USART1_2

//120620 not need!!! #define PLUS_TR3


#define USE_USART2
#define CHANGE_USART12

#ifdef USE_USART2
#ifndef CHANGE_USART12
extern "C" void Remote_PRM_PCHS(void);
#else
extern "C" void Remote_PRM_PCHF(void);
#endif

extern "C" void Set_Usart2_To_RS485(void);

#endif

extern "C" void TestParser(void);

extern "C" unsigned char GetNeedWriteDevId(void);
extern "C" void SetNeedWriteDevId(void);
extern "C" void ClearNeedWriteDevId(void);
extern "C" void MakeKeepTest(void);


extern unsigned char numa[3], numb[3], numc[3];


extern "C" void StrToPdcTu1(unsigned char , unsigned char *);


//120621 now need use enover protokol with antenna #define  RS485_DISABLED

//120619 #define RS485E_ENABLED

extern unsigned long ch1ok, ch2ok, ch1bad, ch2bad;
#define HAVE_GATEWAY

#ifdef COUNT_BUFF_ERR
extern "C" unsigned long GetCounter1(void);
extern "C" unsigned long GetCounter2(void);
#endif	

#ifndef PU_M_TEST
//101209#define SEND_PERIOD (20)  //20 82 = 40 - for one channel period is 40
#define SEND_PERIOD (20)  //20 82 = 40 - for one channel period is 40
#else
#define SEND_PERIOD (3)  //20 82 = 40 - for one channel period is 40
#endif
//_________________________________________________pu_m_V
#define PUMV485_REQUEST_DELAY (250)
//#define	 PROG_PU_M_MUX
#define RRL_ADDR1 (1) //(0)
#define RRL_ADDR2 (2) //(0)
#define DEVCONFIG_QUANTITY (16)
#define DEV_INFO_SIZE (32)
#define BAD_POINTER (0xff)
#define MAX_NOT_ANSWERS_Q (10)
extern unsigned char cur_req_quantity;

extern "C" unsigned char GetDevQuantity(void);
extern "C" unsigned char GetDevAddr(unsigned char);
extern "C" unsigned char GetDevPointer(unsigned char);
extern "C" unsigned char Getudevconfig(unsigned char);
extern "C" void Setudevconfig(unsigned char,unsigned char);
extern "C" unsigned char GetDevType(unsigned char);
extern "C" void SetTestConfig(void);
extern "C" void SetNeedWriteDevId();

//_______________________________________
/*
#define DEV_ETH_CAN_RESTART
#define ETH_CAN_RESTART

#define XIL2_BASE      				(pointer)(0x40000000) 
#define XIL2_SIZE      				(0x02000000) 

#define DPD_ADDRESS (0xC0400000)   //temporary
#define DPD_SIZE 	(40000)

#define cs_last_addr          0x50000000
#define INTERRUPT_WAIT (2000000)//now so	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
//#define INTERRUPT_WAIT (200000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
#define XIL_LOAD_FREQ         2000000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
#define IncEmbSerialACT155
#define IncEmbSerialPU_M
#define XilSizeToDownloadD    (350000)   // 101001t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG  				(1)
#define UPD_BUFFER_SIZE 128
extern "C" void Init_PU_M(void);
extern "C" void PU_M(void);

 */
//_______________________________________

//101117 #define DEV_ETH_CAN_RESTART
//101117 #define ETH_CAN_RESTART

#define XIL2_BASE      				(pointer)(0x40000000) /* cs3 */
#define XIL2_SIZE      				(0x02000000) /*addresses  32Mb x 8 */

#define DPD_ADDRESS (0xC0400000)   //temporary
#define DPD_SIZE 	(40000)

#define cs_last_addr          0x50000000
//#define INTERRUPT_WAIT (2000000)//now so	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
//#define INTERRUPT_WAIT (200000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
#define XIL_LOAD_FREQ         2000000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
#define IncEmbSerialACT155
#define IncEmbSerialPU_M
#define XilSizeToDownloadD    (350000)   // 101001t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG  				(1)
#define UPD_BUFFER_SIZE 128
extern "C" void Init_PU_M(void);
extern "C" void PU_M(void);

extern "C" void Init_Comm1(void);
extern "C" void Comm1(void);





#define PROG_PU_M_V
#endif // PROG_COMMUTATOR1




#ifdef 	PROG_PD2
#define 	PROG_PD1
#endif



#ifdef 	PROG_PD1
#define PROG_UPS1
#define PD_DS
#ifdef PD_DS

#define TRY_FIND_ERR

#define WITHOUT_INTERRUPTS


extern "C" void ParseTCPPD(char *IPBuff, unsigned long len);
extern "C" void  ParseCommand1(void);
extern "C" void  ParseCommand2(char *IPBuff);
extern "C" void OperateBuffers_usart2(void);


#endif

#endif

	



#ifdef PROG_UPS1

#define PROG_UPS//

#endif

#ifdef PROG_UPS

#define WITHOUT_XILINX //
#define WITHOUT_INTERRUPTS //


//extern "C" void Set_Usart2_To_RS485(void);

#define USE_USART2

#ifdef USE_USART2
extern "C" void Remote_PRM_PCHS(void);
extern "C" void Set_Usart2_To_RS485(void);

#endif //USE_USART2


//#define MAKET_PLATA


extern unsigned long ch1ok, ch2ok, ch1bad, ch2bad;
//110324 #define HAVE_GATEWAY

#ifdef COUNT_BUFF_ERR
extern "C" unsigned long GetCounter1(void);
extern "C" unsigned long GetCounter2(void);
#endif	

#ifndef PU_M_TEST
//101209#define SEND_PERIOD (20)  //20 82 = 40 - for one channel period is 40
#define SEND_PERIOD (20)  //20 82 = 40 - for one channel period is 40
#else
#define SEND_PERIOD (3)  //20 82 = 40 - for one channel period is 40
#endif
//_________________________________________________pu_m_V
#define PUMV485_REQUEST_DELAY (250)
//#define	 PROG_PU_M_MUX
#define RRL_ADDR1 (1) //(0)
#define RRL_ADDR2 (2) //(0)
#define DEVCONFIG_QUANTITY (16)
#define DEV_INFO_SIZE (32)
#define BAD_POINTER (0xff)
#define MAX_NOT_ANSWERS_Q (10)
extern unsigned char cur_req_quantity;

extern "C" unsigned char GetDevQuantity(void);
extern "C" unsigned char GetDevAddr(unsigned char);
extern "C" unsigned char GetDevPointer(unsigned char);
extern "C" unsigned char Getudevconfig(unsigned char);
extern "C" void Setudevconfig(unsigned char,unsigned char);
extern "C" unsigned char GetDevType(unsigned char);
extern "C" void SetTestConfig(void);
extern "C" void SetNeedWriteDevId();

//_______________________________________
/*
#define DEV_ETH_CAN_RESTART
#define ETH_CAN_RESTART

#define XIL2_BASE      				(pointer)(0x40000000) 
#define XIL2_SIZE      				(0x02000000) 

#define DPD_ADDRESS (0xC0400000)   //temporary
#define DPD_SIZE 	(40000)

#define cs_last_addr          0x50000000
#define INTERRUPT_WAIT (2000000)//now so	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
//#define INTERRUPT_WAIT (200000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
#define XIL_LOAD_FREQ         2000000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
#define IncEmbSerialACT155
#define IncEmbSerialPU_M
#define XilSizeToDownloadD    (350000)   // 101001t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG  				(1)
#define UPD_BUFFER_SIZE 128
extern "C" void Init_PU_M(void);
extern "C" void PU_M(void);

 */
//_______________________________________

//101117 #define DEV_ETH_CAN_RESTART
//101117 #define ETH_CAN_RESTART

#define XIL2_BASE      				(pointer)(0x40000000) /* cs3 */
#define XIL2_SIZE      				(0x02000000) /*addresses  32Mb x 8 */

#define DPD_ADDRESS (0xC0400000)   //temporary
#define DPD_SIZE 	(40000)

#define cs_last_addr          0x50000000
//#define INTERRUPT_WAIT (2000000)//now so	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
//#define INTERRUPT_WAIT (200000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
#define XIL_LOAD_FREQ         2000000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
#define IncEmbSerialACT155
#define IncEmbSerialPU_M
#define XilSizeToDownloadD    (350000)   // 101001t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG  				(1)
#define UPD_BUFFER_SIZE 128
extern "C" void Init_UPS(void);
extern "C" void UPS(void);


#endif // PROG_UPS




#ifdef 	PROG_PRM_PCH_N_2
#define USE_USART2
#define  PROG_PRM_PCH_N_1
#endif //PROG_PRM_PCH_N_1


#ifdef 	PROG_PRM_PCH_N_1
#define  PROG_PRM_PCH_N
#endif //PROG_PRM_PCH_N_1

#ifdef USE_USART2
extern "C" void embRS232S_rcvbuf_Add(unsigned char);
extern "C" void Transmit2c(unsigned char);

#define USART2_TRY_PDC_1T //101004 : need check!!!!
#define USART2_TRY_PDC	  //101004 need check!!!
#endif //USE_USART2



#ifdef 	PROG_PD
#define	PROG_PRM_PCH_L_8
#endif




#ifdef 	PROG_PRM_PCH_L_8

#define	PROG_PRM_PCH_L_61

#endif



#ifdef 	PROG_PRM_PCH_L_61

extern "C" void  Init_pin_121(void);
extern "C" void  Operate_pin_121(unsigned char);




#define FIX_ATT (30)

#define	 PROG_PRM_PCH_L_6

#endif// PROG_PRM_PCH_L_61



#ifdef 	PROG_PRM_PCH_N
#define DIRECT_RS485
//#define PRM_PCH_N_RUN_IN_INTERRUPT
//extern unsigned char  transfer_flag;
#define PROG_PRM_PCH_L
extern "C" void SetLed3(unsigned char);
extern "C" void Remote_PRM_PCH(void);

#ifdef USE_USART2
extern "C" void Remote_PRM_PCHS(void);
#endif //USE_USART2

extern unsigned char Rej;
extern unsigned char Filtr;
extern unsigned short delay1;

#define DISABLE_ETHERNET

#endif //	PROG_PRM_PCH_N





#ifdef 	PROG_PRM_PCH_L_6

#define	 PROG_PRM_PCH_L

#endif// PROG_PRM_PCH_L_6




#ifdef 	PROG_PRM_PCH_L
#define PROG_PRM_PCH_S
extern "C" void RestoreFreq(unsigned char , unsigned long );
extern "C" void RestoreAtt(unsigned char , unsigned long );
extern "C" void RestoreAtt2(unsigned char , unsigned long );

extern "C" unsigned long GetFreq(unsigned char num);
extern "C" unsigned long GetAtt(unsigned char num);
extern "C" unsigned long GetAtt2(unsigned char num);
//extern "C" void GetAtt2(void);


extern "C" unsigned long GetAttRPU(unsigned char num);


extern "C" unsigned char GetNeedWriteDevId(void);
extern "C" void SetNeedWriteDevId(void);
extern "C" void ClearNeedWriteDevId(void);

extern "C" unsigned char GetNeedWriteDevId2(void);
extern "C" void SetNeedWriteDevId2(void);
extern "C" void ClearNeedWriteDevId2(void);




extern "C" void MakeKeepTest(void);
#endif //PROG_PRM_PCH_L





#ifdef  PROG_BMD155PS
#define PROG_BMD155
#define TIME_CHECK_LOCK	  (4000)

#endif //PROG_BMD34PS


#ifdef PROG_BMD34PS
#define TIME_CHECK_LOCK	  (3000)

#define PROG_BMD34
#endif //PROG_BMD34PS
//#define CASHE_SIZE (128)
//#define CASHE_SIZE (16)  //more as 1!
//#define CASHE_SIZE (2)  //more as 1!
//111109#define CASHE_SIZE (8)  //more as 1!
#define CASHE_SIZE (6)  //more as 1!



//#define TEST_MPC155 




//#ifdef PROG_BMD35
//#define PROG_BMD34
//#endif //PROG_BMD35


#ifdef 	PROG_ACT155

//#define HAVE_GATEWAY  //120120

//#ifdef CLEAR_ETH_COUNTER	   //<<!!!!!	this need uncomment in tcpip.c
#define CHECK_ETH_STATE //100302
#define ETH_CAN_RESTART	 //100302
//#endif // CLEAR_ETH_COUNTER
//#define  DO_NOT_CHECK_ETH_RATE
#define PROG_BMD155
#define DEV_ETH_CAN_RESTART

//#define USART1_TRY_PDC_1T
//#define USART0_TRY_PDC_1T
//#define USART1_TRY_PDC
//#define USART0_TRY_PDC_1

	
//#define RS485_NOT_DISABLE_ETHERNET
//#define ETH_NOT_STOPPED
extern unsigned char wd_reset_enabled;

#endif //PROG_ACT155

#ifdef 	PROG_ACT155N
#define ETH_TRANZIT
#define PROG_BMD155	
#define RRL_ADDR1 (1) //(0)
#define RRL_ADDR2 (2) //(0)
extern "C" void CheckClocks(void);


#endif //PROG_ACT155N


#ifdef 	PROG_BMD2
#define PROG_BMD34	
#endif //PROG_BMD2

//1230 #define ETH_SEND_TIMER (10)
//#define ETH_SEND_TIMER (15) //t
#define ETH_SEND_TIMER (10)

//t#define ETH_ANS_TIMER (15)
#define ETH_ANS_TIMER (15) //t
//#define ETH_ANS_TIMER (0)
//#define ETH_RECEIVE_TIMER (15)  //t
//#define ETH_RECEIVE_TIMER (500)	   //bad
//#define ETH_RECEIVE_TIMER (250)	//ok
//#define ETH_RECEIVE_TIMER (100)	//ok
#define ETH_RECEIVE_TIMER (20)	//ok



#define SERIAL_ETH_OFF_TIMEOUT_MS  1 /* 1ms eth getted of if receive command to serial*/
//t091227 #define SERIAL_ETH_OFF_TIMEOUT_MS  2 
//#define SERIAL_ETH_OFF_TIMEOUT_MS  5  //t
//#define SERIAL_ETH_OFF_TIMEOUT_MS  1000 
//#define SERIAL_ETH_OFF_TIMEOUT_MS   
//#define SERIAL_ETH_OFF_TIMEOUT_MS  0  //t

//#define ETH_SERIAL_OFF_TIMEOUT_MS  150 
//t #define ETH_SERIAL_OFF_TIMEOUT_MS  180 
//#define ETH_SERIAL_OFF_TIMEOUT_MS  0 //t   30% not answer
//#define ETH_SERIAL_OFF_TIMEOUT_MS  150
//#define ETH_SERIAL_OFF_TIMEOUT_MS  200	  // 172 -171
//#define ETH_SERIAL_OFF_TIMEOUT_MS  600	  // 172 -171
//#define ETH_SERIAL_OFF_TIMEOUT_MS  100	  //204 - 199
//090701 #define ETH_SERIAL_OFF_TIMEOUT_MS  75
#define ETH_SERIAL_OFF_TIMEOUT_MS  200
// not good #define ETH_SERIAL_OFF_TIMEOUT_MS  150
// better! #define ETH_SERIAL_OFF_TIMEOUT_MS  100 	//134 - 73
//t 090518 #define ETH_SERIAL_OFF_TIMEOUT_MS  50 
//#define ETH_SERIAL_OFF_TIMEOUT_MS  0 

//#define D485_REQUEST_DELAY	 (100)
//t160906#define D485_REQUEST_DELAY	 (51)
#define D485_REQUEST_DELAY	 (111)

//t#define D485_REQUEST_DELAY	 (31)
//#define D485_REQUEST_DELAY	 (1000)	  //test
//t  #define D485_REQUEST_DELAY	 (30)

//#define TBUFF1_VALUE (100)
//#define TBUFF1_VALUE (150)
#define TBUFF1_VALUE (200)
//enum Keys
// {
/*
#define    Enter   0
#define    Left    1
#define    Right   2
#define    Up 	   3
#define    Down    4
#define    Esc 	   5
#define    Update  6
#define    None	   7
*/

#ifdef PROG_PU_M_MUX_TEST
extern "C" void CompareRegs(void);
#endif //PROG_PU_M_MUX_TEST


extern "C" char CheckNWait(void);
extern "C" void Start_Test_MPC155(void);
extern "C" void Test_MPC155(void);
extern "C" void _at91rm9200_int_clear_all(void);
extern "C" void embRS232_rcvbuf_Add(unsigned char);
extern "C" void embRS485_rcvbuf_Add(unsigned char);
//extern "C" void test_PU37_interrupt_ovner(void);
extern "C" void test_PU37_start(void);
extern "C" void test_PU37(void);
extern "C" void StartTestTlf(void);
extern "C" void TestTlf(void);
extern "C" char TestRing(void);
extern "C" void StartRing(void);
//extern "C" void StopRing(void);


extern unsigned int IntFlag;
extern "C" void my_int_disable_irq0(void);
extern "C" void my_int_enable_irq0(void);
extern "C" void my_int_disable_irq2(void);
extern "C" void my_int_enable_irq2(void);
extern "C" void my_int_disable_usart0(void);
extern "C" void my_int_enable_usart0(void);
extern "C" void RS485_receive_enable();
extern "C" void RS485_receive_disable();
extern "C" void RS485_receive_reset();
extern "C" void RS485_enable_RX_interrupt();
extern "C" void RS485_disable_RX_interrupt();

extern "C" unsigned char is_usart1_enabled();

//extern "C" void EnableInterrupts(void);
//extern "C" void printd(unsigned char);
//extern unsigned char         tg;
extern unsigned long InterruptWatchDog;


#ifdef PROG_PRM_PCH_S	 //six channels

#define  PROG_PRM_PCH_C
#define  PRM_PCH_SIX_LINES
#define POWER_PORT2 (0x11)    //need chack after have protokol

#ifndef  PROG_PRM_PCH_L_8 

#define CH4_MASK (0x1)
#define NO_CH4_MASK (0xfe)
#define CH5_MASK (0x2)
#define NO_CH5_MASK (0xfd)

#define CH6_MASK (0x4)
#define NO_CH6_MASK (0xfb)


#else	 //PROG_PRM_PCH_L_8

#define CH4_MASK (0x8)
#define NO_CH4_MASK (0xf7)
#define CH5_MASK (0x10)
#define NO_CH5_MASK (0xef)

#define CH6_MASK (0x20)
#define NO_CH6_MASK (0xdf)

#define CH7_MASK (0x40)
#define NO_CH7_MASK (0xbf)

 //for test!!!
	  /*
#define CH7_MASK (0x20)
#define NO_CH7_MASK (0xdf)

#define CH6_MASK (0x40)
#define NO_CH6_MASK (0xbf)
  */


#define CH8_MASK (0x80)
#define NO_CH8_MASK (0x7f)

#endif	//PROG_PRM_PCH_L_8


extern unsigned char start4, start5, start6;
extern "C" void AlarmPmOff2(void);
extern "C" void AlarmPmOn(void);
extern "C" void AlarmPmOn2(void);

#endif // PROG_PRM_PCH_S

#define TYPE_AUTO 		(0)
#define TYPE_RUN_OK	 	(0xFF)
#define TYPE_RUN_BAD 	(0xFE)
#define TYPE_STATUS 	(0xFD)
#define CODE_RPU_STATE 	(0xFC)
#define CODE_COMMAND_8  (8)
#define REQUEST_SCAN 	(0xFC)
#define TYPE_RUN_9  	(0xFB)
#define TYPE_RUN_31  	(0xFA)
#define TYPE_RUN_32  	(0xF9)


#ifdef PROG_PRM_PCH_C	//three channels

//#define PRM_PCH_FORMULA6


extern "C" void CheckPower();
extern "C" void SetPower(unsigned char );
extern "C" void CheckAlarmsPm(void);





#define ENABLED_LOSS  (5)




//#define START_TIMEOUT  (4000) //4 sec
#define START_TIMEOUT  (5000) //4 sec


#define PROG_PRM_PCH
#define PRM_PCH_THREE_LINES

#define STATUS_PORT (0x3)

#define	SEARCH_CHANNEL1 (0x1)
#define	SEARCH_CHANNEL2 (0x2)
#define	SEARCH_CHANNEL3 (0x4)





#define POWER_PORT (0x10)
//#define LED_PORT   (0x4)

#define NO_ALARM_INPUT    (0x1)
#define ALARM_INPUT    (0xFE)

#define NO_ALARM_POWER    (0x2)
#define ALARM_POWER (0xFD)
#define NO_ALARM_PM 	(0x4)
#define ALARM_PM        (0xFB)

#define ALL_CH_POWER_ON (0x10)
#define CH1_MASK (0x1)
#define NO_CH1_MASK (0xfe)
#define CH2_MASK (0x2)
#define NO_CH2_MASK (0xfd)
#define CH3_MASK (0x4)
#define NO_CH3_MASK (0xfb)

extern unsigned char start1, start2,start3;
extern "C" void AlarmPmOn(void);
extern "C" void AlarmPmOff(void);
extern "C" void ClearMod(); 
extern "C" void ClearTransit(); 

#endif //PROG_PRM_PCH_C


#ifdef PROG_BACOD	
#define PROG_BACO
#endif


#ifdef PROG_BACO
extern "C" unsigned long ClockReadmSec();
extern unsigned long glob_cnt;
extern unsigned char time_valid;



//#define Debug_Baco   //ubx
//#define Debug_Baco1	 //timer start



extern unsigned char trysec; 
extern unsigned char trymin;
extern unsigned char tryhour;  
extern unsigned char tryday;
extern unsigned char trymon;
extern unsigned char tryyear;  


#define GPS_USART1

#define  NUM_OF_SLOT  (16)

extern "C" void LoadFiltersBaco();
extern "C" void LoadFreqBaco();
extern "C" void LoadModeBaco(unsigned char);



#define HEADER_SIZE 	(0x60)

#define VIDEO_ADDRESS (0xC0300000)   //temporary
#define VIDEO_SIZE 	(6200) //real 6144144
#define AUDIO_ADDRESS (0xC0310000)   //temporary
#define AUDIO_SIZE 	(30000) //real 28672


extern "C" char ubx_device_init();
extern "C" char ubx_device_mon();


#ifndef GPS_USART1

extern "C" unsigned char getbufferusart0();
extern "C" unsigned char haveusart0();
extern "C" unsigned char printbufferusart0();
#else

extern "C" unsigned char getbufferusart1();
extern "C" unsigned char haveusart1();
extern "C" unsigned char printbufferusart1();


#endif


void LoadBaco(unsigned char numslot);

extern "C"void TestChecksum();



extern "C" unsigned char ClockReadYear(void);
extern "C" unsigned char ClockReadMonth(void);
extern "C" unsigned char ClockReadDate(void);
extern "C" unsigned char ClockReadHours(void);
extern "C" unsigned char ClockReadMin(void);
extern "C" unsigned char ClockReadSec(void);






#define  CLOCK_ENABLED


extern "C" void  ParseCommand1(void);
extern "C" void  ParseCommand2(char *);
extern "C" void  ParseCommand3(char *);
extern "C" void  ParseCommand4(char *);
extern "C" void ParseTCPBACO(char *IPBuff, unsigned long len);


#define WITHOUT_INTERRUPTS

//#define ADDR_REG_ADDR  (0xA)

#define SAMPLEMAX_ADDR  (0)	 //low byte of 4 
//#define NUMBLOCKS_ADDR  (3)	 //low byte of 4 
#define SIZEBLOCKS_ADDR (6)	  //low byte of 2

#define IPLEN_ADDR      (8)	  //low byte of 2
#define IPIDENT_ADDR 	(0xa)	  //low byte of 2
#define RESET_ADDR 		(0xd)	  //low byte of 2


#define IPCRC_ADDR 		(0xc)	  //low byte of 2
#define UDPLEN_ADDR 	(0xe)	  //low byte of 2
#define MAC_SOURCE_ADDR (0x10)	  //low byte of 2
#define MAC_DEST_ADDR 	(0x16)	  //low byte of 2
#define IP_SOURCE_ADDR 	(0x1c)	  //low byte of 2
#define IP_DEST_ADDR 	(0x20)	  //low byte of 2
#define UDP_SOURCE_ADDR (0x24)	  //low byte of 2
#define UDP_DEST_ADDR 	(0x26)	  //low byte of 2
#define YEAR_ADDR 		(0x28)	  //low byte of 2
#define MONTH_ADDR 		(0x29)	  //low byte of 2
#define DAY_ADDR 		(0x2a)	  //low byte of 2
#define HOUR_ADDR 		(0x2b)	  //low byte of 2
#define MIN_ADDR 		(0x2c)	  //low byte of 2
#define SEC_ADDR 		(0x2d)	  //low byte of 2
#define N0_ADDR 		(0x2e)	  //low byte of 2
#define N1_ADDR 		(0x2f)	  //low byte of 2
#define N2_ADDR 		(0x30)	  //low byte of 2
#define N3_ADDR 		(0x31)	  //low byte of 2
#define MS100_ADDR 		(0x32)	  //low byte of 2





#define BACO_START_ADDR	(0xA)	  //1 - start	 absolute

#define DATA_REG_ADDR  (0xF)

#define BACO_OFFSET	  (0)	
#define BACO_OFFSET_FILTER	  (0x500)	
#define MAX_FILTER_SIZE	  (1500)

#define BACO_OFFSET_FREQ  (0xC00)	//4

#define BACO_OFFSET_MODE  (0xC10)	 //4  do not used now

#define BACO_OFFSET_SIGNATURE   (0x10000C14)  //

#define BACO_OFFSET_BSC   (0x10000C20)  //12 * 8	 (8+2+1+1)*(NUM_OF_SLOT>>1)

 
	


#define PROG_MF20
extern "C" void baco_init();
extern "C" void baco();

#endif


#ifdef 	PROG_MF20

//#define LOCK_ENABLED
//#define INTERRUPT_WAIT (2000000)
#define cs_last_addr          0x30000000
//141204 #define XIL_LOAD_FREQ         3000000
#define XIL_LOAD_FREQ         800000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
//#define IncEmbIndicator
#define IncEmbSerialMF20
#define XilSizeToDownloadD    (100000)   // Spartan2-50
#define XilSizeToDownloadD2   (285000)
#define XilSizeToDownloadD3   (285000)
#define XILINXPG			  (1)
extern "C" void SaveCommut2(unsigned char);
extern "C" void mf20(void);
#endif //PROG_MF20

#ifdef 	PROG_TUTS

#define CASHE_OFF //

#define LOCK_ENABLED
//#define INTERRUPT_WAIT (2000000)
#define cs_last_addr          0x30000000
#define XIL_LOAD_FREQ         3000000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
//t 1024 #define IncEmbIndicator
#define IncEmbSerialMF20
#define XilSizeToDownloadD    (71000)   // Spartan2-50
#define XilSizeToDownloadD2   (285000)
#define XilSizeToDownloadD3   (285000)
#define XILINXPG			  (1)


extern "C" void TUTS(void);
extern "C" void TUTS_init(void);
extern "C" void TUTS_IO_Init(void);
extern "C" unsigned long Inputs_Monitoring(unsigned long);
extern "C" void Inputs_Scan(void);
extern "C" unsigned long Inputs_Triggered_Monitoring(void);
extern "C" char Outputs_Monitoring(void);
extern "C" void Set_Outputs(unsigned char);
extern "C" void Reset_Triggered(unsigned long);
extern "C" void SetHardvareOuts(unsigned char );
extern "C" void SetHardvareInps(unsigned long);
extern "C" void SetHardvareTrInps(unsigned long);

#endif //PROG_TUTS

#ifdef 	PROG_KTVM

#define KTVM_PROT2

#ifdef 	KTVM_PROT2
extern "C" void SetProtokol(unsigned char);
extern "C" void remote_prot2(void);
extern "C" void EmbSetProt(unsigned char);
extern "C" unsigned char EmbGetProt(void);
extern "C" int start_ktvm(void);

#endif //KTVM_PROT2

extern "C" unsigned long GetRemoteMode(void);


extern "C" void SetPLLKTVM();
extern "C" void SetPll();


extern "C" unsigned char LoadCoder(unsigned char);

#define USE_PULT
#define PULT_USART
#define PROGRAMM_PULT //to programm flash of pult
#define ETH_DEBUG_ENABLED	// debug from ethernet enabled

//ok #define INTERRUPT_WAIT (200)
//#define INTERRUPT_WAIT (2000000)
//#define cs_last_addr          0x30000000
#define cs_last_addr          0x40000000
//#define XIL_LOAD_FREQ         3000000
#define XIL_LOAD_FREQ         2000000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
#define IncEmbIndicator
#define IncEmbSerialMF20
#define XilSizeToDownloadD    (550000 )   // ?????
#define XilSizeToDownloadD2   (285000)
#define XilSizeToDownloadD3   (285000)
#define XILINXPG			  (1)

extern "C" void ToIBuf(unsigned char data);
extern "C" void PultDelay(void);
//extern "C" void SaveCommut2(unsigned char);
extern "C" void ktvm(void);
extern "C" void Encoder_Set(void);
extern char start_key;
extern "C" void SetRate(unsigned char);
extern "C" void SetVideo(unsigned char);
extern "C" void SetTestSignal1(unsigned char);
extern "C" void SetSound1(unsigned char);
extern "C" void SetState1(unsigned long);
extern "C" void SetPoint1(unsigned long);
extern "C" void SetAddr1(unsigned long);

#define printff (printf)
#define DPD_ADDRESS (0xC0400000)
#define DPD_SIZE 	(40000)
#define MIData (0x10)
#define MICmd  (0x11)
#define MISts  (0x12)
#define MIRes  (0x13)
#define MISet  (0x14)
#define MISlt  (0x15)
//const int MIPll  = 0x516;
#define MIInt  (0x17)
#define MIBuff (0x16)

#define MIRD  (0x00)
#define MIWR  (0x20)
#define MIRq  (0x40)
#define MICS  (0x80)

#define MIRST  (0x08)
#define MIRDY  (0x02)
#define MIROM  (0x01)
#define MILDC  (8)
#define MIRSTA (0x10)

#define video_on     (0x01) //   
#define start_err    (0x02) //   
#define Fifo_full    (0x40) //   
#define stuff_err    (0x04) //   
#define VLD_off      (0x08) //   
#define video_int    (0x10) //   
#define start_ok     (0x20) //  

#endif //PROG_KTVM

#ifdef 	PROG_DTVM

#define KTVM_PROT2

#define STATE_REGISTER (0xE3)		//    1
#define SOUND_STATE_REGISTER (0xF4)
#define XILINX_ALARM_REGISTER (0xF6)  //    
#define Tx34           0x03		  //   DTVM

extern unsigned char GetMode(void);
extern unsigned int Ret_code;
#define E14norma    (4)//     1  
#define ALARM_RELE (1)
#define RS_synck    (8)//      -


extern "C" void FillSynceVersion2();
extern "C" void SetProtokol(unsigned char);
extern "C" void remote_prot2(void);
extern "C" void EmbSetProt(unsigned char);
extern "C" unsigned char EmbGetProt(void);
extern "C" unsigned char EmbGetSound();
extern "C" unsigned long GetRemoteMode(void);
extern "C" void	TestWrite(void);
			   


#define USE_PULT
#define PULT_USART
#define PROGRAMM_PULT       //to programm flash of pult
#define ETH_DEBUG_ENABLED	// debug from ethernet enabled

//ok #define INTERRUPT_WAIT (200)
//#define INTERRUPT_WAIT (2000000)
#define cs_last_addr          0x30000000
//#define XIL_LOAD_FREQ         3000000
#define XIL_LOAD_FREQ         1500000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
#define IncEmbIndicator
#define IncNMI
#define IncEmbSerialMF20
#define XilSizeToDownloadD    (600000 )   //   ?????
#define XilSizeToDownloadD2   (285000)	  //
#define XilSizeToDownloadD3   (285000)	  //
#define XILINXPG			  (1)
extern "C" void ToIBuf(unsigned char data);
extern "C" void PultDelay(void);
extern "C" void dtvm(void);
extern "C" void dtvm_init();
extern "C" void dtvm_init1();


extern "C" void SetE14();
extern "C" void Init_CS24(void);
extern "C" void Init_CS241(void);
extern char start_key;
extern "C" void SetRate(unsigned char);
extern "C" void SetVideo(unsigned char);
extern "C" void SetTestSignal1(unsigned char);
extern "C" void SetSound1(unsigned char);
extern "C" void SetState1(unsigned long);
extern "C" void SetErr1(unsigned long);
extern "C" void SetPoint1(unsigned long);
extern "C" void SetAddr1(unsigned long);


extern "C" unsigned char GetRate(void);
#define printff (printf)
#define DPD_ADDRESS (0xC0400000)
#define DPD_SIZE 	(40000)

#define HEADER_SIZE 	(0x60)


#define VIDEO_ADDRESS (0xC0300000)   //temporary
#define VIDEO_SIZE 	(6200) //real 6144144
#define AUDIO_ADDRESS (0xC0310000)   //temporary
#define AUDIO_SIZE 	(30000) //real 28672



#endif //PROG_DTVM

#ifdef 	PROG_BMD34
#define cs_last_addr          0x30000000
//#define INTERRUPT_WAIT (2000000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
#define XIL_LOAD_FREQ       	3000000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
#define IncEmbSerialMD34AVT
#define XilSizeToDownloadD    (740000)   // t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG				(1)
extern "C" void Init_BMD34(void);
extern "C" void BMD34(void);
#endif //PROG_BMD34

#ifdef 	PROG_PROV

//#define VIDEO_ADDRESS (0xC0300000)   //temporary
//#define VIDEO_SIZE 	(6200) //real 6144

//#define AUDIO_ADDRESS (0xC0310000)   //temporary
//#define AUDIO_SIZE 	(30000) //real 28672


#define ProvDataAddressD       (0xC0310000)	 //as audio
#define ProvSizeToDownloadD    (100000) 

#define ProvDataAddressDCfg       (0xC0300000) //as video
//#define ProvSizeToDownloadDCfg    (60000) 

#define ETH_TRANZIT	 //?
#define TIME_CORRECTOR (1000)

#define IncEmbSerialMD34AVT //to add transit

#define USE_PULT
#define PULT_USART
#define PROGRAMM_PULT //to programm flash of pult
#define ETH_DEBUG_ENABLED	// debug from ethernet enabled

#define DPD_ADDRESS (0xC0400000)
#define DPD_SIZE 	(40000)
extern "C" void ReadDPD(char * );
extern int psp_number;	
void save_e14_reg(int , int , int , unsigned , unsigned char );
int SetBusy8k(int , unsigned char *);
int FindFree8k(int , unsigned char *);
unsigned char load_e14_reg(int , int , int , unsigned );
extern "C" void ReadDPD(char * );
extern "C" void InitFreePtr(void);
extern "C" void ToIBuf(unsigned char data);
extern "C" void PultDelay(void);


#define cs_last_addr          0x30000000
//#define INTERRUPT_WAIT 		  (2000000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
#define XIL_LOAD_FREQ         3000000

#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
#define IncEmbIndicator
#define IncEmbSerialACT8

//#define IncEmbSerialMD34AVT		//need delete?

//#define XilSizeToDownloadD    (740000)   // t  have BIT files for all xilinxes
#define XilSizeToDownloadD    (860000)   // 3x500 xilinx

#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG				(1)
//extern "C" void Init_BMD34(void);
//extern "C" void BMD34(void);
extern "C" void Init_PROV(void);
extern "C" void  PROV(void);
extern "C" unsigned long GetRemoteMode(void);
extern "C" void SetProtokol(unsigned char);
extern "C" void EmbSetProt(unsigned char);
extern "C" unsigned char EmbGetProt(void);
extern "C" void EmbSetSound(unsigned char);
extern "C" unsigned char EmbGetSound(void);
#define DELAY_PSP (100)
#define DELAY_MENU (500)
#endif //PROG_PROV

#ifdef 	PROG_BMD35

#define CASHE_OFF

#define ETH_TRANZIT
#define TIME_CORRECTOR (1000)

#define IncEmbSerialMD34AVT //to add transit

#define USE_PULT
#define PULT_USART
#define PROGRAMM_PULT //to programm flash of pult
#define ETH_DEBUG_ENABLED	// debug from ethernet enabled

#define DPD_ADDRESS (0xC0400000)
#define DPD_SIZE 	(40000)
extern "C" void ReadDPD(char * );
extern int psp_number;	
void save_e14_reg(int , int , int , unsigned , unsigned char );
int SetBusy8k(int , unsigned char *);
int FindFree8k(int , unsigned char *);
unsigned char load_e14_reg(int , int , int , unsigned );
extern "C" void ReadDPD(char * );
extern "C" void InitFreePtr(void);
extern "C" void ToIBuf(unsigned char data);
extern "C" void PultDelay(void);


#define cs_last_addr          0x30000000
//#define INTERRUPT_WAIT 		  (2000000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
#define XIL_LOAD_FREQ         3000000

#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
#define IncEmbIndicator
#define IncEmbSerialACT8

//#define IncEmbSerialMD34AVT		//need delete?

//#define XilSizeToDownloadD    (740000)   // t  have BIT files for all xilinxes
#define XilSizeToDownloadD    (860000)   // 3x500 xilinx

#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (0)  
#define XILINXPG				(1)
//extern "C" void Init_BMD34(void);
//extern "C" void BMD34(void);
extern "C" void Init_BMD35(void);
extern "C" void  BMD35(void);
extern "C" unsigned long GetRemoteMode(void);
extern "C" void SetProtokol(unsigned char);
extern "C" void EmbSetProt(unsigned char);
extern "C" unsigned char EmbGetProt(void);
extern "C" void EmbSetSound(unsigned char);
extern "C" unsigned char EmbGetSound(void);
#define DELAY_PSP (100)
#define DELAY_MENU (500)
#endif //PROG_BMD35







#ifdef 	PROG_MPC35

#define CASHE_OFF //

#define MPC35_MOD_CHANNEL
#define ETH_TRANZIT


//#define IncEmbSerialMD34AVT //to add transit
#define TIME_CORRECTOR (1000)
#define USE_PULT
#define PULT_USART
#define PROGRAMM_PULT //to programm flash of pult
#define ETH_DEBUG_ENABLED	// debug from ethernet enabled

#define DPD_ADDRESS (0xC0400000)
#define DPD_SIZE 	(40000)
extern "C" void ReadDPD(char * );
extern int psp_number;	
void save_e14_reg(int , int , int , unsigned , unsigned char );
int SetBusy8k(int , unsigned char *);
int FindFree8k(int , unsigned char *);
unsigned char load_e14_reg(int , int , int , unsigned );
extern "C" void ReadDPD(char * );
extern "C" void InitFreePtr(void);
extern "C" void ToIBuf(unsigned char data);
extern "C" void PultDelay(void);


#define cs_last_addr          0x30000000
//#define INTERRUPT_WAIT 		  (2000000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
#define XIL_LOAD_FREQ         3000000

#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
#define IncEmbIndicator
#define IncEmbSerialACT8
#define IncEmbSerialMD34AVT //090302 to add transit

//#define IncEmbSerialMD34AVT		//need delete?

#define XilSizeToDownloadD    (175000)   // t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG				(1)
//extern "C" void Init_BMD34(void);
//extern "C" void BMD34(void);
extern "C" void Init_MPC35(void);
extern "C" void  MPC35(void);
extern "C" unsigned long GetRemoteMode(void);
extern "C" void SetProtokol(unsigned char);
extern "C" void EmbSetProt(unsigned char);
extern "C" unsigned char EmbGetProt(void);
extern "C" void EmbSetSound(unsigned char);
extern "C" unsigned char EmbGetSound(void);
//t #define DELAY_PSP (500)
//#define DELAY_PSP (100)
#define DELAY_PSP (500)
#define DELAY_MENU (500)

#endif //PROG_MPC35







#ifdef 	PROG_MPC155
#define cs_last_addr          0x40000000

//#define INTERRUPT_WAIT (2000000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?

#define XIL_LOAD_FREQ       	3000000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
//#define IncEmbSerialMD34AVT
//#define OEDBASE  			  0x90000000

#define XilSizeToDownloadD    (180000)   // t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG				(1)
extern "C" void Init_MPC155(void);
extern "C" void MPC155(void);
extern "C" unsigned short InOED(unsigned short);
extern "C" void OutOED(unsigned short , unsigned short );
extern "C" void TestTlfMX155();
extern "C" void StartTestTlfMX155();
extern "C" void test_PU37_startMX155();
//extern "C" void tes"C" void tes);
extern "C" void Start_TestMX155();


#endif //PROG_MPC155

#ifdef 	PROG_MPC4E

#define cs_last_addr          0x40000000

//#define INTERRUPT_WAIT (2000000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?

#define XIL_LOAD_FREQ       	3000000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
//#define IncEmbSerialMD34AVT
//#define OEDBASE  			  0x90000000

#define XilSizeToDownloadD    (180000)   // t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000) //to can Spartan3 500
#define XilSizeToDownloadD3    (285000)  
#define XILINXPG				(1)
extern "C" void Init_MPC4E(void);
extern "C" void MPC4E(void);
extern "C" unsigned short InOED(unsigned short);
extern "C" void OutOED(unsigned short , unsigned short );
extern "C" void TestTlfMPC4E();
extern "C" void StartTestTlfMPC4E();
extern "C" void test_PU37_startMPC4E();
//extern "C" void tes"C" void tes);
extern "C" void Start_Test_MPC4E();
extern "C" void Test_MPC4E();
extern "C" void m_get_clk1();

#endif //PROG_MPC4E







#ifdef 	PROG_BUKC

#define DEV_ETH_CAN_RESTART
#define ETH_CAN_RESTART


#define cs_last_addr          0x30000000
//#define INTERRUPT_WAIT (2000000)//now so	 //i enable no more 200000 interrupts irq 0 in 1 ms - not mama?
//#define INTERRUPT_WAIT (200000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
#define XIL_LOAD_FREQ         2000000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
#define IncEmbSerialACT155
#define IncEmbSerialPU_M
#define XilSizeToDownloadD    (72000)   // t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG  				(1)
#define UPD_BUFFER_SIZE 128
extern "C" void Init_BUKC(void);
extern "C" void BUKC(void);
#endif //PROG_BUKC

#ifdef 	PROG_PRM_PCH

#define cs_last_addr          0x30000000

//#define INTERRUPT_WAIT (2000000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?

//#define XIL_LOAD_FREQ       	500000
//blink somtime led #define XIL_LOAD_FREQ       	200000
//t #define XIL_LOAD_FREQ       	2000000
//120306 #define XIL_LOAD_FREQ       	3000000
#define XIL_LOAD_FREQ       	1000000		 //120306
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
//#define IncEmbNMI
//#define IncEmbIndicator
#define IncEmbSerialMD34AVT
//#define XilSizeToDownloadD    (48)   // to can Spartan3 500
//#define XilSizeToDownloadD    (200000)   // to can Spartan3 500
//t #define XilSizeToDownloadD    (175000)   // to can Spartan3 2500
//#define XilSizeToDownloadD    (169217)   // t   to can Spartan3 2500
#define XilSizeToDownloadD    (740000)   // t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG				(1)

extern "C" void Init_PRM_PCH(void);
extern "C" void PRM_PCH(void);
extern "C" void Remote_PRM_PCH(void);


#endif //PROG_PRM_PCH

#ifdef PROG_PU_M710	  //pu_m710.cpp

#define CHECK_CRC

extern unsigned char hot_restart;


//#define TEMPORARY_DO_NOT_STOP_RECEIVE


#define STATUS_TRANZIT_ADDR	(3)
#define DIS_R	(8)
#define DIS_T	(4)
extern "C" unsigned char ForwardingEnabled();

extern unsigned char used_TCP;
extern "C" unsigned char * ReadSpiTemp(void);
extern "C" void LoadReg(unsigned char dev, unsigned char reg, unsigned char val);
extern "C" void PVG710_Init(unsigned char);
extern unsigned long timer_oper_prog;

#define TIMER_OPER_PROG (1000)
#define STATE_SCAN_PERIOD (5000)


extern "C" void ParseOperProg();
extern signed long GetTemp();
extern "C" void SetLoop710(unsigned char dev, unsigned char bbloop, unsigned char ifloop);
extern "C" void InitOperProg();
extern "C" unsigned char GetMidBand(unsigned char dev);
extern "C" unsigned char GetMidBand1(unsigned char dev);

extern unsigned char oldflag;
extern unsigned char oldflag_710; //need init
extern unsigned char oldflag_ud1; //need init
extern unsigned char oldflag_ud2; //need init
extern unsigned char oldflag_prv;
extern unsigned char oldflag_prv1;
extern unsigned char dev_status;


#define	PROG_PU_M
#define STATUS_UP	(4)
#define MOD_LED_ADDR3  (0x16) //22
#define USE_P710
#ifdef USE_P710
#define BLOCK_SWEEP1	(0x20) //= 32
#define ADDR_STATUS1 (0x18)	//24
#define SPI_PORT_ADDR (0x17) //23
#define SPI_ADR		(0x19)	  //25
#define SPI_SEND_ADDR (0x1A)	//26

#define CHANNEL_T 	 (0xE)
#define CHANNEL_710A (0xC)
#define CHANNEL_710B (0xD)

#define CHANNEL_A (0x08)
#define SEND_ALL (0xff)
#define  ALARM_LEVEL_UD (4)
#define	 NORMA_UD1_BIT (0x10) //1 and 2 changed!!!!
#define	 NORMA_UD2_BIT (0x20)
//#define STATUS710_PORT	(0x14)
#define STATUS710_PORT	(0x1B)
#define	 NORMA_BIT1	(0x4)

#endif


#endif

#ifdef 	PROG_PU_M

#define HAVE_GATEWAY

extern "C" void SetNetworkRem(unsigned long NewNetwork);
extern "C"unsigned long GetNetworkRem(void);

extern "C" void SetNetMaskRem(unsigned long NewNetMask);

extern "C"unsigned long GetNetMaskRem(void);


#define FULL_TEST_TRANZIT

#define DPD_ADDRESS (0xC0400000)   //temporary
#define DPD_SIZE 	(40000)

#define cs_last_addr          0x30000000
//#define INTERRUPT_WAIT (2000000)//now so	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
//#define INTERRUPT_WAIT (200000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
#define XIL_LOAD_FREQ         2000000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
#define IncEmbSerialACT155
#define IncEmbSerialPU_M
//101001#define XilSizeToDownloadD    (180000)   // t  have BIT files for all xilinxes
//120916#define XilSizeToDownloadD    (350000)   // t  have BIT files for all xilinxes
//#define XilSizeToDownloadD    (455000) //120916  // t  have BIT files for all xilinxes
#define XilSizeToDownloadD	  (800000)	//140418
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG  				(1)
#define UPD_BUFFER_SIZE 128
extern "C" void Init_PU_M(void);
extern "C" void PU_M(void);
#endif //PROG_PU_M

#ifdef 	PROG_PU_M100
#define FULL_TEST_TRANZIT

#define DPD_ADDRESS (0xC0400000)   //temporary
#define DPD_SIZE 	(40000)

#define cs_last_addr          0x30000000
//#define INTERRUPT_WAIT (2000000)//now so	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
//#define INTERRUPT_WAIT (200000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
#define XIL_LOAD_FREQ         2000000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
//#define IncEmbSerialACT155
#define IncEmbSerialPU_M
#define XilSizeToDownloadD    (350000)   // t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG  				(1)
#define UPD_BUFFER_SIZE 128
extern "C" void Init_PU_M(void);
extern "C" void PU_M(void);
#endif //PROG_PU_M100

#ifdef 	PROG_PU_MSAT3
#define	PROG_PU_MSAT
#endif




#ifdef 	PROG_PU_MSAT4
#define	PROG_PU_MSAT1
#endif


#ifdef 	PROG_PU_MSAT1
#define	PROG_PU_MSAT
#endif

#ifdef 	PROG_PU_MSAT5
#define	PROG_PU_MSAT
#endif





#ifdef 	PROG_PU_MSAT

extern "C" long  Get_SERIAL(void );


extern "C" void Set_SYMBRATE( unsigned long); 
extern "C" long Get_SYMBRATE();
extern "C" long Get_IFDownLink();
extern "C" long Get_IFUpLink();
extern "C" void Set_SYSDELAY( unsigned long); 
extern "C" long Get_SYSDELAY();
extern "C" void Set_OUTLEVEL( signed long); 
extern "C" long Get_OUTLEVEL();
extern "C" void Set_RFREQ( unsigned long); 
extern "C" long Get_RFREQ();
extern "C" void Set_TFREQ( unsigned long); 
extern "C" long Get_TFREQ();

  extern "C" void Set_TFRAME( unsigned long); 
  extern "C" long Get_TFRAME();
  
  extern "C" void Set_SLEVEL( signed long); 
  extern "C" long Get_SLEVEL();
  
  extern "C" void Set_UPLINKMODE( unsigned long); 
  extern "C" long Get_UPLINKMODE();
  
  extern "C" void Set_TESTMODE( unsigned long); 
  extern "C" long Get_TESTMODE();
  
  extern "C" void Set_EXTLOCK( unsigned long); 
  extern "C" long Get_EXTLOCK();
  
  extern "C" void Set_EXTLOCKP( unsigned long); 
  extern "C" long Get_EXTLOCKP();
  
  extern "C" void Set_ALARM( unsigned long); 
  extern "C" long Get_ALARM();

 extern "C" void Set_ANALOGFILTER( signed long); 
  extern "C" long Get_ANALOGFILTER();

  extern "C" void Set_DIGITALFILTER( signed long); 
  extern "C" long Get_DIGITALFILTER();

  extern "C" void Set_UNLOCKTIMER( signed long); 
  extern "C" long Get_UNLOCKTIMER();

  extern "C" void Set_PROCESSINGFREQ( signed long); 
  extern "C" long Get_PROCESSINGFREQ();

  extern "C" void Set_PROCESSINGOFFSET( signed long); 
  extern "C" long Get_PROCESSINGOFFSET();



  extern "C" void Set_ACCESSCODE( signed long); 
  extern "C" unsigned long Get_ACCESSCODE();

  extern "C" void Set_ACCESSLEVEL( signed long); 
  extern "C" long Get_ACCESSLEVEL();

  extern "C" void Set_DEMOMODE( signed long); 
  extern "C" long Get_DEMOMODE();

 // extern "C" long Get_FPGAVER();
 // extern "C" long Get_PROGVER();

extern "C"   unsigned char * Get_FPGAVER(unsigned long* );
extern "C"   unsigned char * Get_PROGVER(unsigned long* );






 
extern "C"  long Get_IFDOWNLINK(void);
extern "C"  long Get_IFUPLINK(void);
extern "C"  long Get_FREQOFFSET(void);
extern "C"  long Get_CHANNELDELAY(void);
extern "C"  long Get_IFBALANCE(void);


extern "C" float GetFreqOffset();


#define SIGN_FLAG	 (0x95)
extern unsigned long  FlagOldSatAlev;// = 0;
extern unsigned char OldSatAlev; //0;


extern "C" void SetSatTestModeI(void);

#define LINE_LOCK
extern "C" void SetOLock(void);
extern "C" void ClearOLock(void);

extern "C" unsigned char GetLock(void);
extern "C" void Init_Alarms_IOs(void);

extern "C" void ResetPult(void);


#define USE_HTTP
#ifdef USE_HTTP
#define EVENTS_IN_LIST	(2)
extern unsigned long page_number;
extern unsigned long start_event;
#endif


#define HAVE_GATEWAY


#define RECEIVE_MOD_LOCK 


#ifdef RECEIVE_MOD_LOCK 
extern "C" void SetModLock();
extern "C" void SetModUnLock();
extern unsigned long unlockcounter;
#define MAX_UNLOCK_VALUE  (3)
//#define MOD_LOCK (0)
//#define MOD_UNLOCK (1)

#define MOD_LOCK (1)
#define MOD_UNLOCK (0)

#define MOD_UNDEF (2)
#ifdef RECEIVE_MOD_LOCK 
extern unsigned char lockstate;
#endif


#endif

//#ifdef YOURNAL
//extern "C" void SetLogClear();

//#endif

extern unsigned long password_state;
//#define USE_HTTP
//#define HTTP_PRINTM
extern unsigned char key_enter_flag;

extern "C" void FillClasses();


//#define LEN_PUM100S1 (36)
//140902#define LEN_PUM100S1 (37)
#define LEN_PUM100S1 (51)

 
extern "C" void FillRadianVersion();

extern "C" void KeepState(void);


#define YOURNAL

#define ETH_DEBUG_ENABLED	//to print if programm pult

#define PROGRAMM_PULT

#define WITHOUT_INTERRUPTS //temporary 120420

#define F_SYSTEM (100000000)   //100 MHz

//130412 #define	 MIN_SATSET0    (F_SYSTEM/255)	// (392157)
#define	 MIN_SATSET0    (F_SYSTEM/511)	// 130412 (392157)
#define	 MAX_SATSET0	(F_SYSTEM)

//#define	 MIN_SATSET1	(248.730)
//#define	 MAX_SATSET1	(353.178)

#ifndef	PROG_PU_MSAT4

#define	 MIN_SATSET1	(238.470)

#ifdef	PROG_PU_MSAT3

#define	 MIN_SATSET1	(238.470)

#else

#define	 MIN_SATSET1	(238.670)


#endif


#else

#define	 MIN_SATSET1	(238.670)

#endif
	/*

#ifdef	PROG_PU_MSAT1
#define	 MIN_SATSET1	(238.470)
#else
#define	 MIN_SATSET1	(238.470)
#endif

#endif

#ifdef	PROG_PU_MSAT4
#define	 MIN_SATSET1	(238.270)
#endif

#ifdef	PROG_PU_MSAT3
#define	 MIN_SATSET1	(238.470)
#endif
 */



//#define	 MIN_SATSET1	(212.250)

//#define	 MAX_SATSET1	(342.304)
//#define	 MAX_SATSET1	(343.123)
#define	 MAX_SATSET1	(343.123)


//#define	 MIN_SATSET2	(0)
//#define	 MAX_SATSET2	(255)

//#define	 MIN_SATSET2	(0)
//#define	 MAX_SATSET2	(255)
//#define	 MIN_SATSET2	(float64)(-43.0)
//t#define	 MAX_SATSET2	(float64)(-12.0)
#define	 MIN_SATSET2	(float64)(12.0)
#define	 MAX_SATSET2	(float64)(43.0)



//140227#define	 MIN_SATSET3	(0)
#define	 MIN_SATSET3	(-8)
//#define	 MAX_SATSET3	(0xFFFF)
//130517#define	 MAX_SATSET3	(0xFF)
//140227#define	 MAX_SATSET3	(0xF)
#define	 MAX_SATSET3	(7)

#define	 MIN_SATSET4	(40000)	 //* 100000
//#define	 MAX_SATSET4	(100000)	 //* 100000
#define	 MAX_SATSET4	(145000)	 //* 100000
#define	 MIN_SATSET5	(40000)	//* 100000
//#define	 MAX_SATSET5	(100000)	 //*100000
#define	 MAX_SATSET5	(145000)	 //*100000
#define	 MIN_SATSET6	(1)
#define	 MAX_SATSET6	(30)  //*1000000
#define	 MIN_SATSET7	(1)
#define	 MAX_SATSET7	(30)   //*1000000


//t#define	 MIN_SATSET8	(0)
#define	 MIN_SATSET8	(-1000)


#define	 MAX_SATSET8	(1000)   //*1000000


#define	 MIN_SATDF	(0)
#define	 MAX_SATDF	(12)
//#define	 MAX_SATDF	(255)

#define	 MIN_SATTF	(0)
#define	 MAX_SATTF	(15)
//#define	 MAX_SATTF	(255)


#define	 MIN_SATRATE	(1)
#define	 MAX_SATRATE	(50000)
#define	 SATRATE_LEV0	(5000)
#define	 SATRATE_LEV1	(15000)

#define	 MIN_SATTIMER	(0)
#define	 MAX_SATTIMER	(0xF)

#define MIN_SATEXTLOCK	(0)
#define MAX_SATEXTLOCK	(1)

#define MIN_SATEXTLOCKP	(0)
#define MAX_SATEXTLOCKP	(1)

#define MIN_SATLOWP	(0)
#define MAX_SATLOWP	(1)

#define MIN_SATALEV	(0)
#define MAX_SATALEV	(2)

#define ING_CODE_LEV0 (11)
#define ING_CODE_LEV1 (22) //(192837)
#define ING_CODE_LEV2 (33) //(918273)

#define ONE_DAY_VALUE  (2*30*60*24)
//#define ONE_DAY_VALUE  20  //tmp



#define MIN_SATACODE	(0)
#define MAX_SATACODE	(0xFFFFFFFF)

#define MIN_SATADEMO	(0)
#define MAX_SATADEMO	(1)

#define MIN_SATACNT		(0)
#define MAX_SATACNT		(0xFFFFFFFF)









#define	 MIN_SATTESTMODE	(0)
#define	 MAX_SATTESTMODE	(1)

#define	 MIN_SATTESTMODEI	(0)
//#define	 MAX_SATTESTMODEI	(1)
#define	 MAX_SATTESTMODEI	(3)


#define	 MIN_SATTIMING		(0)
#define	 MAX_SATTIMING		(1)

#define	 MIN_SATSOUND		(0)
#define	 MAX_SATSOUND		(1)

#define	 MIN_SATFACTORY		(0)
#define	 MAX_SATFACTORY		(1)



#define	 MIN_SATPC	(0)
#define	 MAX_SATPC	(1)

#define	 MIN_SATINPUT	(0)
#define	 MAX_SATINPUT	(1)

#define	 MIN_SATLOCK	(0)
#define	 MAX_SATLOCK	(1)

#define	 MIN_SATSEARCH	(0)
#define	 MAX_SATSEARCH	(1)

#define	 MIN_SATXILBLOCK	(0)
#define	 MAX_SATXILBLOCK	(1)



#define TEST_DATA_SIZE (1024)
extern "C" void InvertBitOrdering(void);
extern "C" void CopyBuffers(void);
extern "C" void TestWriteFlash5(void);
extern "C" void TestWriteFlash4(void);
extern "C" void TestWriteFlash3(void);
extern "C" void TestWriteFlash2(void);
extern "C" void TestWriteFlash1(void);
extern "C" void StartLoadAll();
extern "C" void SetTxLevel(unsigned char);
extern "C" void LoadFreqPCha(unsigned long);
extern "C" void LoadFreqPCh(unsigned long);
extern "C" void  SetFreqProc(void);
extern "C" void  SetSysDelay(void);
extern "C" void  SetOutLevel(void); 
extern "C" void  SetAverDistance(void); 
extern "C" void  SetSatRate(void);
extern "C" void  SetSatTimer(void);
#ifdef RECEIVE_MOD_LOCK

extern "C" void  SetSatExtLock(void);
extern "C" void  SetSatExtLockP(void);
#endif
extern "C" void  SetSatLowP(void);

extern "C" void  SetSatALev(void);
extern unsigned char OldAlev;

extern "C" void  SetSatACode(void);
extern "C" void  SetSatADemo(void);
extern "C" void  SetSatACnt(void);




extern "C" void  SetTrFrequency(void); 
extern "C" void  SetRcvFrequency(void); 
extern "C" void  SetTrBound(void); 
extern "C" void  SetRcvBound(void);
extern "C" void  SetSatTestMode(void);
extern "C" void  SetSatPC(void);
extern "C" void  SetSatTiming(void);
extern "C" void  SetSatSound(void);
extern "C" void  SetSatFactory(void);

extern "C" void  SetOffset(void);



//#define YOURNAL
extern "C" void CheckRestoringData(void);
extern "C" void CheckWEBData(void);

extern "C" void UpdateDataVal(void);
	

#define USE_PULT

#define IncEmbIndicator

#define REMOTE_PULT	 //to copy data to buffer
#define USE_USART2		  //use for pult

#ifdef USE_USART2
extern "C" void embRS232S_rcvbuf_Add(unsigned char);
extern "C" void Transmit2c(unsigned char);

#define USART2_TRY_PDC_1T //101004 : need check!!!!
#define USART2_TRY_PDC	  //101004 need check!!!
#endif //USE_USART2

#define PULT_USART
#define PULT_USART2
	  
extern "C" void SetTxLevel(unsigned char level);
extern "C" void LoadFilter(unsigned char cs, unsigned char data);

extern "C" void LoadDDSs(void);

extern "C" void SendToDDS(unsigned long, unsigned long);
extern "C" void SendToDDS3(unsigned long, unsigned long);

#define LEN_DATA_DDS (3)
#define FULL_TEST_TRANZIT

#define DPD_ADDRESS (0xC0400000)   //temporary
#define DPD_SIZE 	(40000)

#define cs_last_addr          0x30000000
//#define INTERRUPT_WAIT (2000000)//now so	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
//#define INTERRUPT_WAIT (200000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
//120504#define XIL_LOAD_FREQ         2000000
#define XIL_LOAD_FREQ         1000000  //120504

#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
//#define IncEmbSerialACT155
#define IncEmbSerialPU_M
#define XilSizeToDownloadD    (4195000)   // t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG  				(1)
#define UPD_BUFFER_SIZE 128
extern "C" void Init_PU_M(void);
extern "C" void PU_M(void);
#endif //PROG_PU_MSAT






#ifdef 	PROG_PU_M_MUX

#define OP_TRUNKS
#define  ALARM_LEVEL_UD (4)
#define POWER_ALARM		(85 << 1)
//t#define MAX_CUR_ERR	(4)
//ok#define MAX_CUR_ERR	(200)
#define MAX_CUR_ERR	(100)
extern unsigned char modforss;
#define DELAY_TIME_TO_WRITE	(1000)
#define PERIOD_UP_DOWN	(30)




#define HAVE_GATEWAY

extern "C" void SetNetworkRem(unsigned long NewNetwork);
extern "C"unsigned long GetNetworkRem(void);

extern "C" void SetNetMaskRem(unsigned long NewNetMask);

extern "C"unsigned long GetNetMaskRem(void);





//_________________________________________________pu_m_V
#define PUMV485_REQUEST_DELAY (250)
//#define	 PROG_PU_M_MUX
#define RRL_ADDR1 (1) //(0)
#define RRL_ADDR2 (2) //(0)
#define DEVCONFIG_QUANTITY (16)
#define DEV_INFO_SIZE (32)
#define BAD_POINTER (0xff)
#define MAX_NOT_ANSWERS_Q (10)
extern unsigned char cur_req_quantity;

extern "C" unsigned char GetDevQuantity(void);
extern "C" unsigned char GetDevAddr(unsigned char);
extern "C" unsigned char GetDevPointer(unsigned char);
extern "C" unsigned char Getudevconfig(unsigned char);
extern "C" void Setudevconfig(unsigned char,unsigned char);
extern "C" unsigned char GetDevType(unsigned char);
extern "C" void SetTestConfig(void);
extern "C" void SetNeedWriteDevId();

//_______________________________________


//101004 #define USE_RS125  //101004 need check!!!!

#define DEV_ETH_CAN_RESTART
#define ETH_CAN_RESTART

#define XIL2_BASE      				(pointer)(0x40000000) /* cs3 */
#define XIL2_SIZE      				(0x02000000) /*addresses  32Mb x 8 */

#define DPD_ADDRESS (0xC0400000)   //temporary
#define DPD_SIZE 	(40000)

#define cs_last_addr          0x50000000
//#define INTERRUPT_WAIT (2000000)//now so	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
//#define INTERRUPT_WAIT (200000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
#define XIL_LOAD_FREQ         2000000
//#define XIL_LOAD_FREQ         18000000	//t
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
#define IncEmbSerialACT155
#define IncEmbSerialPU_M
//130801 #define XilSizeToDownloadD    (350000)   // 101001t  have BIT files for all xilinxes
#define XilSizeToDownloadD    (650000)   //130801 101001t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG  				(1)
#define UPD_BUFFER_SIZE 128
extern "C" void Init_PU_M(void);
extern "C" void PU_M(void);
#endif //




#ifdef 	PROG_BUKU
#define cs_last_addr          0x30000000
//#define INTERRUPT_WAIT (2000000)//now so	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
//#define INTERRUPT_WAIT (200000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
#define XIL_LOAD_FREQ         2000000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
#define IncEmbSerialACT155
#define IncEmbSerialPU_M
#define XilSizeToDownloadD    (72000)   // t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG  				(1)
//#define COM_BUFFER_SIZE 1024
#define UPD_BUFFER_SIZE 128
extern "C" void Init_BUKC(void);
extern "C" void BUKC(void);
#endif //PROG_BUKU

#ifdef 	PROG_PUM   //buk not PROG_PU_M !!!!!!!

#define DELAY_TIME_TO_WRITE	(1000)

#define cs_last_addr          0x30000000

//#define INTERRUPT_WAIT (2000000)//now so	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
//#define INTERRUPT_WAIT (200000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?

#define XIL_LOAD_FREQ         2000000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
#define IncEmbSerialACT155
#define IncEmbSerialPU_M
#define XilSizeToDownloadD    (72000)   // t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG  				(1)
//#define COM_BUFFER_SIZE 1024
//#define ACT_BUFFER_SIZE 1024//512
#define UPD_BUFFER_SIZE 128

extern "C" void Init_BUKC(void);
extern "C" void BUKC(void);
#endif //PROG_PUM






#ifdef 	PROG_BMD155

#define CASHE_OFF //

#ifndef PROG_ACT155N
#define RS485_NOT_DISABLE_ETHERNET
#define RS232_NOT_DISABLE_ETHERNET	  //100302
#endif //PROG_ACT155N


#define ETH_TRANZIT //100111

#define cs_last_addr          0x30000000

//#define INTERRUPT_WAIT (2000000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?

//#define XIL_LOAD_FREQ       	500000
//blink somtime led #define XIL_LOAD_FREQ       	200000
//t #define XIL_LOAD_FREQ       	2000000
#define XIL_LOAD_FREQ       	3000000
//#define XIL_LOAD_FREQ       	1000000		 //t
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
//#define IncEmbNMI
//#define IncEmbIndicator
#define IncEmbSerialMD34AVT
//#define XilSizeToDownloadD    (48)   // to can Spartan3 500
//#define XilSizeToDownloadD    (200000)   // to can Spartan3 500
//t #define XilSizeToDownloadD    (175000)   // to can Spartan3 2500
//#define XilSizeToDownloadD    (169217)   // t   to can Spartan3 2500
#define XilSizeToDownloadD    (740000)   // t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG					(1)
//#define XILINXPG				(3) //t
//extern "C" void Init_BMD155(void);
extern "C" void BMD155(void);	 
#endif //PROG_BMD155

#ifdef 	PROG_COMMUTATOR

//120619#define RS485E_ENABLED
#define HAVE_GATEWAY

#define PUMV485_REQUEST_DELAY (250)
//#define	 PROG_PU_M_MUX
#define RRL_ADDR1 (1) //(0)
#define RRL_ADDR2 (2) //(0)
#define DEVCONFIG_QUANTITY (16)
#define DEV_INFO_SIZE (32)
#define BAD_POINTER (0xff)
#define MAX_NOT_ANSWERS_Q (10)
extern unsigned char cur_req_quantity;

extern "C" unsigned char GetDevQuantity(void);
extern "C" unsigned char GetDevAddr(unsigned char);
extern "C" unsigned char GetDevPointer(unsigned char);
extern "C" unsigned char Getudevconfig(unsigned char);
extern "C" void Setudevconfig(unsigned char,unsigned char);
extern "C" unsigned char GetDevType(unsigned char);
extern "C" void SetTestConfig(void);
extern "C" void SetNeedWriteDevId();

//_______________________________________


//101004 #define USE_RS125  //101004 need check!!!!

//130917 #define DEV_ETH_CAN_RESTART
//130917 #define ETH_CAN_RESTART

#define XIL2_BASE      				(pointer)(0x40000000) /* cs3 */
#define XIL2_SIZE      				(0x02000000) /*addresses  32Mb x 8 */

#define DPD_ADDRESS (0xC0400000)   //temporary
#define DPD_SIZE 	(40000)

#define cs_last_addr          0x50000000
//#define INTERRUPT_WAIT (2000000)//now so	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
//#define INTERRUPT_WAIT (200000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?
#define XIL_LOAD_FREQ         2000000
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
#define IncEmbSerialACT155
#define IncEmbSerialPU_M
#define XilSizeToDownloadD    (350000)   // 101001t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG  				(1)
#define UPD_BUFFER_SIZE 128
extern "C" void Init_PU_M(void);
extern "C" void PU_M(void);

extern "C" void COMMUTATOR(void);	 
extern "C" void Init_COMMUTATOR(void);
#endif //PROG_BMD155

#ifdef 	PROG_BMDN4
//#define 	PROG_BMDN4
extern "C" void BlinkLed(void);
extern "C" void SetTrunk(unsigned char trunk, unsigned char st);
extern "C" unsigned long GetModForSS();
extern "C" void SetModForSS(unsigned long);

extern "C" unsigned long GetModForSS1();
extern "C" void SetModForSS1(unsigned long);

#define STATUSSYNT_PORT	(0xf)
#define TYPE_PORT (1)

extern "C" void SetCurrentTrunk(unsigned char);
#define RATE_100M			(100000000l)
#define POWER_TRESHOLD		(100000)	 //temporary
#define POWER_ALARM		(85 << 1)
extern unsigned char currenttrunk;
extern unsigned char cur_err;
#define MAX_CUR_ERR	(4)

#define ETH_PORT	(0xC)
#define GETH_BIT	(2)
#define FAR_LED_PORT (0x1E)
/*
0 -prov0
1-prov1
2-710-0
3-710-1
4-ud0
5-ud1
6-synt
7- 1stw/2stw
*/
#define	PROV0_MASK  (1)
#define	PROV1_MASK  (2)
#define	P710_0_MASK (4)
#define	P710_1_MASK (8)
#define	UD0_MASK 	(0x10)
#define	UD1_MASK 	(0x20)
#define	SYNT_MASK 	(0x40)
#define	ROOT_MASK 	(0x80)

#define FAR1_GREEN  (1)//(4)//(1)
#define FAR1_RED    (2)//(8)//(2)
#define FAR2_GREEN  (4)//(1)//(4)
#define FAR2_RED   	(8)//(2)//(8)




void SetGEth(unsigned char , unsigned long );

//121117 #define PERIOD_UP_DOWN	(45)
//#define PERIOD_UP_DOWN	(20)
#define PERIOD_UP_DOWN	(30)
//#define PERIOD_UP_DOWN	(2000) //t


extern "C" void SetLoop710(unsigned char dev, unsigned char bbloop, unsigned char ifloop);
extern "C" void InitOperProg();
extern "C" unsigned char GetMidBand(unsigned char dev);
extern "C" unsigned char GetMidBand1(unsigned char dev);

extern unsigned char flagloop0, flagloop1, flagunmod0, flagunmod1; 
extern unsigned char flagbbloop0, flagbbloop1;
extern unsigned char flagifloop0, flagifloop1, flagModForSS;
extern unsigned long timer_oper_prog;

#define TIMER_OPER_PROG (1000)
extern signed long GetTemp();

extern "C" void ParseOperProg();
extern "C" unsigned char* GetOperProg();

extern "C" unsigned long GetLock0();
extern "C" unsigned long GetLock1();


extern "C" unsigned long GetNoise0();
extern "C" unsigned long GetNoise1();
extern "C" unsigned char WriteSpiTemp(unsigned char dev, unsigned long length_of_data, unsigned char * BufferData);
extern "C" void LoadReg(unsigned char dev, unsigned char reg, unsigned char val);
extern "C" unsigned char * ReadSpiTemp();
extern "C" signed short  GetinternalAgc(unsigned);
extern "C" unsigned short  GetexternalAgcRegister(unsigned);




#define ALARM_LEVEL_UD (4)

extern "C" void PVG710_Init(unsigned char);

#define SPEC_REG_ADDR (0x5c3f)
#define SPEC_REG_VAL   (0x2)

extern "C" void embMsgSSC2N_Init();

#define TEST_TIME_CONFIG
extern "C" void SetThreshold(unsigned char, unsigned long);  //
extern unsigned long timer_config;
#define MAXIMUM_COD (30)
#define PORT_FILTER (0x16)

//#define RS485E_ENABLED

extern "C" void EnablePhone(void);

#define SERV_CH (0x0d)
#define EN_SERV (1)

#define MOD_STATUS_CH_ADDR (0x4)
#define MOD_LED_ADDR1 (0x8)
#define MOD_LED_ADDR2 (0x13)  //need add sweep
#define MOD_LED_ADDR3 (0x34)
#define  MASK_STATUS   (0xfc)
 


extern unsigned char oldflag;
extern unsigned char oldflag_710; //need init
extern unsigned char oldflag_ud1; //need init
extern unsigned char oldflag_ud2; //need init
extern unsigned char oldflag_prv;
extern unsigned char oldflag_prv1;
extern unsigned char dev_status;

extern "C" void LedOff();
extern "C" void LedOn();

extern "C" void WritePort();
extern "C" void ReadPort();
extern "C" void	BusTest();
extern "C" void	BusTestFar();
extern "C" void	ReleTest();

#define TX_FAULT_S	(0x10)
#define E1_LINES_QUANTITY (21)
#define FAR_LOOP (0x4)
#define OLD_FAR_LOOP (0x8)
#define NEAR_LOOP (0x2)
#define OLD_NEAR_LOOP (0x4)
#define OPTIC_MASK	(0x1)




extern "C" unsigned char GetStmPhyReg(unsigned char);
extern "C" unsigned char GetEthReg(unsigned char);
extern "C" unsigned char GetServReg(unsigned char);
extern "C" unsigned char GetRele(void);
extern "C" unsigned char GetInputs(void);


extern "C" void SetOptics(unsigned char, unsigned char);


#define CHANNEL1_LOCK_BIT (0x2)
#define CHANNEL2_LOCK_BIT (0x8)

extern "C" void InitSetConfigFile(unsigned long);
extern "C" void InitSetACMMask(unsigned short);
extern "C" void SetACMMask(unsigned char , unsigned char);
extern unsigned short acmmask0;

//extern unsigned char ScanTxtFilesNum[MAX_CFG_FILE_VARIANT];
extern "C" void printcurtxt();

extern unsigned long SavedTxtFilesVal;


extern "C" void ScanTxtFiles(void);
#define GET_CONFIG_INFO
#define MAX_SIZE_TEXT_FILE (2000)
extern "C" void GetTxtFile(unsigned long);

//#define START_PRINT
#define	   TABLE_QUANTITY (2)

extern void ProtectionOn(unsigned char);
unsigned char ProtectionOff(unsigned char);
void ChProt(unsigned char , unsigned char );


extern unsigned char ldeviceindex;
extern unsigned char ldeviceindex1;
extern unsigned char ldeviceindex2;
extern unsigned char ldeviceindex3;
extern unsigned char ldeviceindex4;
extern unsigned char ldeviceindex5;
extern unsigned char ldeviceindex6;
extern unsigned char ldeviceindex7;
extern unsigned char ldeviceindex8;


extern unsigned char lprot;
extern unsigned char lacmprofile;
extern unsigned char lislocal;


extern unsigned char lrx;
extern unsigned char ltx;

extern unsigned short lprofile2;


extern unsigned char lengineTable;
extern unsigned char lprofile;
extern unsigned short lmseTenthsVal;
extern unsigned char lldpcMantissaTenths;
extern unsigned char lldpcExponent;
extern unsigned char lcriteria;
extern unsigned char lnextProfile;


#define CONFIG_FILE_40  //110609 will maked later
//#define EMPTY_LOOP //test!!!

//120202 #define DO_NOT_LOAD_PROVINGENTS_PROTECTION

extern "C" void ModemAcmProfileMaskGet(unsigned char);
extern "C" unsigned long GetProvData(unsigned long);
extern "C" void DevAcmConfigurationGet(unsigned char);
extern "C" void ModemAcmCountersGet(unsigned char);
extern "C" void ModemAcmEngineEnable(unsigned char, unsigned char, unsigned char);
extern "C" void ModemAcmProfileEnable(unsigned char , unsigned short);
extern "C" void ModemAcmSwitch(unsigned char, unsigned char, unsigned char);
extern "C" void ModemAcmThresholdSet(unsigned char, unsigned char, unsigned char, unsigned short, unsigned char,  unsigned char,  unsigned char, unsigned char);
//#define XILINX_SIZE      			(0x02000000) /*addresses  32Mb x 8 */

#define STEP_TO_PROV      			(0x02000000) /*addresses  32Mb x 8 */
#define PROV_STATE_SIZE      		(0x00000100) 


#define PROG_BMDN2

extern "C" void test_PU37_transit();

#endif

/*
#ifdef PROG_ODU4

#define WITHOUT_XILINX //
#define WITHOUT_INTERRUPTS //

#define PROG_ODU1
#endif
  */

#ifdef PROG_ODU1

  #define IGNORE_AA_IN_5


//not need now #define USE_SOCKETSD_485	

#define USE_SOCKETSD   //need for have ipaddrudp - used as macaddr of remote modem	

#define DEBUG_ETH_TRANZIT
#define DEBUG_TRANZIT
#define START_PRINT
#define PRINT_START
#define TEST_PROT
#define ETH_DEBUG_ENABLED	// debug from ethernet enabled



#define ARSTOUT_BIT	(0x02)
#define RESET_PORT  (0x25)

extern "C" void MakeMEthMode(unsigned long mod);


#define TEN_MHZ_ADDRESS				(0xD)
#define TEN_MHZ_RATE_ADDRESS		(0x10)
#define INPUT_MODE					(1)
#define INPUT_CODE					(0xF)




extern "C" void SetTenMHz();


extern unsigned char ten_mhz;
extern unsigned char far_ten_mhz_status;	

extern unsigned char  far_ten_mhz_status_keep;
extern unsigned char  ten_mhz_keep;
extern unsigned long  symbrate_keep;

#define TEN_MHZ_MASK	(0x03)


 extern "C" void ClearNeedWriteDevId(void);


extern unsigned char flagstartparseop;


#define ODU_XIL_SIZE (235838)


extern "C" void LoadBaudO(unsigned long rate, unsigned char chnl);


#define MODES_NUM  (16)

#define ETH_TRANZIT	   //160630

#ifdef 	ETH_TRANZIT
extern "C" void ProtocolFromEthTransit(void);
extern "C" void ProtocolToEth(void);

#endif


 #define ONE_TRUNK

#define RRL_ADDR1 (1) //(0)
#define RRL_ADDR2 (2) //(0)


#define WITHOUT_TRANZIT

#define LOAD_ONE_PROVINGENT_ON_PLATA
 

/*
//extern UINT32 calTableFlashStartOffset;
extern "C" void PVG810_PROTOCOL_MSG_HostMsgTaskInit(unsigned int);

#define  CALTABLE_FLASH_ADDR		 0xC0700000

//#define  CALTABLE_LEN           //???? //#define  CALTABLE_RAM_ADDR		//????
extern "C" void CalTableFlashRead(unsigned char systemIndex, unsigned offset, unsigned len, unsigned char *pBuffer);


extern "C" void init_pvg810_structs(void);
extern "C" void init_pvg810_structs_appl(void);

//#define   PVG810_ERROR_MSG_ENUM (unsigned char)

extern "C" unsigned char APP_BBMode15GHzSet(void);
*/

#define 	PROG_MD310_SATI2

#endif




#ifdef PROG_ODU

#define LOAD_ONE_PROVINGENT_ON_PLATA
//extern UINT32 calTableFlashStartOffset;
extern "C" void PVG810_PROTOCOL_MSG_HostMsgTaskInit(unsigned int);

#define  CALTABLE_FLASH_ADDR		 0xC0700000

//#define  CALTABLE_LEN           //???? //#define  CALTABLE_RAM_ADDR		//????
extern "C" void CalTableFlashRead(unsigned char systemIndex, unsigned offset, unsigned len, unsigned char *pBuffer);


extern "C" void init_pvg810_structs(void);
extern "C" void init_pvg810_structs_appl(void);

//#define   PVG810_ERROR_MSG_ENUM (unsigned char)

extern "C" unsigned char APP_BBMode15GHzSet(void);


#define 	PROG_MD310_SATI2

#endif

#ifdef	PROG_DMU6
 extern "C" void LoadDDS_Symb_Start(void);
 extern "C" void LoadDDSs_Start(void);


extern unsigned char flagstartparseop;

#define MODES_NUM  (16)

extern "C" signed long GetTempDmu();


#define SDMU	(0)
#define SDMP	(1)
#define STGE	(2)



#define DDS_IF   (8)
#define DDS_SYMB (9)
#define CH_FILTR (0xb)

extern "C" unsigned char WriteSpiDmu(unsigned char dev, unsigned long length_of_data, unsigned char * BufferData);
extern "C" void LoadFilters(unsigned char baud);
extern "C" void LoadDDSs_Start(void);




#define CHANNEL_DDSIF		(8)
#define CHANNEL_DDSSYMB		  (9)
#define CHANNEL_TEMPERATURE	  (10)
#define CHANNEL_FILTR		   (11)


//#define XilSizeToDownloadD_DMU6	 39000 //(3900000)
#define XilSizeToDownloadD_DMU6	 (3800000)
extern "C" void TestWriteFlash5(void);
#define TEST_HANGING

#define FINISH_ADDR_CFG_FILE		        (0xC0620000) //may be so now


#define LOAD_ONE_PROVINGENT_ON_PLATA
#define 	PROG_MD310_SATI2
#define	PROG_PRM_PCH_DEM_XIL_CHN_DMU5

#endif


#ifdef 	PROG_MD310_SATI2

extern unsigned lost_mailboxes;

extern "C" void R_ACM(); //operate radian acm

extern unsigned char racm, racm_far, flag_racm_far , flag_racm_fart, racm_old;


#define FEC_BER

#define PACK_CFG


#ifndef PACK_CFG

//#define MAX_NUM_CFG1 (120)
#define MAX_NUM_CFG1 (140)
#else
//#define MAX_NUM_CFG1 (250)
//ok if return #define MAX_NUM_CFG1 (276)
#ifndef PROG_DMU6
#ifndef PROG_ODU1

#define MAX_NUM_CFG1 (280)
#else
#define MAX_NUM_CFG1 (50)
#endif


#else
#define MAX_NUM_CFG1 (255)

#endif

//ok #define MAX_NUM_CFG1 (255)
//ok#define MAX_NUM_CFG1 (256)
//bad#define MAX_NUM_CFG1 (290)
//#define MAX_NUM_CFG1 (285)
//wrong #define MAX_NUM_CFG1 (308)

#endif



extern "C"void SetMOutLevSNMP(long);
extern "C" long GetMOutLev(void);
extern "C" long GetMTFreq();
extern "C" long SetMTFreqSNMP(long);
extern "C" long GetMTMode();
extern "C" long SetMTModeSNMP(long);
extern "C" long GetMCONFIG();
extern "C" long SetMCONFIGSNMP(long);

extern "C" long GetSerial();


extern "C" long GetMRFreq();
extern "C" long SetMRFreqSNMP(long);
extern "C" long GetMRMode();
extern "C" long SetMRModeSNMP(long);
extern "C" long GetDCONFIG();
extern "C" long SetDCONFIGSNMP(long);
extern signed long NMSE;
extern unsigned char LOCK;
extern "C" float GetBERE();
extern "C" float GetBER();
extern "C" long GetNMSE();
extern "C" long GetLOCK();
extern "C" char* GetEthMode(void);
 
extern "C" char* GetTModul();
extern "C" double GetTCode();
extern "C" double GetTSymb();
extern "C" unsigned long GetTSymbu(void);

extern "C" char* GetRModul();
extern "C" char* GetDFE();

extern "C" double GetRCode();
extern "C" double GetRSymb();
extern "C" void	  SetIfLoopSNMP(long );		  //rx freq
extern "C" void	  SetMUnModulSNMP(long);		  //rx freq
extern "C" void	  SetMRfOutSNMP(unsigned char);
extern "C" long GetMACMMSNMP();
extern "C" void SetMACMMSNMP(long);

extern "C" void	  SetPar046(unsigned char val);	

extern unsigned char Ld0, Ld1;

extern "C" void SetParamsFromCfg1(unsigned long);
extern unsigned char acm_status1;
extern "C" void  SetHbandAndPauseOff();
extern "C" void  SetDefaultEthParams();
extern "C" void  SetEthPhyParams();




#define 	PROG_MD310_SATI
#endif



#ifdef 	PROG_MD310_SATI

#define START_ADDR_CFG_FILE		        (0xC0220000)



#define OLD_CONFIG_FILE_VARIANTS_STEP	(50000)
#define OLD_FILE_SIZE	(40000)


extern "C" void check_exp();

extern unsigned char Er, Et;


extern "C" void InitEthStat(void);
extern "C" unsigned char GetMIfLoop();


#ifndef	PROG_MD310_SATI2
#define LOAD_ONE_PROVINGENT_ON_PLATA
#endif


extern unsigned char acm_status1;
extern "C" double GetMEbN0(void);

extern "C" void checklog(void);


extern "C" void  SetSatSound();


#define	 MIN_SATSOUND		(0)
#define	 MAX_SATSOUND		(1)


#define REAL_PROBE   //real probe of flash on if module


extern "C" void KeepParamsInIFModule();

#define IFCONF_ADDRESS   (0x10000100)
extern "C" int ReadDataIFModule(unsigned long addr_dest,  char * pBuf, unsigned long size);
extern "C" char WriteDataIFModule(unsigned long addr_dest, unsigned char * pBuf, unsigned long size);


extern "C" void TestWriteIFModule(void);


extern unsigned char power_modul;


#define POWER_START	  (4000)
#define POWER_K		  (6329)



extern "C" unsigned char WriteReadSpiBm(unsigned char deviceindex, unsigned long length_of_data,
 unsigned char * BufferData, unsigned char * ReadBuffer);


#define    SENDED_DDS_FREQ_LEN	  (11)


extern "C" void InitIFModule();
extern "C" void LoadFiltrT(unsigned long);
extern "C" void LoadFiltrR(unsigned long);
extern "C" void UpdateDataVal();


#define _IFNRST		(1) //inverse operation

#define IFLOOPON  	(4)
#define IFTXON 		(2)

#define  IFBLOK_MASK (0x20)

#define STATUS_610_ADDR		(0x33)
#define CON_IFSAT140_ADDR	(0x35)
#define ADR_IFSAT140	  	(0x36)
#define ADRFWR				(0x37)

#define DACL				(0x3a)
#define DACH				(0x3b)


#define TXIFSYNT  (0xB)
#define RXIFSYNT  (0xD)
#define TXFILTR	  (0xA)
#define RXFILTR	  (0xE)
#define TXPOWLEV  (0xC)
#define TEMPER	  (0x8)
#define MEM		  (0x9)

extern "C" unsigned short GetTempSat();


extern unsigned char CON_IFSAT140;

#define LED_FA		(0xB)
#define BIT_REMOTE  //    
#define BIT_TESTMOD //   
#define BIT_STOR_AL //    

extern "C" unsigned char  GetIFLoop();
extern "C" unsigned char GetUnModul();
extern "C" unsigned char GetMRCntl();


extern unsigned char oldflag_ifloop;
extern unsigned char oldflag_unmodul;
extern unsigned char oldflag_mrcntl;
extern unsigned char oldflag_alarms;



#define WITHOUT_XILINX 	 //temporary

extern "C" void SetParamsTxFromCfg(unsigned char);
extern "C" void SetParamsRxFromCfg(unsigned char);
extern "C" void   SetViewModesFromCfg(unsigned char ,unsigned char );
extern "C" void SetTxMode(unsigned char);





extern "C"   void SetUsart2BaudRate(unsigned long);


//#define DEB_LOG

#ifndef PROG_ODU1

#define TXT_REAL_LEN   (MAX_SIZE_TEXT_FILE - FULL_HEADER_SIZE - 4)
#define TXT_CUR_REAL_LEN   (104)
#define TXT_REAL_LEN_100  (MAX_SIZE_TEXT_FILE - FULL_HEADER_SIZE - 4)

#else
#define TXT_REAL_LEN   (MAX_SIZE_TEXT_FILE - FULL_HEADER_SIZE - 4)
#define TXT_CUR_REAL_LEN   (200)
#define TXT_REAL_LEN_100   (448)  //447

#endif


extern "C" void WriteIFmoduleData();
extern "C" void ReadIFmoduleData();	 //read data
extern "C" void ReadIFmoduleHeader();


extern unsigned char acm_status;
extern double ethsend;
extern double ethreceived;

extern float errf;
extern float dataf;


extern "C" void SetMSweep(signed long);
extern "C" void SetMAGC(signed short);
extern "C" void SetMEbN(signed short);
extern "C" void SetMBER(unsigned long , unsigned long );

extern "C" void SetMEthSend(unsigned long); //, unsigned long);

extern "C" void SetMEthReceived(unsigned long); // , unsigned long);
extern "C" void SetMEthTransmit(unsigned long); // , unsigned long);


extern "C" void SetMEthReceivedCRC(unsigned long);
extern "C" void SetMEthSendU(unsigned long);

extern "C" void SetMEthRcvD(unsigned long lows);




extern float gmse;
extern "C" void ReadErrors3(unsigned char );
extern "C" void ReadErrors2(unsigned char );


extern "C" void ACM_DEFAULT_init();


extern "C" void InitStructs();

extern "C" void FillClassesM();
extern "C" void StartLoadAllM();



extern "C" void SetMIfLoop();
extern "C" void SetMUnModul();
extern "C" void SetLoadVariants();
extern "C" void SetSaveVariants();
extern "C" void SetMRfOut();
extern "C" void SetMRfOutOff();
extern "C" void SetMOutLev();
extern "C" void SetMOutLev1();
extern "C" void SetMOutLev2();
extern "C" void SetMKout();
extern "C" void SetMRateE();
extern "C" void SetMRateED();


extern "C" void SetMKout1();
extern "C" void SetMKin1();
extern "C" void SetMKin2();
extern "C" void SetMKin3();





extern "C" void SetMTFreq();
extern "C" void SetMRFreq();
extern "C" void SetMDemod();
extern "C" void SetMEthMode();
extern "C" void SetMEthModeI(unsigned char);


extern "C" void SetMEthPause();
extern "C" void SetMEthPause1();

extern "C" void SetMEthctl();
extern "C" void SetMEthctl1();

extern "C" void SetMEthMaxF();
extern "C" unsigned short GetMEthMaxF();


extern "C" void SetMEthVlanP();
extern "C" void SetMEthVlanP1();
extern "C" void SetMTEbN0();
extern "C" void SetMTBER();
extern "C" void SetMTBERE();
extern "C" void SetMACMM();

extern "C" void SetMTCode();
extern "C" void SetMTModul();
extern "C" void SetMTDRate();
extern "C" void SetMRCode();
extern "C" void SetMRModul();
extern "C" void SetMRDRate();
extern "C" void SetParamsFromCfg();

extern "C" void SetMTCdType();
extern "C" void SetMRCdType();

extern "C" void SetMTMode();
extern "C" void SetMRMode();

extern "C" void SetMRCntl();










extern "C" void InvertBitOrdering(void);
extern "C"   void m_load_xilinx3t (char  , char );


//#ifndef MAKET_PLATA
//#define ADESTO
//#endif

#define MIN_MRFOUT (0)
#define MAX_MRFOUT (1)



#define MIN_MOUTLEV	  (float64)5//(-30.0)
#define MAX_MOUTLEV	  (float64)30//(-5.0)

#define MIN_MOUTLEV1	  (float64)5//(-30.0)
#define MAX_MOUTLEV1	  (float64)30//(-5.0)

#define MIN_MOUTLEV2	  (float64)0//(-30.0)
#define MAX_MOUTLEV2	  (float64)9//(-5.0)


#define MIN_MOUTLEV2	  (float64)0//(-30.0)
#define MAX_MOUTLEV2	  (float64)9//(-5.0)

#define MIN_MKOUT	  (float64)0//(-30.0)
#define MAX_MKOUT	  (float64)99.9//(-5.0)

#define MIN_MKOUT1	  (float64)1//(-30.0)
#define MAX_MKOUT1	  (float64)999//(-5.0)

#define MIN_MKIN1	  (float64)-999//1//(-30.0)
#define MAX_MKIN1	  (float64)999//999//(-5.0)

//#define MIN_MKIN2	  (float64)1//(-30.0)
#define MIN_MKIN2	  (float64)-999//(-30.0)
#define MAX_MKIN2	  (float64)999//(-5.0)

#define MIN_MKIN3	  (float64)1//(-30.0)
#define MAX_MKIN3	  (float64)9999//(-5.0)

#define MIN_ratimelock (1)
#define MAX_ratimelock (9999)

#define MIN_ratimemode (1)
#define MAX_ratimemode (9999)

#define MIN_ratimemse (1)
#define MAX_ratimemse (9999)

#define MIN_ratimestep (100)
#define MAX_ratimestep (9999)

#define MIN_uebn	  (float64)2.0
#define MAX_uebn	  (float64)45.0

#define MIN_uebn_DEFAULT	  (float64)10.0
#define MAX_uebn_DEFAULT	  (float64)15.0


#define MIN_enamode	 0
#define MAX_enamode	 1

#define MIN_numode	 0
#define MAX_numode	 15

#define MIN_ndmode	 0
#define MAX_ndmode	 15








#define MIN_MRATEE	  (float64)1//(-30.0)
//#define MAX_MRATEE	  (float64)1000000000//(-5.0)
#define MAX_MRATEE	  (float64)1000000//(-5.0)


#define MIN_MOUTLEVO	  (float64)0//(-30.0)
//#define MAX_MOUTLEVO	  (float64)5//(-5.0)
#define MAX_MOUTLEVO	  (float64)9.99//(-5.0)


#define MIN_MOUTLEVOS	  0//(-30.0)
#define MAX_MOUTLEVOS	  1//(-5.0)

//#define UP_140	   //for test

#define MIN_MTDRATE	 (0.0001)
#define MAX_MTDRATE	 (100.0)

#define MIN_MRDRATE	 (0.0001)
#define MAX_MRDRATE	 (100.0)

#define MIN_MTFREQ	 (52.0)

#ifndef UP_140
#define MAX_MTFREQ	 (88.0)
#else
#define MAX_MTFREQ	 (180.0)
#endif

#define MIN_MRFREQ	 (52.0l)

#ifndef UP_140
#define MAX_MRFREQ	 (88.0l)
#else
#define MAX_MRFREQ	 (180.0l)
#endif

#define MIN_MTMODUL	 (0)
#define MAX_MTMODUL	 (6)

#define MIN_MTCDTYPE (0)
#define MAX_MTCDTYPE (1)

#define MIN_MRCDTYPE (0)
#define MAX_MRCDTYPE (1)

#define MIN_MTMODE (0)
#define MAX_MTMODE (15)

#define MIN_QUANTITY (1)
#define MAX_QUANTITY (16)

#define MIN_MRMODE (0)
#define MAX_MRMODE (15)

#define MIN_MRCNTL (0)
#define MAX_MRCNTL (1)


#define MIN_MRMODUL	 (0)
#define MAX_MRMODUL	 (6)

#define MIN_MTCODE	 (0)
#define MAX_MTCODE	 (1)

#define MIN_MRCODE	 (0)
#define MAX_MRCODE	 (1)

#define MIN_MDEMOD	 (0)
#define MAX_MDEMOD	 (1)

#define MIN_METHMODE (0)
#define MAX_METHMODE (5)

#define MIN_METHPAUSE (0)
#define MAX_METHPAUSE (1)

#define MIN_METHCTL  (0)
#define MAX_METHCTL	 (1)

#define MIN_METHMAXF	(1518)
#define MAX_METHMAXF	(9600)

#define MIN_METHVLANP  (0)
#define MAX_METHVLANP  (255)

#define MIN_MIFLOOP  (0)
#define MAX_MIFLOOP	 (1)

#define MIN_METHMODEI  (0)
#define MAX_METHMODEI  (5)

#define MIN_MUNMODUL (0)
#define MAX_MUNMODUL (1)

#define MIN_MACMM (0)
#define MAX_MACMM (2)

#define MIN_MAGC	(-90)
#define MAX_MAGC	(90)

#define MIN_MSWEEP	(-2000000)
#define MAX_MSWEEP	( 2000000)

#define MIN_MTEBN0  (0)	 
#define MAX_MTEBN0	(40)

#define MIN_MTBER	(0)
#define MAX_MTBER	(999)

#define MIN_MTBERE	(0)
#define MAX_MTBERE	(99)

#define MIN_MBERE	(0)
#define MAX_MBERE	(99)


#define MIN_LOADVARIANTS	(0)
//#define MAX_LOADVARIANTS	(4)
#define MAX_LOADVARIANTS	(10)

#define MIN_SAVEVARIANTS	(0)
//#define MAX_SAVEVARIANTS	(3)
#define MAX_SAVEVARIANTS	(9)


#define MIN_RACM (0)
#define MAX_RACM (1)

#define MIN_RACMOffset (-9.9)
#define MAX_RACMOffset (9.9)









extern "C" void CheckParameters(void);
extern "C" void CheckParametersTx(void);
extern "C" void CheckParametersRx(void);




extern "C" void FillFirmwareFileData(void);


extern "C" void ReadRAnyConfigs(void);

//150818 #define MAX_NUM_CFG1 (100)
//#define MAX_NUM_CFG1 (120)

//extern unsigned char ReallyNumCfg[MAX_NUM_CFG1];
extern unsigned long ReallyNumCfg[MAX_NUM_CFG1];


#define PRINT_FIND_NAMES

#define NAMES_LEN  (15)

//150818#define PARAMS_LEN  (8)
#define PARAMS_LEN  (9)	  //150818


extern "C" void FillMenu();
extern "C" void SetItemConfig();


extern  unsigned long password_state;
extern  unsigned char key_enter_flag;


#define USE_HTTP
#ifdef USE_HTTP
#define EVENTS_IN_LIST	(2)
extern unsigned long page_number;
extern unsigned long start_event;
#endif

#define HAVE_GATEWAY

//__________________________________________________

#define ETH_DEBUG_ENABLED	//to print if programm pult

#define PROGRAMM_PULT


//______________________________________
#define USE_PULT

#define IncEmbIndicator

#define REMOTE_PULT	 //to copy data to buffer
#define USE_USART2		  //use for pult

#ifdef USE_USART2
extern "C" void embRS232S_rcvbuf_Add(unsigned char);
extern "C" void Transmit2c(unsigned char);

#define USART2_TRY_PDC_1T //101004 : need check!!!!
#define USART2_TRY_PDC	  //101004 need check!!!
#endif //USE_USART2

#define PULT_USART
#define PULT_USART2

//________________________________________________
#define		PROG_MD310_SAT
#define     PROG_BMDN6MI
extern "C" unsigned char CheckWEBData();
extern unsigned long start_event;


#endif



#ifdef 	PROG_MD310_SAT
#define LOAD_ACM_DELAY	(4000)
extern "C" void OperateACM(void);


//#define LOAD_ONE_PROVINGENT_ON_PLATA

//#define PROG_MD310
#define PROG_BMDN6

//#define PRINT_ETH


#define SEND_MOD_LOCK

#ifndef PROG_ODU1
#define WITHOUT_INTERRUPTS 
#endif

#define LOCK_CHAR	 (0x71)
#define UNLOCK_CHAR	 (0x44)

#endif


//#ifdef 	PROG_BMDN6MI
//#define  PROG_BMDN6M
//#endif




#ifdef 	PROG_BMDN6M

#define HAVE_GATEWAY

#define PROG_BMDN6
extern "C" void ConfigFileDestroy(unsigned long);



#endif


#ifdef 	PROG_MD310

#define TWO_TRUNKS
//#define SEND_MOD_LOCK

extern "C" void ConfigFileDestroy(unsigned long);

/*
#define USE_CALIBR

#ifdef 	USE_CALIBR
#define NUM_CALIBR_FILE		(20)
extern "C" void KeepCalibrData();
extern "C" void PrintCalibrData();
extern "C" void SetCalibrData();
#endif
*/
//extern "C" void StartEthTimed(unsigned char flagm);


//#define IRQ_LIMITED
/*
#define O_POWER

extern signed long farinplev1;
extern signed long farinplev2;

extern unsigned char pdpower1;
extern unsigned char pdpower2;
extern unsigned char power_modul;
extern unsigned long power_rate;
extern unsigned char flag_enable_operate_power1;
extern unsigned char flag_enable_operate_power2;
extern unsigned char flag_command_power; 
 */


#define HAVE_GATEWAY

#define PROG_BMDN6


   /*
  extern "C" void StartEth(unsigned char);
  extern unsigned long  ratesymbol_far;
extern "C" void SetBand(unsigned char im, unsigned long rate);
	*/
//#define START_PRINT
//#define YOURNAL

#endif

//________________________________________________________________bmdn6
#ifdef 	PROG_BMDN6
  #define NUM_CALIBR_FILE		(20)

//130221 #define USE_CALIBR

  extern "C" void StartEth(unsigned char);
  extern unsigned long  ratesymbol_far;
extern "C" void SetBand(unsigned char im, unsigned long rate);



#ifdef 	USE_CALIBR
#define NUM_CALIBR_FILE		(20)
extern "C" void KeepCalibrData();
extern "C" void PrintCalibrData();
extern "C" void SetCalibrData();
#endif

extern "C" void StartEthTimed(unsigned char flagm);

#ifndef PROG_BMDN6MI
#define O_POWER
#endif

extern unsigned char flag_command_power; 
extern signed long farinplev1;
extern signed long farinplev2;
extern unsigned char pdpower1;
extern unsigned char pdpower2;
extern unsigned char power_modul;
extern unsigned long power_rate;
extern unsigned char flag_enable_operate_power1;
extern unsigned char flag_enable_operate_power2;
extern unsigned char flag_command_power; 




extern unsigned long ver_api;
extern unsigned char  hot_restart;


//#define CHANNELLS_TIME_STEP	(100)
//#define CHANNELLS_TIME_STEP	(30)
//#define CHANNELLS_TIME_STEP	(15)
//#define CHANNELLS_TIME_STEP	(5)
//#define CHANNELLS_TIME_STEP	(15)
#define CHANNELLS_TIME_STEP	(30)
extern unsigned char used_TCP;

extern "C" void  DisableOperatePower(unsigned char);
extern "C" void  EnableOperatePower(unsigned char);


#define DELAY_READ	(2000l)

#define DO_NOT_READ_CONFIG_DELTA

#ifndef 	PROG_MD310
//#ifndef 	PROG_ODU1
#define YOURNAL
//#endif
#endif

extern "C" unsigned char CheckEthMode(unsigned char);

#define OPERATE_ETH
#define STATUS_ETH_PORT (0x1D)


#define ETH_AUTO 1
#define ETH_10	 2
#define ETH_100	 4
#define ETH_1000 8
#define ETH_DUPL 0x10
#define ETH_OPT 0x20


#define STATE_SCAN_PERIOD (5000)
//#define STATE_SCAN_PERIOD (500)

#define SEND_STATUS_PERIOD (300)

//#define SEND_STATUS_PERIOD (4000)

 extern "C" void StartEth10p();
extern "C" void StartEth100p();
extern "C" void StartEth10d();
extern "C" void StartEth100d();



void EthStatusGet();
void EthStatusSet();
void EthStatusSet1(unsigned char dev, unsigned char auton, unsigned char speed,
				  unsigned char duplex, unsigned char loop,
				  unsigned char interf,  unsigned char phyId,
				  unsigned char reset,  unsigned char changephy );

void EthStatusGetXil();

//160711 #ifndef PROG_ODU1

#define SEND_STATUS

//160711 #endif


#define	 DEFAULT_ADDR	(0xBEEF)
#define	SIGNATURA	(0x3e)
//#define	RROT_VER	(2)
#define	RROT_VER	(3)	//timestep_far
unsigned short Get_ratimestep(void);
extern unsigned long  timestep_far;




#define	 MEbN0_UP_DEFAULT   (13.0)
#define	 MEbN0_DOWN_DEFAULT (10.0)
extern "C" void ACM_MODE_PULL_init(void);




void SendStatus();
//void ReceiveStatus();
unsigned long ReceiveStatus();
extern unsigned long timelock;
extern unsigned long timechangemode;
extern unsigned long timekeepMSE;
extern unsigned char previons_mode;

#ifndef PROG_ODU1
#ifndef PROG_DMU6
#define RACM
#endif
#endif




#define  FLAG_CUR_STATE (0x40)
#define XIL_FLASH //120622

//#define LOAD_ONE_PROVINGENT_ON_PLATA  //for specific use only  no kazah

#define CHECK_CRC   //to check data in modem channel//do not work radview!!!!!

extern "C" void PrintConfigs(void);
extern "C" void FillAllConfigFileVersion(void);
extern "C" void EraseAllConfigFiles(void);

#define 	PROG_BMDN5
#endif
//________________________________________________________________bmdn5
#ifdef 	PROG_BMDN5

//t#define LOAD_ONE_PROVINGENT_ON_PLATA


extern "C" void BlinkLed(void);
extern "C" void SetTrunk(unsigned char trunk, unsigned char st);
extern "C" unsigned long GetModForSS();
extern "C" void SetModForSS(unsigned long);

extern "C" unsigned long GetModForSS1();
extern "C" void SetModForSS1(unsigned long);

extern "C" unsigned long GetModEth();
extern "C" void SetModEth(unsigned long);



#define STATUSSYNT_PORT	(0xf)

extern "C" void SetCurrentTrunk(unsigned char);
#define RATE_100M			(100000000l)
#define POWER_TRESHOLD		(100000)	 //temporary
extern unsigned char currenttrunk;
extern unsigned char cur_err;
#define MAX_CUR_ERR	(4)

#define ETH_PORT	(0xC)
#define GETH_BIT	(2)
void SetGEth(unsigned char , unsigned long );

//121117#define PERIOD_UP_DOWN	(45)
//#define PERIOD_UP_DOWN	(20)
#define PERIOD_UP_DOWN	(30)
//#define PERIOD_UP_DOWN	(2000) //t


extern "C" void SetLoop710(unsigned char dev, unsigned char bbloop, unsigned char ifloop);
extern "C" void InitOperProg();
extern "C" unsigned char GetMidBand(unsigned char dev);
extern "C" unsigned char GetMidBand1(unsigned char dev);

extern unsigned char flagloop0, flagloop1, flagunmod0, flagunmod1; 
extern unsigned char flagbbloop0, flagbbloop1;
extern unsigned char flagifloop0, flagifloop1, flagModForSS;
extern unsigned long timer_oper_prog;

#define TIMER_OPER_PROG (1000)
extern signed long GetTemp();

extern "C" void ParseOperProg();
extern "C" unsigned char* GetOperProg();

extern "C" unsigned long GetLock0();
extern "C" unsigned long GetLock1();


extern "C" unsigned long GetNoise0();
extern "C" unsigned long GetNoise1();
extern "C" unsigned char WriteSpiTemp(unsigned char dev, unsigned long length_of_data, unsigned char * BufferData);
extern "C" void LoadReg(unsigned char dev, unsigned char reg, unsigned char val);
extern "C" unsigned char * ReadSpiTemp();
extern "C" signed short  GetinternalAgc(unsigned);
extern "C" unsigned short  GetexternalAgcRegister(unsigned);




#define ALARM_LEVEL_UD (4)

extern "C" void PVG710_Init(unsigned char);

#define SPEC_REG_ADDR (0x5c3f)
#define SPEC_REG_VAL   (0x2)

extern "C" void embMsgSSC2N_Init();

#define TEST_TIME_CONFIG
extern "C" void SetThreshold(unsigned char, unsigned long);  //
extern unsigned long timer_config;
#define MAXIMUM_COD (30)
#define PORT_FILTER (0x16)

//#define RS485E_ENABLED

extern "C" void EnablePhone(void);

#define SERV_CH (0x0d)
#define EN_SERV (1)

#define MOD_STATUS_CH_ADDR (0x4)
#define MOD_LED_ADDR1 (0x8)
#define MOD_LED_ADDR2 (0x13)  //need add sweep
#define  MASK_STATUS   (0xfc)

 


extern unsigned char oldflag;
extern unsigned char oldflag_710; //need init
extern unsigned char oldflag_ud1; //need init
extern unsigned char oldflag_ud2; //need init
extern unsigned char oldflag_prv;
extern unsigned char oldflag_prv1;
extern unsigned char dev_status;

extern "C" void LedOff();
extern "C" void LedOn();

extern "C" void WritePort();
extern "C" void ReadPort();
extern "C" void	BusTest();
extern "C" void	BusTestFar();
extern "C" void	ReleTest();

#define TX_FAULT_S	(0x10)
#define E1_LINES_QUANTITY (21)
#define FAR_LOOP (0x4)
#define OLD_FAR_LOOP (0x8)
#define NEAR_LOOP (0x2)
#define OLD_NEAR_LOOP (0x4)
#define OPTIC_MASK	(0x1)




extern "C" unsigned char GetStmPhyReg(unsigned char);
extern "C" unsigned char GetEthReg(unsigned char);
extern "C" unsigned char GetServReg(unsigned char);
extern "C" unsigned char GetRele(void);
extern "C" unsigned char GetInputs(void);


extern "C" void SetOptics(unsigned char, unsigned char);


#define CHANNEL1_LOCK_BIT (0x2)
#define CHANNEL2_LOCK_BIT (0x8)

//extern "C" void InitSetConfigFile(unsigned char);
extern "C" void InitSetConfigFile(unsigned long);

extern "C" void InitSetACMMask(unsigned short);
extern "C" void SetACMMask(unsigned char , unsigned char);
extern unsigned short acmmask0;

//extern unsigned char ScanTxtFilesNum[MAX_CFG_FILE_VARIANT];
extern "C" void printcurtxt();

extern unsigned long SavedTxtFilesVal;


extern "C" void ScanTxtFiles(void);
#define GET_CONFIG_INFO
#define MAX_SIZE_TEXT_FILE (2000)
extern "C" void GetTxtFile(unsigned long);

//#define START_PRINT
#define	   TABLE_QUANTITY (2)

extern void ProtectionOn(unsigned char);
unsigned char ProtectionOff(unsigned char);
void ChProt(unsigned char , unsigned char );


extern unsigned char ldeviceindex;
extern unsigned char ldeviceindex1;
extern unsigned char ldeviceindex2;
extern unsigned char ldeviceindex3;
extern unsigned char ldeviceindex4;
extern unsigned char ldeviceindex5;
extern unsigned char ldeviceindex6;
extern unsigned char ldeviceindex7;
extern unsigned char ldeviceindex8;


extern unsigned char lprot;
extern unsigned char lacmprofile;
extern unsigned char lislocal;


extern unsigned char lrx;
extern unsigned char ltx;

extern unsigned short lprofile2;


extern unsigned char lengineTable;
extern unsigned char lprofile;
extern unsigned short lmseTenthsVal;
extern unsigned char lldpcMantissaTenths;
extern unsigned char lldpcExponent;
extern unsigned char lcriteria;
extern unsigned char lnextProfile;


#define CONFIG_FILE_40  //110609 will maked later
//#define EMPTY_LOOP //test!!!

//120202 #define DO_NOT_LOAD_PROVINGENTS_PROTECTION

extern "C" void ModemAcmProfileMaskGet(unsigned char);
extern "C" unsigned long GetProvData(unsigned long);
extern "C" void DevAcmConfigurationGet(unsigned char);
extern "C" void ModemAcmCountersGet(unsigned char);
extern "C" void ModemAcmEngineEnable(unsigned char, unsigned char, unsigned char);
extern "C" void ModemAcmProfileEnable(unsigned char , unsigned short);
extern "C" void ModemAcmSwitch(unsigned char, unsigned char, unsigned char);
extern "C" void ModemAcmThresholdSet(unsigned char, unsigned char, unsigned char, unsigned short, unsigned char,  unsigned char,  unsigned char, unsigned char);
//#define XILINX_SIZE      			(0x02000000) /*addresses  32Mb x 8 */

#define STEP_TO_PROV      			(0x02000000) /*addresses  32Mb x 8 */
#define PROV_STATE_SIZE      		(0x00000100) 

#define PROG_BMDN4
#define PROG_BMDN2
extern "C" void test_PU37_transit();

#endif
//______________________________________________________________________bmdn5


#ifdef 	PROG_BMDN3

#define	 DEFAULT_ADDR	(0xBEEF)

extern "C" void SendStatus();
extern "C" void ReceiveStatus();

#define SEND_STATUS
#define XIL_FLASH
#define SPEC_REG_ADDR (0x5c3f)
#define SPEC_REG_VAL   (0x2)

extern "C" void embMsgSSC2N_Init();

#define TEST_TIME_CONFIG
extern "C" void SetThreshold(unsigned char, unsigned long);  //
extern unsigned long timer_config;
#define MAXIMUM_COD (30)
#define PORT_FILTER (0x16)

//#define RS485E_ENABLED

extern "C" void EnablePhone(void);

#define SERV_CH (0x0d)
#define EN_SERV (1)

#define MOD_LED_ADDR (0x12)
extern unsigned char oldflag;
extern "C" void LedOff();
extern "C" void LedOn();

extern "C" void WritePort();
extern "C" void ReadPort();
extern "C" void	BusTest();


#define TX_FAULT_S	(0x10)
#define E1_LINES_QUANTITY (21)
#define FAR_LOOP (0x4)
#define OLD_FAR_LOOP (0x8)
#define NEAR_LOOP (0x2)
#define OLD_NEAR_LOOP (0x4)
#define OPTIC_MASK	(0x1)




extern "C" unsigned char GetStmPhyReg(unsigned char);
extern "C" unsigned char GetEthReg(unsigned char);
extern "C" unsigned char GetServReg(unsigned char);
extern "C" unsigned char GetRele(void);
extern "C" unsigned char GetInputs(void);


extern "C" void SetOptics(unsigned char, unsigned char);


#define CHANNEL1_LOCK_BIT (0x2)
#define CHANNEL2_LOCK_BIT (0x8)

extern "C" void InitSetConfigFile(unsigned long);
extern "C" void InitSetACMMask(unsigned short);
extern "C" void SetACMMask(unsigned char , unsigned char);
extern unsigned short acmmask0;

//extern unsigned char ScanTxtFilesNum[MAX_CFG_FILE_VARIANT];
extern "C" void printcurtxt();

extern unsigned long SavedTxtFilesVal;


extern "C" void ScanTxtFiles(void);
#define GET_CONFIG_INFO
#define MAX_SIZE_TEXT_FILE (2000)
extern "C" void GetTxtFile(unsigned long);

//#define START_PRINT
#define	   TABLE_QUANTITY (2)

extern void ProtectionOn(unsigned char);
unsigned char ProtectionOff(unsigned char);
void ChProt(unsigned char , unsigned char );


extern unsigned char ldeviceindex;
extern unsigned char ldeviceindex1;
extern unsigned char ldeviceindex2;
extern unsigned char ldeviceindex3;
extern unsigned char ldeviceindex4;
extern unsigned char ldeviceindex5;
extern unsigned char ldeviceindex6;
extern unsigned char ldeviceindex7;
extern unsigned char ldeviceindex8;


extern unsigned char lprot;
extern unsigned char lacmprofile;
extern unsigned char lislocal;


extern unsigned char lrx;
extern unsigned char ltx;

extern unsigned short lprofile2;


extern unsigned char lengineTable;
extern unsigned char lprofile;
extern unsigned short lmseTenthsVal;
extern unsigned char lldpcMantissaTenths;
extern unsigned char lldpcExponent;
extern unsigned char lcriteria;
extern unsigned char lnextProfile;


#define CONFIG_FILE_40  //110609 will maked later
//#define EMPTY_LOOP //test!!!

//120202 #define DO_NOT_LOAD_PROVINGENTS_PROTECTION

extern "C" void ModemAcmProfileMaskGet(unsigned char);
extern "C" unsigned long GetProvData(unsigned long);
extern "C" void DevAcmConfigurationGet(unsigned char);
extern "C" void ModemAcmCountersGet(unsigned char);
extern "C" void ModemAcmEngineEnable(unsigned char, unsigned char, unsigned char);
extern "C" void ModemAcmProfileEnable(unsigned char , unsigned short);
extern "C" void ModemAcmSwitch(unsigned char, unsigned char, unsigned char);
extern "C" void ModemAcmThresholdSet(unsigned char, unsigned char, unsigned char, unsigned short, unsigned char,  unsigned char,  unsigned char, unsigned char);
//#define XILINX_SIZE      			(0x02000000) /*addresses  32Mb x 8 */

#define STEP_TO_PROV      			(0x02000000) /*addresses  32Mb x 8 */
#define PROV_STATE_SIZE      		(0x00000100) 


#define PROG_BMDN2
extern "C" void test_PU37_transit();

#endif



#ifdef 	PROG_BMDN2

#define CASHE_OFF
//#define ALARM_QUANTITY (2)
//#define ALARM_QUANTITY (10)
#define ALARM_QUANTITY (100)

#define ALARM_QUANTITY1 (15000)	  //1 min fot two prowingents
#define ALARM_QUANTITY2 (12) //for 1 min syntzer	

#define LOCK_OK (1)
//#define BAD_NOISES (0xffffffff) //????
#define BAD_NOISES (0) //????
#define GOOD_NOISES (-1000) //????

#ifndef PROG_BMDN3
#ifndef PROG_BMDN4

#define LOAD_ONE_PROVINGENT_ON_PLATA
#endif //PROG_BMDN3
#endif //PROG_BMDN4



extern "C" unsigned short GetRxPhyId(unsigned char);
extern "C" void GetRxPhyIdD(void);

//#define TEST_CHANGE_REZERV


#define CHANGE_PERIOD	(10000) //10 sec
//#define YOURNAL //110314

extern "C" void SetProtObj(unsigned char, unsigned long);

extern unsigned long time_start_prt, time_rcv_req_to_get, time_end_prt;
//extern unsigned long norma_status[MODEM_QUANTITY << 1];
extern unsigned long used_modems; 
#define ALARM_ANS (1)
//#define EN_PMODER (0x10)
extern "C" void ReadStateRezerv(void);
extern unsigned char currentgetrezerv;	//current modem is on protection transmit
extern unsigned char currenthaverezerv;	//current modem is on protection receive
extern  unsigned char currentrezerv;
extern  unsigned long protection_mode;
extern "C" void SetNeedInitAllProt(void);
extern "C" void SetNeedInitAllProti(unsigned char);
#define NO_MODEM   				(0xff)
#define ZERO_MODEM   			(0)
#define FOUR_MODEM   			(4)

#define MODE_NO_PROT 			(0)
//#define MODE_N_PLUS_1 			(1)
#define MODE_N_PLUS_1 			(2)

//#define MODE_1_PLUS_1 			(2)
#define MODE_1_PLUS_1 			(1)



#define  TYPE_RSERV_MODE  (0xE)

#define  MODE_N_PLUS_1_REZ_ON	(0xB) 
//#define  MODE_N_PLUS_1_REZ_ON	(0x1B) //110104
#define  MODE_N_PLUS_1_WORK_OFF	(0x2)
#define  MODE_N_PLUS_1_WORK_ON	(0xA)
#define  MODE_N_PLUS_1_RSV_ON (0x10)

extern void SetParseFlags(unsigned char);
extern unsigned char ParseFlags(unsigned char);
extern "C" void SetNeedWriteDevId(void);
extern unsigned long GetProt(unsigned char);
extern void SetProt(unsigned char, unsigned long );
extern "C" void ReadStateAll(unsigned long);
extern "C" void SetModemXILNPL1m(unsigned char);
extern "C" void SetPriorityZero(unsigned char);
extern "C" void SetModemXILRsrvMode(unsigned char , unsigned char);
extern "C" void SetStartRezerv() ;


#define PROV_IRQ_ADDR  (5)
#define PROV_MASK_ADDR (6)

#define PROV_DATA_TANZIT	(9)
#define PROV_TANZIT_STATUS	(10)
#define STEP_ADDR	(32)


#define PROV_MODEM_STATUS	(17)


#define PROV_IRQ_ADDR_MOD  (3)
#define PROV_DDC_DATA_ADDR_MOD	(0x10)
#define PROV_MASK_ADDR_MOD	(4)
#define PROV_STATUS_TRANZIT_ADDR	(3)
#define DIS_R	(8)
#define DIS_T	(4)
extern "C" unsigned char ForwardingEnabled();




#define PROV_DDC_DATA_ADDR_UD1	(0x17)
#define PROV_DDC_DATA_ADDR_UD2	(0x19)

//#define TX_READY_BIT  (0x20)
#define RX_READY_BIT  (0x10)




#define	PROG_BMDN1
#define BLOCK_SWEEP1	(0x20) //= 32
extern "C" unsigned char WriteSpiTest(unsigned char, unsigned long , unsigned char * );
extern "C" unsigned char WriteSpiTest1(void);
#endif

#ifdef 	PROG_BMDN1
#define	PROG_BMDN
//#define XIL_FLASH_OFFSET  (24) //
//#define XIL_FLASH_OFFSET  (35) // 120625
#ifndef PROG_ODU1

#define  XIL_FLASH_OFFSET  (27) // 120627
#define  IF_FLASH_OFFSET   (48) // 141107
#else
#define  XIL_FLASH_OFFSET  (53) // 
#define  IF_FLASH_OFFSET   (53) // need use channel "B" for xilinx flash!
#endif



extern "C" void SetModemStruct(unsigned char , unsigned char);
extern unsigned long  RestartTestE;
extern "C" void SendRequest(unsigned char, unsigned char);
extern "C" unsigned long GetPriority(unsigned char);
extern "C" unsigned char GetPriorityZero(void);

extern "C" signed short GetThreshold(unsigned char);
extern unsigned char current_rezerv;
extern "C" signed short CheckNoises(unsigned char);
#define MAX_PRIORITY 	(10)
//#define SYNT_SET_DELAY	(6000) //6000 mcs
//#define SYNT_SET_DELAY	(1000000l) //101224
#define SYNT_SET_DELAY	(900000l) //110825
#define MAX_THRESHOLD  (0xFFFFFFFFl)
#define REZERV_PRIORITY	(0)
#define TEHNOLOGY_PRIORITY	(1)


#define N_MOD //tru add modem in zero slot
#define MIN_PRIORITY     (0)
#define MIN_THRESHOLD    (0)
#define ZERO_PRIORITY (0)





//#define NUMBER_OFFSET (9) //100816
//#define FILE_SIZE    (13500)
//#define SYNT_FILE_SIZE (250)

//101008 not need now #define XIL_FLASH

#ifdef BMDN_CONNECT_USART
//#define printf (printf) 
#endif

extern "C" void ModemStatusGetm(unsigned char);
extern "C" void  ModemAlarmStatusGetAllm(void);
extern "C" void wd_reset(void);	
extern "C" void LoadSyntmf(unsigned long, unsigned char);
extern "C" void LoadSyntm(unsigned char);
extern "C" unsigned char ModemIsUsed(unsigned char);
extern "C" void FillUsedModems();
extern "C" void StartNewConfigFile(unsigned char);

extern "C" void ResetSyntOff(unsigned char);
extern "C" void ResetSyntOnly(unsigned char);


extern "C" void CommonResetOff(unsigned char);
extern "C" void CommonResetOn(unsigned char);
extern "C" void ScanModems(void);
extern "C" void ScanErrors(void);
extern "C" unsigned char ReadingEnabled(unsigned char);
#define TEST_SYMBOL	(0x81)

#define TYPE_ECHO	(0)
#define TYPE_ADDR	(1)
#define RESET_ADDR	(5)
#define STM_PHY_ADDR	(7)
#define ETH_ADDR	(0xC)
#define SERV_ADDR	(0xD)
#define  RELE_ADDR	(0x12)
#define  INPUTS_ADDR (0x13)



#ifndef PROG_DMU6

#define SPI_ADR		(0x0A)
#define ADDR_STATUS1 (0x9)
#define SPI_PORT_ADDR (0x8)	 //data register
#define SPI_SEND_ADDR (0xB)	 //data register

#else

#define SPI_ADR		(0x06)
#define ADDR_STATUS1 (0x4)
#define SPI_PORT_ADDR (0x5)	 //data register
#define SPI_SEND_ADDR (0x7)	 //data register


#endif





#ifndef N_MOD
#define SYNT_OFFSET	(16)

#else
#define SYNT_OFFSET	(18)
#define TEST_OFFSET	(36)
#define FILTER_OFFSET (45)
#endif


#define	MODEM_TYPE	(0x1C)
#define	MODEM_TYPE1	(0x1E)
#define	MODEM_TYPE2	(0x1D)
#define	MODEM_TYPE3	(0x3D)
#define	MODEM_TYPE4	(0x4D)
#define	MODEM_TYPE5	(0xA5)
#define	MODEM_TYPE6	(0xA6)
//sat
#define	MODEM_TYPE7	(0xC1)
#define	MODEM_TYPE8	(0xC2)



#define SYNT_NO_RESET (1)
#define SYNT_RESET_ONLY (0xfe)


#define COMMON_NO_RESET (0xff)
#define CHANNEL_A (0x08)
#define CHANNEL_B (0x09)
#define CHANNEL_C (0x0A)
#define CHANNEL_D (0x0B)  //hier flash
#define CHANNEL_E (0x0C)

#define CHANNEL_T 	 (0xE)
#define CHANNEL_710A (0xC)
#define CHANNEL_710B (0xD)



#define TEMP_LENTH (2)


#define COMMON_RESET (0)



#define BLOCK_SWEEP (0x100)
#define SEND_ALL (0xff)

//#define SYNT_100_MHZ







#endif //PROG_BMDN1

#ifdef 	PROG_BMDN

#define PRINT_USART_DATA   //bmdn
#define TEST_BMDN	  //bmdn
#define TEST_SPI	  //bmdn

//121018 #define VER_OFFSET						0x0003d090
#define VER_OFFSET						0	//121018


#define CFG_DATAFLASH_LOGIC_ADDR_CS0X	0x00000000
#define CFG_DATAFLASH_LOGIC_ADDR_CS1X	0x10000000
#define CFG_DATAFLASH_LOGIC_ADDR_CS2X	0x20000000
#define CFG_DATAFLASH_LOGIC_ADDR_CS3X	0x30000000
#define CFG_DATAFLASH_LOGIC_ADDR_CS4X	0x40000000
#define CFG_DATAFLASH_LOGIC_ADDR_CS5X	0x50000000
#define CFG_DATAFLASH_LOGIC_ADDR_CS6X	0x60000000
#define CFG_DATAFLASH_LOGIC_ADDR_CS7X	0x70000000
#define CFG_DATAFLASH_LOGIC_ADDR_CS8X	0x80000000
#define CFG_DATAFLASH_LOGIC_ADDR_CS9X	0x90000000
#define CFG_DATAFLASH_LOGIC_ADDR_CS10X	0xA0000000
#define CFG_DATAFLASH_LOGIC_ADDR_CS11X	0xB0000000
#define CFG_DATAFLASH_LOGIC_ADDR_CS12X	0xC0000000
#define CFG_DATAFLASH_LOGIC_ADDR_CS13X	0xD0000000
#define CFG_DATAFLASH_LOGIC_ADDR_CS14X	0xE0000000
#define CFG_DATAFLASH_LOGIC_ADDR_CS15X	0xF0000000








#define XIL_ADDR_STEP					0x10000000
#define	XIL_OFFSET						0x00200000	 //? need correct!!!!

//#define CONFIG_FILE_VARIANTS_STEP (14000)
//#define CONFIG_FILE_VARIANTS_STEP (14500)
//#define CONFIG_FILE_PROVINGENT_STEP (10000)

//#define CONFIG_FILE_PROVINGENT_STEP (6500)

#ifndef PACK_CFG

#ifndef CONFIG_FILE_40

#define CONFIG_FILE_PROVINGENT_STEP (8500)
#define FILE_SIZE    (19000)
#define CONFIG_FILE_VARIANTS_STEP (20000)
#define SYNT_DATA_OFFSET (CONFIG_FILE_PROVINGENT_STEP << 1)

#else
#define CONFIG_FILE_PROVINGENT_STEP (18000)
#define FILE_SIZE    (40000)
#define CONFIG_FILE_VARIANTS_STEP (50000)
#define SYNT_DATA_OFFSET (CONFIG_FILE_PROVINGENT_STEP << 1)

#endif

#else  //pack cfg

#define CONFIG_FILE_PROVINGENT_STEP (7500)	   //to can have synt data offset 15000 if << 1
#define FILE_SIZE    (19000)
#define CONFIG_FILE_VARIANTS_STEP (20000)
#define SYNT_DATA_OFFSET  (13000)  //19000 - 6000

#endif	 //pack cfg

//#define SYNT_DATA_OFFSET (CONFIG_FILE_PROVINGENT_STEP << 1)

#define NUMBER_OFFSET (9) //100816
//101001 #define FILE_SIZE    (13500)
//#define FILE_SIZE    (15000)
//#define FILE_SIZE    (19000)
//#define FILE_SIZE    (40000)




#define MAX_CFG_FILE_SIZE  (49000)
#define MIN_CFG_FILE_SIZE  (19000)

#define MAX_CONFIG_DELTA (MAX_CFG_FILE_SIZE >> 1)

//#define SYNT_FILE_SIZE (250)
#define SYNT_FILE_SIZE (500)
//#define CFG_FILE_OFFSET  (1000)
//#define CONFIG_FILE_VARIANTS_STEP (FILE_SIZE + CFG_FILE_OFFSET)
//#define CONFIG_FILE_VARIANTS_STEP (50000)

#define ACM_MODES (16)
//#define MAX_NUM_CFG	 (16)	 /// MAX   16 cfg   
//#define MAX_NUM_CFG	 (32)	 /// MAX   16 cfg   
//150818 #define MAX_NUM_CFG1 (100)
#ifndef	 PROG_MD310_SATI2	
#define MAX_NUM_CFG1 (50)
#endif

#define MAX_NUM_CFG	 (MAX_NUM_CFG1)	 /// MAX   16 cfg   


//#define MAX_CFG_FILE_VARIANT (256)	//	256 
//#define MAX_CFG_FILE_VARIANT (115)	//	115  4 MB
//#define MAX_CFG_FILE_VARIANT (MAX_NUM_CFG)	//	115  4 MB
#define MAX_CFG_FILE_VARIANT (MAX_NUM_CFG1)	//	115  4 MB

extern unsigned char ScanTxtFilesNum[MAX_CFG_FILE_VARIANT];
extern unsigned char ScanTxtFilesNum[MAX_NUM_CFG1];

//#define ANS_CONFIG_FILE_SIZE   (104)

//#define CONFIG_FILE_MASK	(0xff)
#define CONFIG_FILE_MASK	(0x1ff)
//#define MAX_CONFIG_FILE_NUM	(1) //two now 0,1
//#define MAX_CONFIG_FILE_NUM	(255) //two now 0,1


//110323#define ETH_CAN_RESTART
//110323#define DEV_ETH_CAN_RESTART 




extern "C" void StartProtection(void);
extern "C" void LoadSynt(void);
extern "C" unsigned long GetNumConfigFile( unsigned char);
extern "C" unsigned long GetNumConfigFilet( unsigned char);


extern "C" void ConfigFileLoadm(unsigned long, unsigned char);	
extern "C" void ConfigFileRunm(unsigned char);   
extern "C" void CommutateModForSS(); 
extern "C" void ParseRequestsRezervResponses();
extern "C" void ParseRequestsRezervResponsesi(unsigned char);


extern "C" void ModemAlarmEnableSetm(unsigned char);
extern "C" void ModemAlarmEnableSetAllm(unsigned char);

#define MANY_MODEMS //t

#ifndef N_MOD
#define MODEM_QUANTITY		  (8)
#else

#ifndef 	PROG_BMDN3
#ifndef 	PROG_BMDN4
#define MODEM_QUANTITY		  (9)
#else
//#define MODEM_QUANTITY		  (1)
//#define MODEM_QUANTITY		  (9)
#define MODEM_QUANTITY		  (1)
#endif
#else
#define MODEM_QUANTITY		  (1)
#endif
#endif


extern unsigned long norma_status[MODEM_QUANTITY << 1];

//120120#define MAX_MODFORSS_NUM	  (MODEM_QUANTITY)
#define MAX_MODFORSS_NUM	  (0xffffffff)

#define PROV_QUANTITY		  (2)
//#define MODEM_QUANTITY		  (2)
//#define MODEM_QUANTITY		  (1)

#define HEADER_SIZE 	(0x60)
//120208#define TFTP_BUFFER_SIZE (1000000)	 //2 MByte!
//#define TFTP_BUFFER_SIZE  (5000000)	 //5 MByte!
#define TFTP_BUFFER_SIZE  (6160000)	 //6,16 MByte!
#define TFTP_BUFFER_SIZE1 (1000000)	 //1 MByte!

#pragma BSS(".buff_sect")
extern unsigned char TFTP_Buffer[TFTP_BUFFER_SIZE];
#pragma BSS


extern "C" int read_dataflash (unsigned long , unsigned long , char *);
#define cs_last_addr          0x30000000

//#define ProvDataAddressD        (0xC0310000)	 //as audio
#define ProvDataAddressDFwr       (0xC0200000)	 // need find
#define AddressAnyConfigs         (0xC01FE000)
#define AnyConfigSize			  (0x1000)	   //4k
#define OneConfSize				  (200)

#define AddressIFModuleData       (0xC01FD000)
#define IFModuleDataSize		  (200)	   //


//#define ProvDataAddressD       (0xC0300000)	 //as video
//#define ProvSizeToDownloadD    			(86940) 
//#define ProvSizeToDownloadD    			(87516)    //v3.3
#define ProvSizeToDownloadD    			(100000)    //v3.3

//101005 #define ProvSizeToDownloadDCfgFile    	(5960)
//#define ProvSizeToDownloadDCfgFile    	(7261)
//#define ProvSizeToDownloadDCfgFile    	(7301)

//#define SYNT_100_MHZ
//#define SYNT_104_MHZ

//#ifdef SYNT_100_MHZ
//#define FREQ_SYNT 100000000l
//#define ProvSizeToDownloadDCfgFile    	(7260)

//#else
//#ifndef	SYNT_104_MHZ
//#define FREQ_SYNT 200000000l
//#define ProvSizeToDownloadDCfgFile    	(7301)
//#else
#define FREQ_SYNT 104000000l
//#define ProvSizeToDownloadDCfgFile    	(7302)

//#endif

//#endif



#define ProvSizeToDownloadD1    		(10000)
//100415 #define ProvSizeToDownloadD    (10000) 
#define ProvSizeToDownloadDFwr    (100000)

#define ProvDataAddressDCfg       (0xC0300000) //as video
//#define ProvSizeToDownloadDCfg    (5960) 


//#define INTERRUPT_WAIT (2000000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?

//#define XIL_LOAD_FREQ       	500000
//blink somtime led #define XIL_LOAD_FREQ       	200000
//t #define XIL_LOAD_FREQ       	2000000
#define XIL_LOAD_FREQ       	2000000
//#define XIL_LOAD_FREQ       	1000000		 //t
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
//#define IncEmbNMI
//#define IncEmbIndicator
#define IncEmbSerialMD34AVT
//#define XilSizeToDownloadD    (48)   // to can Spartan3 500
//#define XilSizeToDownloadD    (200000)   // to can Spartan3 500
//t #define XilSizeToDownloadD    (175000)   // to can Spartan3 2500
#define XilSizeToDownloadD    (169217)   // t   to can Spartan3 2500
//#define XilSizeToDownloadD    (740000)   // t  have BIT files for all xilinxes

#define XilSizeToDownloadD2   (90000)   // tu use hier firmware file
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG				(1)
//#define XILINXPG				(3) //t
//extern "C" void Init_BMD155(void);





extern "C" void BMDN(void);
extern "C" void Init_BMDN(void);


extern unsigned long  timer;
extern "C" void delay_mcs (unsigned long);

#define RACM_DO_NOT_CHANGE (0)
#define RACM_NEED_DOWN     (1)
#define RACM_CAN_UP        (2)



#endif //PROG_BMDN







#ifdef 	PROG_MPC34
#define cs_last_addr          0x30000000


//#define XIL_LOAD_FREQ        500000
//blink somtime led #define XIL_LOAD_FREQ       	200000
//t #define XIL_LOAD_FREQ       	2000000
//#define INTERRUPT_WAIT (2000000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?

#define XIL_LOAD_FREQ       	3000000
//#define XIL_LOAD_FREQ       	1000000		 //t


#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
//#define IncEmbNMI
//#define IncEmbIndicator

//#define IncEmbSerialMD34AVT
//#define XilSizeToDownloadD    (48)   // to can Spartan3 500
//#define XilSizeToDownloadD    (200000)   // to can Spartan3 500
//t #define XilSizeToDownloadD    (175000)   // to can Spartan3 2500
//#define XilSizeToDownloadD    (169217)   // t   to can Spartan3 2500
#define XilSizeToDownloadD    (740000)   // t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (285000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (285000)  
#define XILINXPG				(1)
//#define XILINXPG				(3) //t
extern "C" void Init_MPC34(void);
extern "C" void MPC34(void);
#endif //PROG_MPC34




#define    NO_TIMEOUT     0

#define NVRAM_BASE      			(pointer)(0x10000000) /* cs0 */
#define NVRAM_SIZE      			(0x00008000) /*  32KB x 8  */
#define NVRAM_FILE_SIZE      		(0x00007000) /*  28KB x 8  */  //to can keep parameters
#define SDRAM_BASE      			(pointer)(0x20000000) /* cs1 */
#define SDRAM_SIZE      			(0x02000000) /* 32Mb x32 */
#define XILINX_BASE      			(pointer)(0x30000000) /* cs2 */
#define XILINX_SIZE      			(0x02000000) /*addresses  32Mb x 8 */
#define OEDBASE      				(pointer)(0x40000000) /* cs3 */
#define OED_SIZE      				(0x02000000) /*addresses  32Mb x 8 */

#define KTVMBASE      				(pointer)(0x40000000) /* cs3 */
#define KTVM_SIZE      				(0x02000000) /*addresses  32Mb x 8 */


#define PERIPH_SIZE      			(0x0FFFFFFF) /* */
#define TRANSSWITCH_SIZE			(0x0000FFFF)	//need check
#define INTERNAL_SIZE      			(0x003FFF) /* */
#define PDC_BUFFER_SIZE				(30000) //to test  must be less 65535	!
//#define PDC_BUFFER_SIZE				(60000)
//#define PDC_BUFFER_SIZE				(60)	  //t

//_________________________________________________________________________
#define XILINXHEADERSIZE		(0x40)
#define XILINXBEFORESIZE		(0x20)

//t#define XilFileDataAddressD    (0xC07C9B20)
//#define XilFileDataAddressD     (0xC0700020)
//#define XilFileDataAddressD2    (0xC0600020)
//#define XilFileDataAddressD3    (0xC0500020)

#define XilFileDataAddressD     (0xC00A7020)
//#define XilFileDataAddressD2    (0xC0100020)
#define XilFileDataAddressD2    (0xC0200020)
#define XilFileDataAddressD3    (0xC0300020)
#define XilFileDataAddressD4    (0xC0400020)
//#define XilFileDataAddressD7    (0xC0700020)
#define XilFileDataAddressD6    (0xC0600020)   //to go from 100 configfiles
#define XilFileDataAddressD7    (0xC0730020)   //to go from 100 configfiles
#define XilFileDataAddressD7A    (0xC0730420)   //to go from 100 configfiles

//#define XilFileDataAddressD7    (0xC0600020)   //t




#define XilDataAddressD       (XilFileDataAddressD  + XILINXHEADERSIZE)  // 0xC0700000 // //is load to 0xc07c9b00, but first 96 bytes are "dummy" - writer change data in  vector 6
#define XilDataAddressD2      (XilFileDataAddressD2 + XILINXHEADERSIZE)//LINXHEADERSI0600000 //
#define XilDataAddressD3      (XilFileDataAddressD3 + XILINXHEADERSIZE)   // 0xC0300000 //
#define XilDataAddressD4      (XilFileDataAddressD4 + XILINXHEADERSIZE)   // 0xC0400000 //
#define XilDataAddressD6      (XilFileDataAddressD6 + XILINXHEADERSIZE) 
#define XilDataAddressD7      (XilFileDataAddressD7 + XILINXHEADERSIZE)  


//#define XilDataAddressD3      (XilFileDataAddressD3 + XILINXHEADERSIZE)   // 0xC0300000 //
#define FULL_HEADER_SIZE 		(0x60)
//100726 #define CONFIG_FILES_ADDRESS      (0xC0220060 + 0x60)   // 
//#define CONFIG_FILES_ADDRESS      (0xC0220060)   // 
//#define CONFIG_FILES_ADDRESS_OLD           (0xC0220060 + 0x60)   // 
#define CONFIG_FILES_ADDRESS           (0xC0220060 + 0x60)   // 
//#define CONFIG_FILES_ADDRESS               (0xE0000060 + 0x60)  //150818

//160126#define  BIG_PROG_SIZE	  (650000)
#define  BIG_PROG_SIZE	  (700000)

#define PAGE_FLASH_SIZE	 (0x1ff)

#ifndef	PROG_ODU1
#define HEADER_XIL_FLASH_ADDRESS 	(XilFileDataAddressD2 - 	     FULL_HEADER_SIZE - PAGE_FLASH_SIZE)
#else
#define HEADER_XIL_FLASH_ADDRESS 	(XilFileDataAddressD2 -     3 * (FULL_HEADER_SIZE + PAGE_FLASH_SIZE))
#endif

#define HEADER_IF_MODULE_ADDRESS 	(XilFileDataAddressD2 - 	2 * (FULL_HEADER_SIZE + PAGE_FLASH_SIZE))



//#define XilSizeToDownloadD    (0x11558)   //71k now
 
//#define ID_ADDRESS (0xC083FBDF)
#define ID_ADDRESS  (0xC0043000)
//t#define ID_ADDRESS2 (0xC0043800)  //for keep freq
#define ID_ADDRESS2  (0xC0300000)  //for keep freq
//ERROR : hier is calibration table!!!!#define ID_ADDRESS3  (0xC01FC000)	//for keep freq
#define ID_ADDRESS3  (0xC01F0000)	//for keep freq

#define PROG_ADDRESS (0xC0044000)
//#define PROG_TEST_ADDRESS (0xC0444000)	  //for test
//#define ID_ADDRESS (0xC083FBE0)
#define DONE_OK		        (0x1)
#define TFTP_PROCEED        (0x2)
#define INTERRUPT_OVERFLOW  (0x4)
#define NO_LINK				(0x8)
#define NO_CHECKSUM			(0x10)
#define NO_NVRAM			(0x20)
#define NO_CLOCK			(0x40)
#define LOCK_MODE1			(0x80)		  //write enabled  for time to restart
#define LOCK_MODE2			(0x100)		 //disabled write
#define LOCK_MODE3			(0x200)		 //enabled write + enabled changing mac address
#define IP_BUFFER_OVERFLOW	(0x400)
#define FILE_WRITE_OK		(0x800)
#define DONE_OK2	        (0x1000)
#define DONE_OK3	        (0x2000)
#define DONE_OK4	        (0x4000)
#define DONE_OK5	        (0x8000)
#define DONE_OK6	        (0x10000)
#define DONE_OK7	        (0x20000)
#define DONE_OK8	        (0x40000)
#define OPERATE_POWER_ON    (0x80000)




#define INT0_FLAG   (0x20)
#define INT1_FLAG   (0x40)
#define TLF_DELAY   (200)//(2000) // (200)
#define DONE_DELAY	 (100) //wait 2 min to reload xilinx if done is off

//t #define INTERRUPT_WAIT (200)
//#define INTERRUPT_WAIT (200000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?


#define XIL_LOAD_TRY  (1)

#ifdef IncEmbRS485
extern "C" void TrzBuff485_Add(unsigned char);
#endif //IncEmbRS485


#ifdef IncEmbRS232
extern "C" void TrzBuff232_Add(unsigned char);
#endif// IncEmbRS232

#ifdef IncEmbRS485
#ifdef IncEmbRS232
extern "C" void TrzBuffs_Send(void);
extern "C" void TrzBuffs_Init(void);
//extern "C" void RDN_BufferR_Init(void);	
#endif// IncEmbRS232
#endif //IncEmbRS485

//#define COM_BUFFER_SIZE 2048
//t #define ACT_BUFFER_SIZE 512
//#define ACT_BUFFER_SIZE 2048
//t #define ACT_BUFFER_SIZE 100000
//t #define ACT_BUFFER_SIZE 10000 //t
// #define ACT_BUFFER_SIZE 1000 //t  2,5 min
//#define ACT_BUFFER_SIZE 5000 //9 min
#define ACT_BUFFER_SIZE 10000 //
//#define ACT_BUFFER_SIZE 2000 //
#define ACT_BUFFER_SIZE1  10000 //tbuff3
#define MAX_COMMAND_SIZE	(256)
#define SIZETX0MF  (1000)
#define SIZE_SOCK_BUFF (300)
#define SIZE_SOCK_BUFFD (1500)



#define cs0_addr               0x10000000
#define cs1_addr               0x20000000
#define cs2_addr               0x30000000
#define cs3_addr               0x40000000

//#define periph_addr            0xFFFFF000
#define periph_addr            0xF0000000
#define TFTP_BUFFER_ADDRESS	   0x20500000


//#define TFTP_BUFFER_SIZE  (5000000)	 //5 MByte!
#define TFTP_BUFFER_SIZE  (6160000)	 //6,16 MByte!
#define TFTP_BUFFER_SIZE1 (1000000)	 //1MByte!

//150522 #define RDN_BUFFER_SIZE (1028)
#define RDN_BUFFER_SIZE (1450) //150522


#define KEY_BUFFER_SIZE (20)
//extern  char RDN_BufferT[RDN_BUFFER_SIZE];
//extern unsigned long cur_RDN_BufferT;
//extern char * pRDN_BufferT;
//extern  char RDN_BufferR[RDN_BUFFER_SIZE];
//extern char * pRDN_BufferR;
//extern char enetdest[6];
//extern char * pntdst;
//extern "C" void RDN_Start_Transmit(void);
extern "C" void RDN_Start_Transmit(char *, char*);

//extern "C" void RDN_Init(void); 
//extern boolean RDN_transmit( IP_IF_PTR , char* , char * );
#define PHY_DM9161_BASIC_MODE_CONTROL_REG   		0
#define PHY_DM9161_BASIC_MODE_STATUS_REG   		    1
#define RDN_MAC0 0x00
#define RDN_MAC1 0x11
#define RDN_MAC2 0x11

#define ETH_485	 (0)
#define ETH_232	 (1)
#define ETH_DIR	 (2)
#define ETH_DBG	 (3)
#define ETH_TRZ	 (4)

#ifndef PROG_BMD2
//#ifndef PROG_PU_M
#define TEST_PERIOD	  (10)
#endif //PROG_BMD2
//#endif // PROG_PU_M

#ifdef PROG_BMD2
#define TEST_PERIOD	  (30)
#endif

//#ifdef PROG_PU_M
//#define TEST_PERIOD	  (30)
//#endif


#define KERNEL_LOG_ENABLED	  (0)	//0 kernel log disabled	 1 - enabled ; if 1 need recompile mqx

#ifndef	 PROG_BACO
#define TESTS_ENABLED		  (1)
#endif

#define MAX_PROG_LENGTH	   (630000)
//#define AT91C_JUMP_ADDR		(0x20000f20) //mqx on start sdram
//#define TEST_JUMP_ADDR     (0x20001f82) //temporary m_usart_init
//#define TEST_JUMP_ADDR     (0x0) //temporary m_usart_init


//#define COMP_DEF_MAC_END (1)
//#define DEV_ID_SIZE	   (28)
//#ifndef PROG_TUTS
//#define DEV_ID_SIZE	   (32)
//#else
//#define DEV_ID_SIZE	   (36)
//#define DEV_ID_SIZE	   (40)
//#define DEV_ID_SIZE	   (48)
//#define DEV_ID_SIZE	   (48 + 24) //prm_PCH_L
//#define DEV_ID_SIZE	   (48 + 36) //prm_PCH_L
//#define DEV_ID_SIZE	   (104) //prm_PCH_L_6
//#define DEV_ID_SIZE	   (108) //prm_PCH_L_6
//#define DEV_ID_SIZE	   (168) //BMDN1
//#define DEV_ID_SIZE	   (208) //BMDN1
//#define DEV_ID_SIZE	   (244) //BMDN1
//#define DEV_ID_SIZE	   (278) //PU_M_V
//#define DEV_ID_SIZE	   (260) //PU_M_V  //corrected
//101117#define DEV_ID_SIZE	(272) //PRM_PCH_DEM
//110111#define DEV_ID_SIZE	(290) //PRM_PCH_DEM
//#define DEV_ID_SIZE	   	   (362) //BMDN2 + (18 * 4)	protection
//#define DEV_ID_SIZE	   	   (370) //BMDN2 + (18 * 4)	protection
//#define DEV_ID_SIZE	   	   (382) //dmu3
//#define DEV_ID_SIZE	   	   (391) //kss+9
//#define DEV_ID_SIZE	   	   (415) //dmu4 + 24
//#define DEV_ID_SIZE	   	   (423) //dmu4 + 24 + 8
//#define DEV_ID_SIZE	   	   (455) //pu_msat  +8*4
//#define DEV_ID_SIZE	   	   (457) //pu_msat  +8*4 +2
//#define DEV_ID_SIZE	   	   	   (458) //sattiming
//#define DEV_ID_SIZE	   	   	   (462) //sattiming
//#define DEV_ID_SIZE	   	   	   (463)  //satsound
//#define DEV_ID_SIZE	   	   	   (467)  //ModEth
//#define DEV_ID_SIZE	   	   	   (471) //webpassword
//#define DEV_ID_SIZE	   	   	   (472) //crc
//#define DEV_ID_SIZE	   	   	   (474) //satdf sattf +crc
//#define DEV_ID_SIZE	   	   	   (478) //satrate +crc
//#define DEV_ID_SIZE	   	   	   (482) //sattimer +crc
//#define DEV_ID_SIZE	   	   	   (486) //sattimer +crc
//#define DEV_ID_SIZE	   	   	   (490) //SOFT_VER
//#define DEV_ID_SIZE	   	   	   (492) //satextlock
//#define DEV_ID_SIZE	   	   	   (493) //satlowp
//#define DEV_ID_SIZE	   	   	   (495) //satalev	satademo
//#define DEV_ID_SIZE	   	   	   (499) //satacode
//#define DEV_ID_SIZE	   	   	   (500) //pum_mux modforss
//#define DEV_ID_SIZE	   	   	   (502) //pum_mux modforss
//#define DEV_ID_SIZE	   	   	   (544) //
//#define DEV_ID_SIZE	   	   	   (546)   //MTMode MRMode
//#define DEV_ID_SIZE	   	   	   (547)   //MRCntl
//#define DEV_ID_SIZE	   	   	   (551)
//#define DEV_ID_SIZE	   	   	   (552)
//#define DEV_ID_SIZE	   	   	   (556)
//#define DEV_ID_SIZE	   	   	   (572)
//#define DEV_ID_SIZE	   	   	   (573)  //RACMOnOff
//#define DEV_ID_SIZE				   (765)  //full racm
//#define DEV_ID_SIZE				   (766)  //RACMOnOffT
//#define DEV_ID_SIZE				   (770)  //RACMOffset
//#define DEV_ID_SIZE				   (771) //ten_mhz 
#define DEV_ID_SIZE				   (775) //ipaddressudp 







 




//#define DEV_ID_SIZE2	   	   (65) //maked for keep freq
//  #define DEV_ID_SIZE2	   	   (66) //maked for keep sourcepch
 // #define DEV_ID_SIZE2	   	   (69) //maked for keep sourcepch
   #define DEV_ID_SIZE2	   	   (71)	//prm_inp









//#endif

#define MASK_BIT_0	(1<<0)
#define MASK_BIT_1	(1<<1)
#define MASK_BIT_2	(1<<2)
#define MASK_BIT_3	(1<<3)
#define MASK_BIT_4	(1<<4)
#define MASK_BIT_5	(1<<5)
#define MASK_BIT_6	(1<<6)
#define MASK_BIT_7	(1<<7)
#define MASK_BIT_8	(1<<8)
#define MASK_BIT_9	(1<<9)
#define MASK_BIT_10	(1<<10)
#define MASK_BIT_11	(1<<11)
#define MASK_BIT_12	(1<<12)
#define MASK_BIT_13	(1<<13)
#define MASK_BIT_14	(1<<14)
#define MASK_BIT_15	(1<<15)
#define MASK_BIT_16	(1<<16)
#define MASK_BIT_17	(1<<17)
#define MASK_BIT_18	(1<<18)
#define MASK_BIT_19	(1<<19)
#define MASK_BIT_20	(1<<20)
#define MASK_BIT_21	(1<<21)
#define MASK_BIT_22	(1<<22)
#define MASK_BIT_23	(1<<23)
#define MASK_BIT_24	(1<<24)
#define MASK_BIT_25	(1<<25)
#define MASK_BIT_26	(1<<26)
#define MASK_BIT_27	(1<<27)
#define MASK_BIT_28	(1<<28)
#define MASK_BIT_29	(1<<29)
#define MASK_BIT_30	(1<<30)
#define MASK_BIT_31	(1<<31)

#define CLOCK_REGISTERS (8)


#define  START_WRITE_BUFFER	 (1)
#define  NO_START_WRITE_BUFFER	 (0)
//#define	 HEADER_SIZE	(96)

extern "C" void UseDirRS232(void);
extern "C" void ParseE(void);
extern "C" void TransmitE(void);
extern char TBuff0[ACT_BUFFER_SIZE1];
extern char TBuff3[ACT_BUFFER_SIZE1];
//extern char HostMAC[6];
extern "C" void dir_eth_232( char );
extern "C" char ComparePOK(unsigned long );
extern "C" void WritePOK(unsigned long );
extern "C" char CheckDoneShort();
extern "C" char CheckDoneShort2();
extern "C" char CheckDoneShort3();
extern "C" char CheckDoneShort4();
extern "C" void test_TELO();
extern "C" void test_TLLO();
extern "C" void test_BUS();
extern "C" void test_w2o0in0();
extern "C" void test_w4o13in13();
extern "C" void test_w4o4in13();
extern "C" char TestCheckSum(void);
extern "C" char ProgWrite(void);
extern "C" char XilWrite(void);
extern "C" char Test_NVRAM(void);
extern "C" void WriteDevId(void);
extern "C" void WriteDevId2(void);


extern void delay_mcs1(unsigned long);
extern "C" void m_load_xilinx3 (char pg , char div);
extern "C" void m_load_xilinx3_ram (char pg , char div);
extern "C" void SetBufferState(unsigned long tmp);
extern "C" void Ring(unsigned char M, unsigned char N, unsigned char F, unsigned char T);	  //  *100ms
extern "C" void usart_command_eth_off(void);
#ifdef IncEmbIndicator
extern "C" void CopyInd0ToRemote(char* );
extern "C" void CopyInd1ToRemote(char* );
extern "C" void CopyCur2Remote(int );
extern "C" void CopyLed2Remote(int );
#endif //IncEmbIndicator


#ifdef USE_PULT
extern "C" void ticket_on(void);
#endif //USE_PULT

#ifdef PULT_USART
extern void AddKeyBuffer(unsigned char);
extern void InitKeyBuffer();
extern unsigned char GetKeyBuffer();
//#define KEY_BUFFER_SIZE	(100)
#endif //PULT_USART

#ifdef ETH_DEBUG_ENABLED
extern "C" void printEthString(char * , unsigned long );
extern "C" void printEthLongHex(unsigned long);
extern "C" void printEthByteHex(unsigned char);
extern "C" void printEthStringAdd(char , char );

#endif //


extern "C" void  my_int_disable(void);
extern "C" void  my_int_enable(void);
extern "C" void  eth_command_usart1_off(void);
extern "C" void   usart_command_eth_on(void);
extern "C" void   usart_command_eth_off(void);

#define MAX_COMPANY	1000


extern "C" void SetNVRAMToData(unsigned char);
extern "C" void EmbInitNVRAM(void);

#define FIRST_KEY (0x10000001)
#define TWO_KEY   (0x20000002)
#define THREE_KEY (0x30000003)
#define FOUR_KEY  (0x12345678)
#define FIVE_KEY  (0xFFFFFFFF)

#ifdef TRAP_ENABLED
extern "C" void	SendTrap(unsigned char );
#endif //TRAP_ENABLED

extern "C" void printEmb(void);

#ifdef 	ETH_TRANZIT

extern "C" void	AddEthTranzit(char * );
extern "C" void InitEthTranzitMsg(void);
extern "C" void	AddEthTranzitBuffers(void);
//extern unsigned long  EthReceiveTimer;

#endif //ETH_TRANZIT


//extern  unsigned long Stephany5;
//#define REAL_TIME (0xFFFFFD24)
extern int my_rand(void);
#define  FREQ_BASE   (0x10001000l)
extern char InitFinish;


#ifdef LOAD_EXT_MODEM
extern "C" void	 LoadExtModem(void);
#define  DATA_SIZE_EXTMODEM (39)

#endif // LOAD_EXT_MODEM

extern "C" unsigned long GetTestMode(void);
extern "C" void SetTestMode(unsigned long);


//extern unsigned char t_set, b_set;

#define TLF_NUMBER_DIGITS_OLD (3)	  
#define TLF_NUMBER_DIGITS_NEW (2)

//#define COUNTER_LOCK (500)
#define COUNTER_LOCK (TIME_CHECK_LOCK / 8)


#define FREQ_PUL (160)

#define TCP_PORT (17)

//091218 #define BUFFER_SIZE_T  (1500) //maked as in rtcs
#define BUFFER_SIZE_T  (1500) //091218
//#define BUFFER_SIZE_T  (1460) //091221



extern char buffer_rad_T[BUFFER_SIZE_T];
extern unsigned long  buffer_rad_T_len;

extern char buffer_rad_TU[BUFFER_SIZE_T];
extern unsigned long  buffer_rad_T_lenU;



extern "C" void SetIPRem(unsigned long);
extern "C"unsigned long GetIPRem(void);

#ifdef USE_SOCKETSD

extern "C" void SetIPRemUDP(unsigned long);
extern "C"unsigned long GetIPRemUDP(void);

#endif



#ifdef HAVE_GATEWAY

extern "C" void SetNetworkRem(unsigned long);
extern "C"unsigned long GetNetworkRem(void);
extern "C" void SetNetMaskRem(unsigned long);
extern "C"unsigned long GetNetMaskRem(void);


#endif


#define DISP_LEN	(24)
extern "C" void FillProgVersion1(char * , long);
extern "C" void FillSynceVersion1(char * , long);
extern "C" void FillSound(char * , long);

extern "C" void FillXilinxVersion1(char * , long);

#define TESTMODE4_START    (5*60*1000) //5 min

extern "C" void dev_restart ( void );
extern "C" void dev_restart1 ( void );
extern "C" void set_test_mode ( unsigned long );

extern "C" char DPDWrite();

#define DPD_ADDRESS (0xC0400000)
#define DPD_SIZE 	(40000)

extern unsigned long Stephany19;

extern unsigned long data_buffer;       //need init data!!!!!!!!
extern unsigned char counter_buffer;   //need init counter!!!!!!

extern "C" unsigned long  GetStateSynce(void);
extern "C" unsigned char ReadDataI2C(unsigned char);
extern "C" void outportb(unsigned int , unsigned char );

extern "C" void any_init();


#define ADDR_READ_I2C (0x3b)

#define SIGNAL_MASK (0x80)
#define CODER_OK	(0x40)

//extern unsigned char send485_enabled;


extern "C" void  ParseCommand1(void);
extern "C" void  ParseCommand2(char *);
extern "C" void  ParseCommand3(char *);
extern "C" void  ParseCommand4(char *);
extern "C" void  ParseCommand5(char *);
extern "C" void  ParseCommand6(char *);
extern "C" void  ParseCommand7(char *);
extern "C" void  ParseCommand8(char *);
extern "C" void  ParseCommand9(char *);
extern "C" void  ParseCommand10(char *);
extern "C" void  ParseCommand11(char *);
extern "C" void  ParseCommand12(char *);
extern "C" void  ParseCommand13(char *);
extern "C" void  ParseCommand14(char *);

extern "C" void  ParseCommand30(char *);
extern "C" void  ParseCommand31(char *);
extern "C" void  ParseCommand32(char *);
extern "C" void  ParseCommand33(char *);
extern "C" void  ParseCommand15(char *);







extern "C" unsigned char Roulette1(void);
extern "C" unsigned char Roulette2(void);








extern "C" void add_char_TCP_buff(unsigned char);

#define DELAY_AUDIO	 (50)
extern "C" void set_audio(int ,int );


extern "C" void tstep1(void);
extern "C" void tstep2(void);
extern "C" void tstep3(void);
extern "C" void tstep4(void);
extern "C" void tstep5(void);
extern "C" void tstep6(void);
extern "C" void tstep7(void);
extern "C" void tstep8(void);

extern "C" void tstep51(void);
extern "C" void tstep52(void);

#define NVRAM_PARAMETERS_STORAGE (0x500)
#define FREQ1_ADDR (0)
#define FREQ2_ADDR (0x4)
#define ATT1_ADDR (0x8)
#define ATT2_ADDR (0xC)






extern "C" void  RestoreParameters(void);

extern "C" void MakeNextStepScan1(void);
extern "C" void MakeNextStepScan2(void);

extern "C" void  SetAttRPU1(unsigned char);
//extern "C" void  SetAttRPU2();
//extern "C" void  SetAttRPU3();
extern "C" void  SetAttRPU4(unsigned char);
//extern "C" void  SetAttRPU5();
//extern "C" void  SetAttRPU6();
#ifndef TEST_PRM
//#define SCAN_DELAY (3)
//#define SCAN_DELAY (8)
//#define SCAN_DELAY (3)
//t100119  #define SCAN_DELAY (4) //it is really delay!
//#ifdef TEST_RECEIVE
//#define SCAN_DELAY (4)	   //t100119
//#else
//151210#define SCAN_DELAY (4)	
#define SCAN_DELAY (7)	
//#endif

//#define SCAN_DELAY (12)

// #define SCAN_DELAY (20)   //t

//#define NO_SCAN_DELAY (100)
//#define NO_SCAN_DELAY (400)
//#define NO_SCAN_DELAY (75)
//091025#define NO_SCAN_DELAY (0)
#define NO_SCAN_DELAY (6) //091025 //to not have momentally sending
#define ROULETTE_DELAY (75)
#define ZERO_DELAY (0)

#else //TEST_PRM

#define SCAN_DELAY (5)	
//#endif

//#define SCAN_DELAY (12)

// #define SCAN_DELAY (20)   //t

//#define NO_SCAN_DELAY (100)
//#define NO_SCAN_DELAY (400)
//#define NO_SCAN_DELAY (75)
//091025#define NO_SCAN_DELAY (0)
#define NO_SCAN_DELAY (5) //091025 //to not have momentally sending
#define ROULETTE_DELAY (30)
#define ZERO_DELAY (0)


#endif


extern "C" void AlarmsOn1(void);
extern "C" void AlarmsOff1(void);
extern "C" void AlarmsOn2(void);
extern "C" void AlarmsOff2(void);

#define LED_PORT (4)
#define ALARM_MASK1 (0xF8)
#define NO_ALARM_MASK1 (0x7)
#define ALARM_MASK2 (0x8F)
#define NO_ALARM_MASK2 (0x70)


#ifdef PRM_PCH_THREE_LINES
extern "C" void AlarmsOff3(void);
extern "C" void ParseUD_3(void);
extern "C" void MakeNextStepScan3(void);
extern "C" unsigned char Roulette3(void);
extern "C" void AlarmsOn3(void);
#define LED_PORT3      (0xf)
#define ALARM_MASK3    (0xF8)
#define NO_ALARM_MASK3 (0x7)


extern "C" void  SetFreq3(void);
extern "C" void  SetAtt3(void);
extern "C" void  GetCode3(void);
extern "C" void  GetLockLevel3(void);
extern "C" void  GetTemp3(void);
extern "C" void  Get48_3(void);
extern "C" void  Get24_3(void);
extern "C" void  Get7_3(void);
extern "C" void  Get5_3(void);
extern "C" void  Get5M_3(void);
#define FREQ3_ADDR (0x10)
#define ATT3_ADDR (0x14)

#endif //PRM_PCH_THREE_LINES

#ifdef PRM_PCH_SIX_LINES

//____________________________________4
extern "C" void AlarmsOff4(void);
extern "C" void ParseUD_4(void);
extern "C" void MakeNextStepScan4(void);
extern "C" unsigned char Roulette4(void);
extern "C" void AlarmsOn4(void);
extern "C" void  SetFreq4(void);
extern "C" void  SetAtt4(void);
extern "C" void  GetCode4(void);
extern "C" void  GetLockLevel4(void);
extern "C" void  GetTemp4(void);
extern "C" void  Get48_4(void);
extern "C" void  Get24_4(void);
extern "C" void  Get7_4(void);
extern "C" void  Get5_4(void);
extern "C" void  Get5M_4(void);
#define FREQ4_ADDR (0x18)
#define ATT4_ADDR (0x1C)


//______________________________________4

//____________________________________5
extern "C" void AlarmsOff5(void);
extern "C" void ParseUD_5(void);
extern "C" void MakeNextStepScan5(void);
extern "C" unsigned char Roulette5(void);
extern "C" void AlarmsOn5(void);
extern "C" void  SetFreq5(void);
extern "C" void  SetAtt5(void);
extern "C" void  GetCode5(void);
extern "C" void  GetLockLevel5(void);
extern "C" void  GetTemp5(void);
extern "C" void  Get48_5(void);
extern "C" void  Get24_5(void);
extern "C" void  Get7_5(void);
extern "C" void  Get5_5(void);
extern "C" void  Get5M_5(void);
#define FREQ5_ADDR (0x20)
#define ATT5_ADDR (0x24)


//______________________________________5

//____________________________________6
extern "C" void AlarmsOff6(void);
extern "C" void ParseUD_6(void);
extern "C" void  MakeNextStepScan6(void);
extern "C" unsigned char Roulette6(void);
extern "C" void AlarmsOn6(void);
extern "C" void  SetFreq6(void);
extern "C" void  SetAtt6(void);
extern "C" void  GetCode6(void);
extern "C" void  GetLockLevel6(void);
extern "C" void  GetTemp6(void);
extern "C" void  Get48_6(void);
extern "C" void  Get24_6(void);
extern "C" void  Get7_6(void);
extern "C" void  Get5_6(void);
extern "C" void  Get5M_6(void);
#define FREQ6_ADDR (0x28)
#define ATT6_ADDR (0x2C)
//______________________________________6

//____________________________________7
extern "C" void AlarmsOff7(void);
extern "C" void ParseUD_7(void);
extern "C" void  MakeNextStepScan7(void);
extern "C" unsigned char Roulette7(void);
extern "C" void AlarmsOn7(void);
extern "C" void  SetFreq7(void);
extern "C" void  SetAtt7(void);
extern "C" void  GetCode7(void);
extern "C" void  GetLockLevel7(void);
extern "C" void  GetTemp7(void);
extern "C" void  Get48_7(void);
extern "C" void  Get24_7(void);
extern "C" void  Get7_7(void);
extern "C" void  Get5_7(void);
extern "C" void  Get5M_7(void);
#define FREQ7_ADDR (0x58)				 //		need correct!!!!
#define ATT7_ADDR (0x5C)				  //
//______________________________________7
//____________________________________8
extern "C" void AlarmsOff8(void);
extern "C" void ParseUD_8(void);
extern "C" void  MakeNextStepScan8(void);
extern "C" unsigned char Roulette8(void);
extern "C" void AlarmsOn8(void);
extern "C" void  SetFreq8(void);
extern "C" void  SetAtt8(void);
extern "C" void  GetCode8(void);
extern "C" void  GetLockLevel8(void);
extern "C" void  GetTemp8(void);
extern "C" void  Get48_8(void);
extern "C" void  Get24_8(void);
extern "C" void  Get7_8(void);
extern "C" void  Get5_8(void);
extern "C" void  Get5M_8(void);
#define FREQ8_ADDR (0x68)					//		need correct!!!!
#define ATT8_ADDR (0x6C)
//______________________________________8










#endif //PRM_PCH_SIX_LINES
#define ATT1_ADDR_RPU (0x30)
#define ATT2_ADDR_RPU (0x34)
#define ATT3_ADDR_RPU (0x38)
#define ATT4_ADDR_RPU (0x3C)
#define ATT5_ADDR_RPU (0x40)
#define ATT6_ADDR_RPU (0x44)
#define ATT7_ADDR_RPU (0x4C)
#define ATT8_ADDR_RPU (0x50)






#define NVRAM_DEBUG_STORAGE (0x1000)
#ifdef BMD155_ETH
extern "C" void	 InitXilBmdEth();
#define XILINX_CONFIG_ADDRESS2 (0x515) //	
#define XILINX_CONFIG_ADDRESS1 (0x523) //	
#define NVRAM_CONFIG_ADDRESS2 (0x7ff3) //	
#define NVRAM_CONFIG_ADDRESS1 (0x7ff4) //	
#endif // BMD155_ETH

#define INIT_SIGN_ADDRESS (0x7ff7) //last before operate registers	   
#define INIT_SIGN_VALUE	  (0xA5)
#define TEST_DISABLE_ADDRESS1 (0x7ff5)
#define TEST_DISABLE_ADDRESS2 (0x7ff6)
#define TEST_DISABLE_VALUE1	  (0x5A)
#define TEST_DISABLE_VALUE2	  (0x0F)
#define RESTARTS_NVRAM_ADDRESS (0x7ff2)
#define DELAY_NVRAM_ADDRESS    (0x7ff1)
#define ETH_TRANZIT_ON_ADDRESS (0x7ff0)
#define ETH_TRANZIT_ON_VALUE   (0x93)



extern "C" void LoadSome();




//extern "C" void ENET_SCAN(pointer);
extern unsigned long  autoneg_counter;
#define RESTART_LINK_DELAY	 (10)

 #ifdef ALL_ADDR
 extern unsigned long counter_mreceive;
 extern unsigned long counter_msend;
 #endif //  ALL_ADDR
 extern unsigned long tsee[11];
 extern "C" void testprint(void);

#define IF_CONTROL (0x10)

extern "C" void testWrite(void);



#ifdef CLOCK_ENABLED
extern "C" void ClockStart(void);
extern "C" void ClockStop(void);
extern "C" void ClockWriteSec(unsigned char);
extern "C" void ClockWriteMin(unsigned char);
extern "C" void ClockWriteHours(unsigned char);
extern "C" void ClockWriteDate(unsigned char);
extern "C" void ClockWriteMonth(unsigned char);
extern "C" void ClockWriteYear(unsigned char);
extern "C" void UpdateClock(void);
#define	TIMEDATA1_MAX	(59)
#define	TIMEDATA1_MIN	(0)
#define	TIMEDATA2_MAX	(59)
#define	TIMEDATA2_MIN	(0)
#define	TIMEDATA3_MAX	(23)
#define	TIMEDATA3_MIN	(0)
#define	TIMEDATA4_MAX	(31)
#define	TIMEDATA4_MIN	(1)
#define	TIMEDATA5_MAX	(12)
#define	TIMEDATA5_MIN	(1)
#define	TIMEDATA6_MAX	(99)
#define	TIMEDATA6_MIN	(0)



#endif // CLOCK_ENABLED

#define CODE_CODE (0)
#define CODE_PRM1 (1)
//#define CODE_PRM1 (0) //temporary!

#define CODE_SET_ATT (20)
#define CODE_LOCK_LEVEL (21)
#define CODE_TEMP (22)
#define CODE_48 (23)
#define CODE_24 (24)
#define CODE_7 (25)
#define CODE_5 (26)
#define CODE_5M (27)
#define CODE_SET_ATT_12 (28)
#define CODE_SET_ATT_13 (29)



#define FREQ_CODE (2)
#define ATT_CODE  (3)
#define ATT_RPU_CODE  (11)
#define ATT_RPU5_CODE  (14)
#define COMMAND_12	(0xC)
#define COMMAND_13	(0xD)


#define LOST_CODE (0)
#define ALARM_CODE (1)
extern "C" unsigned char device_found(unsigned char);



#define CODE_COMMAND_7  (7)
#define MAX_STEPS (500)

#define FORMULA_LEN (14)
#define DEVICE_TYPE_MASK  (0xC3)
#define PUPM2_TYPE_CONV_MASK (0xC3)


//#define DEVICE_TYPE_MASK (0xFF)

#ifdef COMMAND_RESENDING
//#define  RESENDING_DELAY (5)
#define  RESENDING_DELAY (7)  //091025

#endif // COMMAND_RESENDING

extern "C" unsigned char MakeAttBack(unsigned char);

extern "C" void SetUsart1BaudRate(unsigned long);

extern "C" void PrintMessages(void);

#ifndef PROG_PRM_PCH_SPI
//#define RUN_TIME  (7)
//151106#define RUN_TIME  		(30) //this was before all
#define RUN_TIME  		(500) //
//#define RUN_TIME  		(100)	  //110223
//#define RUN_TIME  		(75)	  //110223
//#define RUN_TIME  		(100)	  //110223
//#define RUN_TIME  		(10)

#define RUN_TIME_PUPM2   (10)
#define LONG_RUN_TIME   (100)

//#define LONG_RUN_TIME   (37)

#else
#define RUN_TIME  		(0) 
#define LONG_RUN_TIME   (0)
#endif



extern unsigned long timerun;
extern unsigned char breakflag;
extern unsigned long time1;
extern unsigned long message;



#ifdef USART0_TRY_PDC
extern "C" void PrintTestBuf();
extern "C" void my_usart0_pdc_int();
extern "C" void enableRxPdcUsart0();
extern unsigned long counter_int;
extern unsigned long counter_int1;
#endif

#ifdef USART1_TRY_PDC
extern unsigned char flag_pdcu1;
extern unsigned char flag_pdc1;

extern "C" void ReadDatau1(unsigned char * , unsigned long );
extern  unsigned long time_pdc_u1, timer;
#define PDC_PERIOD (3) //*100 mcs	 1- 0,5% 3 - 0,2 %    4- 0,2%   2- losses
extern void enableRxPdcUsart1(void);
extern "C" void OperateBuffers_usart1(void);

#endif

#ifdef USART2_TRY_PDC
extern unsigned char flag_pdcu2;
extern unsigned char flag_pdc2;

extern "C" void ReadDatau2(unsigned char * , unsigned long );
extern  unsigned long time_pdc_u2, timer;
#define PDC_PERIOD2 (3) //*100 mcs	 1- 0,5% 3 - 0,2 %    4- 0,2%   2- losses
extern void enableRxPdcUsart2(void);
extern void OperateBuffers_usart2(void);

#endif


#ifdef USART0_TRY_PDC_1T
extern unsigned char flag_pdcu0t;
extern unsigned char flag_pdc0;
extern "C" void ReadDatau0t(unsigned char * , unsigned long );
extern  unsigned long time_pdc_u0t;
#define PDC_PERIOD_T (3) //*100 mcs	 1- 0,5% 3 - 0,2 %    4- 0,2%   2- losses
//#define PDC_PERIOD_T (5) //*100 mcs	 1- 0,5% 3 - 0,2 %    4- 0,2%   2- losses
extern void enableTxPdcUsart0(void);
extern "C" void OperateBuffers_usart0t(void);

//#define	 fputc(x, fusart0_ptr) ToPdcTu0(x)

extern "C" void ToPdcTu0(unsigned char);

#endif	//


#ifdef USART1_TRY_PDC_1T
#define PDC_PERIOD_T1 (3)
extern unsigned char flag_pdcu1t;
extern "C" void ReadDatau1t(unsigned char * , unsigned long );
extern  unsigned long time_pdc_u1t;
//#define PDC_PERIOD_T (3) //*100 mcs	 1- 0,5% 3 - 0,2 %    4- 0,2%   2- losses
extern "C" void enableTxPdcUsart1(void);
extern "C" void OperateBuffers_usart1t(void);

//#define	 fputc(x, fusart1_ptr) ToPdcTu1(x)

extern "C" void ToPdcTu1(unsigned char);

#endif	//USART1_TRY_PDC_1T

#ifdef USART2_TRY_PDC_1T
#define PDC_PERIOD_T2 (3)
extern unsigned char flag_pdcu2t;
extern "C" void ReadDatau2t(unsigned char * , unsigned long );
extern  unsigned long time_pdc_u2t;
//#define PDC_PERIOD_T (3) //*100 mcs	 1- 0,5% 3 - 0,2 %    4- 0,2%   2- losses
extern "C" void enableTxPdcUsart2(void);
extern "C" void OperateBuffers_usart2t(void);
extern "C" void ReceiveReport(unsigned char);


//#define	 fputc(x, fusart1_ptr) ToPdcTu1(x)

extern "C" void ToPdcTu2(unsigned char);

#endif	//USART2_TRY_PDC_1T


#ifdef USART0_TRY_PDC_1
extern unsigned char flag_pdcu0;
extern "C" void ReadDatau0(unsigned char * , unsigned long );
extern  unsigned long time_pdc_u0;//, timer;
//#define PDC_PERIOD (3) //*100 mcs	 1- 0,5% 3 - 0,2 %    4- 0,2%   2- losses
extern void enableRxPdcUsart0(void);
extern void OperateBuffers_usart0(void);

#endif






#ifdef PROG_PRM_PCH
extern unsigned long timewait;
extern "C" void print_signature(void);
#endif // PROG_PRM_PCH










/*					
#define FIRST_KEY (0x9476569f)
#define TWO_KEY   (0x9576960b)
#define THREE_KEY (0xd6ef2903)
#define FOUR_KEY  (0x9575f848)
#define FIVE_KEY  (0xdab50903)
 */

//extern "C" void          _task_ready_internal2(TD_STRUCT_PTR);
/*
**   Externs for global data
*/

/*
** Externs for Tasks and ISRs
*/



//void wd_reset(void);

/* End of File */

//extern "C" void RunCommandN2(unsigned short); //for testing only

extern "C" void SetLink10(void);

#ifdef TEST_RECEIVE
extern unsigned long sendp;
extern unsigned long receivep, receivepb;
extern unsigned long delta, delta_old;
extern unsigned long st_count;

#endif //TEST_RECEIVE
extern unsigned char is_servicepack;

#ifdef ETH_CAN_RESTART
#define CHECK_ETH_STATE
extern "C" void Restart_Eth(void);
extern "C" void Restart_Eth1(void);
extern "C" void Restart_Eth2(void);
extern "C" void Restart_Eth3(void);

//#define ETH_RESTART_TIMEOUT (600)
#ifndef TRY_UNBLOCK
//#define ETH_RESTART_TIMEOUT (60)
#define ETH_RESTART_TIMEOUT (20)
#else
#define ETH_RESTART_TIMEOUT (13)
#endif
//#define ETH_RESTART_TIMEOUT (25)	 //101122
//#define ETH_RESTAR ETH_RESTART_TIMEOUT (25)	 //101122
//#define ETH_RESTARewer 2 sec
#endif // ETH_CAN_RESTART

//extern uint_32 speed;
/*
extern  uint_32  rtcs_result;
extern  _enet_handle    enet_handle0;    //100201
extern  _enet_address   enet_local0; //this is mac!!!!!!!   //100201
extern "C" void Enet_is_not_init();
extern uint_32 GetIP();
extern char_ptr taskname;
*/
#ifdef USE_TCPIP_CLIENT
//extern "C" void QUOTE_client(unsigned long); 
#define PAKETS_LIMIT (1000l)
extern unsigned long q_client_counter;

#endif //USE_TCPIP_CLIENT

#ifdef USE_QUOTE_SERVER  
extern unsigned long rpac_counter;
#endif //USE_QUOTE_SERVER 

extern unsigned char * ExChangeSpi(unsigned long , unsigned char * );
extern void WriteSpiB(unsigned long , unsigned char * );
extern "C" unsigned char WriteSpiBm(unsigned char deviceindex, unsigned long , unsigned char * );

extern unsigned char * ReadSpiB(unsigned long);
extern unsigned char * ReadSpiBm(unsigned char deviceindex, unsigned long length_of_data);
extern "C" void ComConfigure(unsigned char);


extern "C" unsigned long  GetVersionAPI(void);
#define MAX_SP_LEN (256)
#define ADDR_STATUS	(0x3)
#define GO_BIT (0x1)
#define RESET_BIT  (0x2)
#define ADDR_DATA  (0x2)
#define ADDR_ADDR 0x4
#define SPI_ADDR  0x8
#define RES_A (0xCF)
#define RES_B (0x3f)

extern "C" void Transmit0c(unsigned char);
extern "C" unsigned char GetUsart0Data(unsigned char *);
extern "C" void SetUsart0BaudRate(unsigned long);

extern "C" void my_rx_usart0_int( char);
extern "C" void RestoreAttRPU(unsigned char , unsigned long );
extern "C" void  SetAttRPU1(unsigned char );

extern "C" void FirmwareLoad();
extern "C" void ConfigFileLoad();
extern "C" void ConfigFileGet();
extern "C" void ConfigFileRun();
extern "C" void ModemStatusGet();
//extern "C" void ModemAcmCountersGet();
extern "C" void ModemAcquireCountersGet();
extern "C" void StartModem();
extern "C" void StartModems(unsigned char);

extern "C" void ModemFecCountersGet();
extern "C" unsigned char ModemMailboxMessageSend(unsigned short, unsigned char *);
extern "C" unsigned char * ModemMailboxMessageReceive(void);
extern "C" void TestMailBoxes();
extern "C" void ModemAlarmEnableGet(void);
extern "C" void ModemAlarmEnableSet(void);






extern "C" void FirmwareReLoad();
extern "C" void FirmwareBurn();
extern "C" void DirectLoad(void);
extern "C" void LoadToLdr();
#define PROVHEADER  (16)
#define PROVEND 	(350)



extern "C" void FlashFirmwareLoad();
#ifdef PRINT_USART_DATA 
extern unsigned char print_flag;
#endif //  PRINT_USART_DATA

extern "C" void Init_SSC1(void);
extern "C" void OperateSynt(unsigned long);
extern "C" void Init_IOs(void);

#define SSC1_BUFFER_SIZE  (8)
#define SSC1_BUFFER_SIZE_RECEIVE 8 // //t (8)

//#define SSC1_SEND_SIZE  (1)
#define SSC1_SEND_SIZE  (5)	  //t reseive avd send

#define SSC1_RECEIVE_SIZE 5 //8 //70 // (5)



#define ENDTX_INT	   (4)
#define ENDRX_INT	   (0x40)

#define MESSAGE_LEN	   (5) //????
#define  START_LEN	   (3)	//???
extern unsigned long ssc1_int_cnt; 
extern unsigned char SSC1_BUFFER[SSC1_BUFFER_SIZE];
extern unsigned char SSC1_BUFFER_RECEIVE[SSC1_BUFFER_SIZE_RECEIVE];

//_________________________________m
extern unsigned char now_is_sending;
extern unsigned char need_to_sended;
//_________________________________m

//#define TIME_FOR_STANDART_PROTOKOL		(100000)
//110920 #define TIME_FOR_STANDART_PROTOKOL		(0)
#define TIME_FOR_STANDART_PROTOKOL		(100)

#ifdef IDLE_MODE
 #define TIME_FOR_IDLE		(60000)
 extern "C" void SetSlowClock();
#endif

extern	unsigned char use_standard_protocol;

extern "C" void SetLed2(unsigned char );
extern unsigned long led2timer;
extern unsigned long led3timer;

extern "C" void SendAndJump(unsigned char*);
extern "C" unsigned char SetLoop(unsigned char ,unsigned long , unsigned char , unsigned char);
extern "C" unsigned char SetLoopi(unsigned char dev, unsigned char loop,unsigned long milli, unsigned char nearend, unsigned char trib);
extern "C" unsigned char GetLoopi(unsigned char dev);
extern "C" unsigned char SetModuli(unsigned char dev, unsigned char transmitterMode,unsigned long oneFreqKhz, unsigned long sweepTimeMilli);
extern "C" void printfp(char*);
extern "C" void printfpd(char* , unsigned long );
//extern "C" void printfpdv(char* , float64);


extern "C" void printfp2(char*);
extern "C" void printfpd2(char* , unsigned long );

extern "C" void printfp1(char*);
extern "C" void printfpd1(char* , unsigned long );


extern unsigned long count_send, count_res, count_res_ok, count_res_bad;
extern "C" void Check_MAC_BNA(void);
#define PERIOD_REQ_ERR (100)
extern unsigned char rnms_was_used;
#ifdef USE_RS125
//extern unsigned long oct_res_sub, oct_tr_sub, oct_res_ser, oct_tr_ser;
extern unsigned long im;
extern unsigned char parse_status; //need init globally !!!!!!!
extern unsigned long rs125_send_timer;
extern "C" void SendRequestStcs(unsigned long, unsigned long);
extern "C" unsigned char IsNotRezerved(unsigned long);
extern "C" void MakeStat();
//#define RS125_SEND_TIMEOUT	(1000) 
#define PERIOD_OF_KEEP		(900)
#define RS125_SEND_TIMEOUT	(100) 
#define STCS_MES_LEN (21)
#define REP_MAX_LEN (280)
#define MES_MAX_LEN (270)
#define MES_OCT_LEN	(16)
#define REZERVED_VAL (20)
#define REAL_MES_LEN (REP_MAX_LEN - (4 * REZERVED_VAL))
#define MAX_MIN_CENTER_LEN	 (4*12)

extern unsigned long oct_res_sub[PERIOD_OF_KEEP], oct_tr_sub[PERIOD_OF_KEEP], oct_res_ser[PERIOD_OF_KEEP], oct_tr_ser[PERIOD_OF_KEEP];
extern unsigned long cnt_oct;


#define STCS_REP_LEN (REP_MAX_LEN + 15)
#define REPORT_HEADER (0x7E)
#define SEND_ID	(0x110)
#define REP_ID	(0x80000015)
#define  OFFSET_SIZE (4)
#define ZERO_OFFSET (0)
extern unsigned char StatBuffer[REP_MAX_LEN];
#endif


#ifdef PROG_PRM_PCH_N_2

extern "C" void SendToDDS(unsigned long, unsigned long);
#define SENDED_DDS_FREQ_LEN	 (8)
#define NO_HANGT_VAL (10000)
extern unsigned char GetLevN(void);
extern unsigned char GetAttN(void);
extern unsigned char GetAtt2N(void);
extern unsigned char GetAtt3N(void);

extern unsigned short GetFreqN(void);
extern unsigned short GetLockN(void);
extern unsigned char GetAlarmN(void);
extern "C" unsigned char GetAddrN(void);

extern "C" void RestoreFreq(unsigned char , unsigned long );
extern "C" void RestoreAtt(unsigned char , unsigned long );

#define PRM_N_KEEP_FREQ
//#define DELAY_TIME_TO_WRITE	(50000) //	 10sec
#define DELAY_TIME_TO_WRITE	(25000) //	 5sec




#endif




#ifdef 	PROG_PRM_PCH_L_61

#define SCAN_RESEND

#define CHECK_ETH_STATE
#define ETH_CAN_RESTART
#define DEV_ETH_CAN_RESTART
//#define TRAP_ENABLED
#define PING_ENABLED


extern unsigned char SourcePCH;
#define PRM_L_KEEP_FREQ
//131007#define DELAY_TIME_TO_WRITE	(5000) //	 5sec
#define DELAY_TIME_TO_WRITE	(2000) //131007 	 2sec
//ok#define DELAY_TIME_TO_WRITE	(10000) //	 10sec
//#define DELAY_TIME_TO_WRITE	(1000) // test

extern  unsigned char WriteStatus1,WriteStatus2,WriteStatus3,WriteStatus4,WriteStatus5,WriteStatus6,WriteStatus7,WriteStatus8;
extern unsigned char ReadStatus1[3], ReadStatus2[3], ReadStatus3[3], ReadStatus4[3], ReadStatus5[3], ReadStatus6[3], ReadStatus7[3], ReadStatus8[3];
extern unsigned char ReadAtt1[3], ReadAtt2[3], ReadAtt3[3], ReadAtt4[3], ReadAtt5[3], ReadAtt6[3], ReadAtt7[3], ReadAtt8[3];


#define  FLASH_LEN  (4)
#define GET_FLASH_LEN (3)
#define GET_ATT_LEN (1)

#define  CODE_SETFLASH	(30)
#define  CODE_GETFLASH	(31)
#define  CODE_GETATT	(32)

#define  WRITE_FLASH_COMMAND	 (0x1E)
#define  READ_FLASH_COMMAND	 (0x1F)
#define  READ_ATT_COMMAND	 (0x20)


#endif

#define RS485_TRANS_TIMEOUT	(50)


//#ifdef ETH_DEBUG_485E
//#define RS485E_TRANS_TIMEOUT	(300) 
//#else
#define RS485E_TRANS_TIMEOUT	(40)   //was 40
//#define RS485E_TRANS_TIMEOUT	(100)   //was 40
//#endif


extern "C" void Enable_irqs_for_task(void);
extern "C" void Disable_irqs_for_task(void);

#ifdef TRY_UNBLOCK
extern unsigned long tcpip_id;
#endif

//extern pointer TCPIP_task;


#define ETH_SER_OFF_TIMEOUT_ALL	  ((ETH_SERIAL_OFF_TIMEOUT_MS) * ((BSP_ALARM_FREQUENCY * CORE_ALARM_FREQUENCY) / 1000l)) //10ms from to next serial command eth maked off



#ifdef	PROG_PRM_PCH_DEM_XIL_CHN_DMU3  

extern "C" void LoadBaud(unsigned long,unsigned char);
extern "C" void LoadBand(unsigned long , unsigned char);
extern "C" unsigned long GetFreqPCh2(void);
extern "C" unsigned long GetFreqPCh(void);
#define CNL1	(0)
#define CNL2	(1)
#define MAX_CNL (1)
//#define SEL_PORT  (0x403)
#define SEL_PORT  (0x400)
#define	OPTIONDEM_PORT (0x8)
#define MODUL_PORT  (0x7)
#define STATUS_PORT	(0x3)
#define MIRROR_PORT	(0x0)

#define CODE_CNL1	(0x0)
#define CODE_CNL2	(0x1)
#define CODE_TGE	(0x2)


#define LOW_BAND	(0)
#define HIGH_BAND	(1)
#define DIAP_SELECT	(10000000(0)
#define HIGH_BAND	(1)
#define DIAP_SELECT	(10000000d SetSymbolRate2(unsigned long);
extern "C" void SetFreqPCh2(unsigned long);
extern "C" void SetModulSK2(unsigned long);

extern "C" unsigned long GetSymbolRate2(void);
extern "C" unsigned long GetFreqPCh2(void);
extern "C" unsigned long GetModulSK2(void);
extern "C" void LoadModulSKB(unsigned char chn);
extern "C" void SetSelector(unsigned char);
#endif

#ifdef	PROG_PRM_PCH_DEM_XIL_CHN_DMU5
 
#define	PROG_PRM_PCH_DEM_XIL_CHN_DMU4 

//#define PORT_SEL 		(0x403)

//#define SEL_TGE01		(6)

//#define SEL_TGE01		(4)
#define SEL_TGE01		(2)






#define  DMU_START_ADDR	 (4)



#define CLOCK_ENABLED


#define BACO_START_ADDR	(0xA)	  //1 - start	 absolute

#define DATA_REG_ADDR  (0xF)
#define ADDR_REG_ADDR  (0xA)


#define BACO_OFFSET	  (0)	
//#define BACO_OFFSET_BSC   (0x10000C20)  //12 * 8	 (8+2+1+1)*(NUM_OF_SLOT>>1)
//#define BACO_OFFSET_DMU   (0x10000C90)  // 24
#define BACO_OFFSET_DMU   (0xC90)  // 24

 extern "C" void	RestoreDmu();
 extern "C" void	KeepDmu();

 void LoadBacoDmu(unsigned char );
 void LoadBacoStartZero(void);




#define NUM_OF_SLOT	 (2)

extern "C" unsigned char ClockReadYear(void);
extern "C" unsigned char ClockReadMonth(void);
extern "C" unsigned char ClockReadDate(void);
extern "C" unsigned char ClockReadHours(void);
extern "C" unsigned char ClockReadMin(void);
extern "C" unsigned char ClockReadSec(void);

#define SAMPLEMAX_ADDR  (0)	 //low byte of 4 
//#define NUMBLOCKS_ADDR  (3)	 //low byte of 4 
#define SIZEBLOCKS_ADDR (6)	  //low byte of 2
#define IPLEN_ADDR      (8)	  //low byte of 2
#define IPIDENT_ADDR 	(0xa)	  //low byte of 2
#define RESET_ADDR 		(0xd)	  //low byte of 2
#define IPCRC_ADDR 		(0xc)	  //low byte of 2
#define UDPLEN_ADDR 	(0xe)	  //low byte of 2
#define MAC_SOURCE_ADDR (0x10)	  //low byte of 2
#define MAC_DEST_ADDR 	(0x16)	  //low byte of 2
#define IP_SOURCE_ADDR 	(0x1c)	  //low byte of 2
#define IP_DEST_ADDR 	(0x20)	  //low byte of 2
#define UDP_SOURCE_ADDR (0x24)	  //low byte of 2
#define UDP_DEST_ADDR 	(0x26)	  //low byte of 2
#define YEAR_ADDR 		(0x28)	  //low byte of 2
#define MONTH_ADDR 		(0x29)	  //low byte of 2
#define DAY_ADDR 		(0x2a)	  //low byte of 2
#define HOUR_ADDR 		(0x2b)	  //low byte of 2
#define MIN_ADDR 		(0x2c)	  //low byte of 2
#define SEC_ADDR 		(0x2d)	  //low byte of 2
#define N0_ADDR 		(0x2e)	  //low byte of 2
#define N1_ADDR 		(0x2f)	  //low byte of 2
#define N2_ADDR 		(0x30)	  //low byte of 2
#define N3_ADDR 		(0x31)	  //low byte of 2
#define MS100_ADDR 		(0x32)	  //low byte of 2



#endif

#ifdef	PROG_PRM_PCH_DEM_XIL_CHN_DMU4 

extern "C" void  LoadrateTest(void);
extern "C" unsigned char SetDecOff(void);

#define RAM_LOAD_RATE (25000000)
  /*
#define ADDR9 192			//main header
#define ADDR8 526336
#define ADDR7 592736
#define ADDR6 609792
#define ADDR5 614560
#define ADDR4 616228
#define ADDR3 617108
#define ADDR2 617108
#define ADDR1 617736
*/
   /*
#define ADDR9 192
#define ADDR8 526144
#define ADDR7 592544
#define ADDR6 609600
#define ADDR5 614368
#define ADDR4 616036
#define ADDR3 616916
#define ADDR2 616916
#define ADDR1 617544
  */

#define ADDR9 192
#define ADDR8 526240
#define ADDR7 592640
#define ADDR6 609696
#define ADDR5 614464
#define ADDR4 616132
#define ADDR3 617012
#define ADDR2 617012
#define ADDR1 617640



#define SIZE_ABS9 1152			//main header
#define SIZE_ABS8  256
#define SIZE_ABS7  64
#define SIZE_ABS6  64
#define SIZE_ABS5  36
#define SIZE_ABS4  16
#define SIZE_ABS3  4
#define SIZE_ABS2  4
#define SIZE_ABS1  0


extern unsigned char writed_modul;

extern "C" void WriteRamToFlash(void);


#define DecFileDataAddressD (0xC0500020)
#define DecFileDataAddress (0xC0500000)
#define HEADER_SIZE	(0x60)

extern "C" void FillDecFileData(void);

extern "C" void WriteRamData(unsigned char);

#define  DEC_CON_PORT (0xf)
extern "C" void LoadRam(unsigned char);
extern "C" void UnLoadRam(unsigned char);

extern "C" void  SetDecAndTest(unsigned char);

extern unsigned long decoder0, test0;
extern unsigned long decoder1, test1;
extern unsigned long decoder2, test2;
extern unsigned long decoder3, test3;

extern "C" char CheckDoneShort5();
extern "C" char CheckDoneShort6();
extern "C" char CheckDoneShort7();
extern "C" char CheckDoneShort8();


extern "C" void LoadBaud(unsigned long,unsigned char);
extern "C" void LoadBand(unsigned long , unsigned char, unsigned long);
extern "C" unsigned long GetFreqPCh2(void);
extern "C" unsigned long GetFreqPCh(void);

extern "C" unsigned char SetSelectorToProv(void);
extern "C" unsigned char SetSelectorToDMU(void);


#define CNL1	(0)
#define CNL2	(1)
#define CNL3	(2)
#define CNL4	(3)


#define MAX_CNL (3)
//#define SEL_PORT  (0x403)
#define SEL_PORT  (0x400)

#ifndef PROG_DMU6

#define	OPTIONDEM_PORT (0x8)
#define BAUD_PORT (9)
#define GAIN_PORT (0xA)	
#else
#define	OPTIONDEM_PORT (0x9)
#define CONDIG_PORT (0xA)	

#endif



  



#define REF_PORT  (0xB)
#define DATA_PORT (0xD)
#define SUMM_PORT (0xE)

//#define SUMM_PORT (0xE)

#define RXSYMBL_PORT (0x10)
#define RXSYMBM_PORT (0x11)
#define RXSYMBH_PORT (0x12)

#define FRAME_PORT (0x13)

#define FRAMECON_PORT (0x3F)
#define ENF0_7_PORT (0x40)
#define ENF8_15_PORT (0x41)
#define ENF16_21_PORT (0x42)
#define ENF_STM_PORT (0x43)
#define ENF_ETH_PORT (0x44)
#define ENF_TB_PORT (0x45)
#define ENF_TEST_PORT (0x46)






#ifndef PROG_DMU6
#define MODUL_PORT  (0x7)
#else
#define MODUL_PORT  (0x8)
#endif



#define STATUS_PORT	(0x3)
#define MIRROR_PORT	(0x0)
#define TYPE_PORT	(0x1)
#define XCS1_TYPE	(0x15)
//#define XCS2_TYPE	(0x5)	 //do not used
#define TGE_TYPE	(0x5)	
#define PROV_TYPE	(0x25)	


#define CODE_CNL1	(0x0)
#define CODE_CNL2	(0x1)
#define CODE_CNL3	(0x2)
#define CODE_CNL4	(0x3)
#define CODE_TGE	(0x2)
#define CODE_WRONG	 (0x4)



#define LOW_BAND	(0)
#define HIGH_BAND	(1)
#define DIAP_SELECT	(100000000l)

#define LOW_BAND1	(0)
#define HIGH_BAND1	(0x2)
#define DIAP_SELECT1	(3000000l)


#define	PROG_PRM_PCH_DEM_XIL_CHN  
extern "C" void SetSymbolRate2(unsigned long);
extern "C" void SetFreqPCh2(unsigned long);
extern "C" void SetModulSK2(unsigned long);

extern "C" unsigned long GetSymbolRate2(void);
extern "C" unsigned long GetFreqPCh2(void);
extern "C" unsigned long GetModulSK2(void);

extern "C" void SetSymbolRate3(unsigned long);
extern "C" void SetFreqPCh3(unsigned long);
extern "C" void SetModulSK3(unsigned long);

extern "C" unsigned long GetSymbolRate3(void);
extern "C" unsigned long GetFreqPCh3(void);
extern "C" unsigned long GetModulSK3(void);

extern "C" void SetSymbolRate4(unsigned long);
extern "C" void SetFreqPCh4(unsigned long);
extern "C" void SetModulSK4(unsigned long);

extern "C" unsigned long GetSymbolRate4(void);
extern "C" unsigned long GetFreqPCh4(void);
extern "C" unsigned long GetModulSK4(void);

			    



extern "C" void LoadModulSKB(unsigned char chn);
extern "C" void SetSelector(unsigned char);
extern "C" void LoadModul(void);

#endif




#ifdef	PROG_PRM_PCH_DEM_XIL_CHN
#define  PROG_PRM_PCH_DEM_XIL
#endif

#ifdef 	PROG_PRM_PCH_DEM_XIL

#define PROG_PRM_PCH_DEM
#define XILINXPG1				(4)
void SetNeedReloadXil(unsigned char);

#endif //PROG_PRM_PCH_DEM_XIL




#ifdef 	PROG_PRM_PCH_DEM
//#define XILINXPG1				(4)
#define GEN_100

//110411#define ETH_CAN_RESTART	  //find autoneg
//110411#define DEV_ETH_CAN_RESTART

#define NOT_CORRECT_PARAMETER (2)

//#define	 PROG_PRM_PCH_L_61
//________________________________________________________________________L61
#define PRM_L_KEEP_FREQ
//#define DELAY_TIME_TO_WRITE	(5000) //	 5sec
#define DELAY_TIME_TO_WRITE	(1000) //	 1sec

extern  unsigned char WriteStatus1,WriteStatus2,WriteStatus3,WriteStatus4,WriteStatus5,WriteStatus6;
extern unsigned char ReadStatus1[3], ReadStatus2[3], ReadStatus3[3], ReadStatus4[3], ReadStatus5[3], ReadStatus6[3];
extern unsigned char ReadAtt1[3], ReadAtt2[3], ReadAtt3[3], ReadAtt4[3], ReadAtt5[3], ReadAtt6[3];


#define FLASH_LEN  (4)
#define GET_FLASH_LEN (3)
#define GET_ATT_LEN (1)

#define  CODE_SETFLASH	(30)
#define  CODE_GETFLASH	(31)
#define  CODE_GETATT	(32)

#define  WRITE_FLASH_COMMAND	 (0x1E)
#define  READ_FLASH_COMMAND	 (0x1F)
#define  READ_ATT_COMMAND	 (0x20)



//__________________________________s
#define  PRM_PCH_SIX_LINES
#define POWER_PORT2 (0x11)    //need chack after have protokol
#define CH4_MASK (0x1)
#define NO_CH4_MASK (0xfe)
#define CH5_MASK (0x2)
#define NO_CH5_MASK (0xfd)
#define CH6_MASK (0x4)
#define NO_CH6_MASK (0xfb)
extern unsigned char start4, start5, start6;
extern "C" void AlarmPmOff2(void);
extern "C" void AlarmPmOn(void);
extern "C" void AlarmPmOn2(void);

//_________________________________ c

extern "C" void CheckPower();
extern "C" void SetPower(unsigned char );
extern "C" void CheckAlarmsPm(void);

#define ENABLED_LOSS (5)

//#define START_TIMEOUT  (4000) //4 sec
#define START_TIMEOUT  (5000) //4 sec


//#define PROG_PRM_PCH
//#define PRM_PCH_THREE_LINES

#define STATUS_PORT (0x3)

#define	SEARCH_CHANNEL1 (0x1)
#define	SEARCH_CHANNEL2 (0x2)
#define	SEARCH_CHANNEL3 (0x4)





#define POWER_PORT (0x10)
//#define LED_PORT   (0x4)

#define NO_ALARM_INPUT    (0x1)
#define ALARM_INPUT    (0xFE)

#define NO_ALARM_POWER    (0x2)
#define ALARM_POWER (0xFD)
#define NO_ALARM_PM 	(0x4)
#define ALARM_PM        (0xFB)

#define ALL_CH_POWER_ON (0x10)
#define CH1_MASK (0x1)
#define NO_CH1_MASK (0xfe)
#define CH2_MASK (0x2)
#define NO_CH2_MASK (0xfd)
#define CH3_MASK (0x4)
#define NO_CH3_MASK (0xfb)

extern unsigned char start1, start2,start3;
extern "C" void AlarmPmOn(void);
extern "C" void AlarmPmOff(void);
extern "C" void ClearMod(); 
extern "C" void ClearTransit(); 
extern "C" void LoadDDSs(void);
extern "C" void  LoadModulSK(void);
extern "C" unsigned char ChkDem(unsigned char);



//_________________________________

#define cs_last_addr          0x30000000

//#define INTERRUPT_WAIT (2000000)	 //i enable no more 200000 interrupts irq 0 in 1 ms - not many?

//#define XIL_LOAD_FREQ       	500000
//blink somtime led #define XIL_LOAD_FREQ       	200000
//t #define XIL_LOAD_FREQ       	2000000
#define XIL_LOAD_FREQ       	3000000
//#define XIL_LOAD_FREQ       	1000000		 //t
#define IncEmbRS232
#define IncEmbRS485
#define IncEmbTimer
//#define IncEmbNMI
//#define IncEmbIndicator
#define IncEmbSerialMD34AVT
//#define XilSizeToDownloadD    (48)   // to can Spartan3 500
//#define XilSizeToDownloadD    (200000)   // to can Spartan3 500
//t #define XilSizeToDownloadD    (175000)   // to can Spartan3 2500
//#define XilSizeToDownloadD    (169217)   // t   to can Spartan3 2500
#define XilSizeToDownloadD    (495000)   // t   to can Spartan3 2500

//#define XilSizeToDownloadD    (740000)   // t  have BIT files for all xilinxes
#define XilSizeToDownloadD2   (495000)   // to can Spartan3 500
#define XilSizeToDownloadD3   (250000)  
#define XilSizeToDownloadD4   (300000)

#define XILINXPG				(1)

extern "C" void Init_PRM_PCH(void);
extern "C" void PRM_PCH(void);

extern unsigned long timewait;
extern "C" void print_signature(void);




//#define MAX_SYMBOL_RATE	  (5nt_signature(void);




//#define MAX_SYMBOL_RATE	  (49000000)  //101117
#define MAX_SYMBOL_RATE	  (50000000)  //101117


#define MIN_SYMBOL_RATE	  (100000)


#define MAX_FREQPCH1		 (90000000)
#define MIN_FREQPCH1		 (50000000)
#define MAX_FREQPCH2		(160000000)
#define MIN_FREQPCH2		(120000000)

#define MAX_MODULSK		  (0x70)
#define MIN_MODULSK		  (0x10)

#define MODUL1	(0x10)
#define MODUL2	(0x20)
#define MODUL3	(0x21)
#define MODUL4	(0x40)
#define MODUL5	(0x50)
#define MODUL6	(0x60)
#define MODUL7	(0x70)
#define MODUL8	(0x80)
#define MODUL9	(0x90)
#define MODULA	(0xA0)
#define MODULB	(0xB0)
#define MODULC	(0xC0)



#define MODUL11	(0x11)
#define MODUL41	(0x41)
#define MODUL51	(0x51)
#define MODUL61	(0x61)
#define MODUL71	(0x71)
#define MODUL81	(0x81)
#define MODUL91	(0x91)
#define MODULA1	(0xA1)
#define MODULB1	(0xB1)
#define MODULC1	(0xC1)





extern "C" void SetNeedWriteDevId(void);


extern "C" void SetSymbolRate(unsigned long);
extern "C" void SetFreqPCh(unsigned long);
extern "C" void SetModulSK(unsigned long);

extern "C" unsigned long GetSymbolRate(void);
extern "C" unsigned long GetFreqPCh(void);
extern "C" unsigned long GetModulSK(void);


extern "C" unsigned char CheckSymbolRate(unsigned long);
extern "C" unsigned char CheckFreqPCh(unsigned long);
extern "C" unsigned char CheckModulSK(unsigned long);


extern "C" void SendToDDS(unsigned long, unsigned long);
extern "C" void SendToDDS3(unsigned long, unsigned long);

#define SENDED_DDS_FREQ_LEN	 (8)
#define NO_HANGT_VAL (10000)

#define LEN_DATA_DDS (3)
#define SPI_WAIT	  (1)
#define SPI_NO_WAIT	  (0)

extern "C" unsigned char GetNeedWriteDevId(void);
extern "C" void SetNeedWriteDevId(void);
extern "C" void ClearNeedWriteDevId(void);
extern "C" void LoadSymbolRate(unsigned long);
extern "C" void LoadFreqPCh(unsigned long);

#ifdef USART0_TRY_PDC_1T
extern "C" void printfp(char*);
extern "C" void printfpd(char*, unsigned long);
//extern "C" void printfpdv(char* format, void data);
extern "C" void printfpdv(char* format, float data);
#endif

extern "C" void printfp(char*);
extern "C" void printfpd(char* , unsigned long );
extern "C"  void m_load_xilinx4 (char, char);
extern "C"  void m_load_xilinx5 (char, char);



#endif// PROG_PRM_PCH_DEM
 /*
#ifdef USE_USART2
extern "C" void embRS232S_rcvbuf_Add(unsigned char);
extern "C" void Transmit2c(unsigned char);

#define USART2_TRY_PDC_1T //101004 : need check!!!!
#define USART2_TRY_PDC	  //101004 need check!!!
#endif //USE_USART2
*/
//#define UNHANDLED_INT_BLOCKED (0xA | 0x1)

//extern "C" uint_32 GetNetwork();
//extern "C" uint_32 GetNetMask();


#ifdef YOURNAL

#define	 MIN_LOGCLEAR		(0)
#define	 MAX_LOGCLEAR		(1)

extern "C" void PrintYournal(void);
extern "C" void ClearYournal(void);

extern "C" unsigned char CheckEventCRC(unsigned char *);

extern "C" void GetRecord1(unsigned long);

#define  CLOCK_ENABLED

#define YOURNAL_HEADER_ADDRESS (0x00001ffC)
#define YOURNAL_START_ADDRESS  (0x00002000)	
//#define YOURNAL_END_ADDRESS    (0x00006FFF) 
//#define YOURNAL_END_ADDRESS    (0x0000203C) //7 events size 8
//#define YOURNAL_END_ADDRESS    (0x00002190)	 //	50 events size 8
#define YOURNAL_END_ADDRESS    (0x00005FFF)	//256 events size 64
//#define RECORD_SIZE (8)
//120528 #define RECORD_SIZE (64)
#define RECORD_SIZE (16)
//#define ENABLED_DATA_SIZE  (RECORD_SIZE - 2 - 4 - 1 - 1) //2- id 4 - time - 1 -type - 1 - datasize
#define ENABLED_DATA_SIZE  (RECORD_SIZE - 2 - 4 - 1 - 1 - 1) //2- id 4 - time - 1 -type - 1 - datasize 1- crc
#define RECORDS_MAX_QUANTITY ((YOURNAL_END_ADDRESS - YOURNAL_START_ADDRESS)/ RECORD_SIZE)
#define YOURNAL_LAST_ADDRESS  (YOURNAL_START_ADDRESS + ((RECORDS_MAX_QUANTITY - 1) * RECORD_SIZE))



extern "C" void Add_Event(unsigned short, unsigned char, char*);
extern "C" void Init_Yournal();
#define EV_POWER_ON	     (1)
#define EV_POWER_OFF     (2)
#define EV_COMMAND 	     (3)
#define EV_LOCK 	     (4)
#define EV_UNLOCK 	     (5)
#define	EV_ALARM	     (6)
#define	EV_NO_ALARM	 	 (7)
#define	EV_CONFIG	 	 (8)
#define	EV_STATE_TIMER	 (9)
#define	EV_COMMAND_CONFIG		 (10)
#define	EV_MY_COMMAND_CONFIG	 (11)
#define	EV_UPLINK_AVAILABLE		 (12)
#define	EV_UPLINK_LOST			 (13)
#define	EV_DOWNLINK_AVAILABLE	 (14)
#define	EV_DOWNLINK_LOST		 (15)
#define	EV_PVG610_ALARM			 (16)
#define	EV_ACM_T_UP			 	 (17)
#define	EV_ACM_T_D 			 	 (18)
#define	EV_ACM_R_UP			 	 (19)
#define	EV_ACM_R_D 			 	 (20)
#define	EV_CONFIG_D			 	 (21)
#define	EV_CONFIG_T			 	 (22)







extern  unsigned long view_counter;






extern  unsigned char ev_power_off;
extern unsigned long prev_event;
extern  unsigned char yournal_init;

extern "C" unsigned long GetPrevionsEvAddr(unsigned long );
extern "C" void WriteEvent(unsigned short , unsigned long , unsigned char ,  char * );


#endif // YOURNAL

#define PIPE_MODE  (6)

extern unsigned char start_main_loop;
extern unsigned char flag_need_load;


extern "C" unsigned int ReadAis();
extern "C" unsigned int ReadAis1();
extern "C" WriteAis(unsigned int );

extern "C" int AT91F_DataflashInit();

extern "C" void ClearBufferState(unsigned long);

extern "C" unsigned char MirrorTest();


#ifdef USE_HTTP
extern unsigned long page_number;
extern "C" void Init_web_prm(void);
#define  MIN_WEBPASSWORD  (0)
#define  MAX_WEBPASSWORD  (99999999)
#endif


//#define INTERRUPT_WAIT (100)
//ok #define INTERRUPT_WAIT (150)
//#define INTERRUPT_WAIT (10000)	 //somtime hangt if use rnms + test mode2
#define INTERRUPT_WAIT (2500)

#ifdef IRQ_LIMITED 
extern  unsigned long time_irq;
//t 121117#define  LIMIT_IRQ_PERIOD  100
//#define  LIMIT_IRQ_PERIOD  50
#define  LIMIT_IRQ_PERIOD  1
#endif //IRQ_LIMITED 

void SetUsart2RS485(void);
extern "C" void checklossmem();

//#define RS232_BYTES_LIMIT   (16)		 //16*8 =  128 bit *1000(ms) = 128Kbit /s
#define RS232_BYTES_LIMIT   (10)
//#define CHANNELS_RATE_LIMIT	(100)
//ok#define CHANNELS_RATE_LIMIT	(50)
//loss!!! #define CHANNELS_RATE_LIMIT	(25)
#define CHANNELS_RATE_LIMIT	(37)
//#define CHANNELS_RATE_LIMIT	(400)

extern unsigned long modem_bytes_counter;
extern unsigned long transit_bytes_counter;
extern unsigned long modem_bytes_time;
extern unsigned long transit_bytes_time;

extern unsigned long txtrans, rxtrans, txmod, rxmod;

extern unsigned long txtransb, rxtransb;//, txmod, rxmod;


//extern unsigned long irq0_limit;

#define IRQ0_LIMIT	(1000)
//#define IRQ0_LIMIT	(300)
extern "C" void MaskIrq0();
extern "C" void UnMaskIrq0();
extern "C" void MaskReceive();
extern "C" void UnMaskReceive();
 /*
extern unsigned long send_buff_cnt;
extern unsigned long recv_buff_cnt1;
extern unsigned long recv_buff_cnt2;
extern unsigned long recv_buff_cnt3;
extern unsigned long recv_buff_cnt4;
 */

extern "C" void ENET_tx_underrun();

extern "C" void cashe_off (void);
extern "C" void cashe_on (void);

#define BAD_VALUE_ANS (0x999)

#define CURRENT_VER_API	 (197403)

#define DEFAULT_ID 0x9999
#define DEFAULT_VER 0
#define DEFAULT_POK 0x7777
#define DEFAULT_MAC0 0x001111
#define DEFAULT_MAC1 0x009999
#define DEFAULT_IP   0x9B9B9b0f;
#define DEFAULT_MASK 0xFFFF0000
extern unsigned char read_flag;
extern unsigned long writeid_counter;

//extern unsigned long   _psp_get_cpsr(void);  
//extern unsigned char ReadDevId(unsigned char);

#define MIN_DEVID  (0)
#define MAX_DEVID  (0x9999)
    
#define MAGIC_VAL	(0xFFFF148e)
#define MAGIC_VAL1	(0xFFFF148d)



extern "C" void  my_int_enable_eth(void);
extern "C" void  my_int_disable_eth(void);

extern "C" unsigned char ReadDevId2(unsigned char);
extern unsigned long lock_counter;
//#define ENABLED_UNLOCK_TIME	 (7000) //7 sec
#define ENABLED_UNLOCK_TIME	 (15000) //15 sec
extern "C" unsigned char CheckNetMask(unsigned long);

 extern "C" unsigned char ReadDevId(unsigned char);
  extern "C" unsigned char ReadDevId_test(unsigned char);


extern "C" void dev_restart2( void );


//#define START_TIMEOUT (1000)
#define START_TIMEOUT (4000)
extern "C" unsigned char PrintDevId(void);
extern unsigned char flag_restart_web_prog;
extern unsigned long counter_restart_web_prog;
//extern unsigned long t1;

#define WEB_PROG_RESTART_DELAY   (100000)  //100 sec

#define TX_READY_BIT  (0x20)
extern "C" unsigned short GetDevId(void);

#ifdef TEST_BUS
extern "C" unsigned char TestBus(void);
#endif

extern "C" int AT91F_DataflashInit1 (void);

extern unsigned cnt_bmdn, cnt_prm;
extern "C" void RDN_receive(char * pData); 

extern "C" unsigned long* Set_ipDefaultTTL (unsigned long* pNew_TTL);

#ifdef USE_SOCKETSD	

#define TRANSIT_TTL	   (2)

#define  BUFF_SIZE_DATAG  2000l
extern char                 buff[BUFF_SIZE_DATAG];  //need check
#define  BUFF_SIZE_DATAGt  2000l
extern char                 buff_udpt[BUFF_SIZE_DATAG];  //need check
//char*                 pbuff_udpt;
extern unsigned long             len_udpt;
extern unsigned long   flag_send_udp_asu;
unsigned long l_udpt_inc(void);



#endif

#ifdef USE_SOCKETSD_485	

//#define TRANSIT_TTL	   (2)

//#define  BUFF_SIZE_DATAG  2000l
extern char                 buff_485[BUFF_SIZE_DATAG];  //need check
//#define  BUFF_SIZE_DATAGt  2000l
extern char                 buff_udpt_485[BUFF_SIZE_DATAG];  //need check
//char*                 pbuff_udpt;
extern unsigned long             len_udpt_485;
extern unsigned long   flag_send_udp_asu_485;
unsigned long l_udpt_inc_485(void);



#endif

